<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CISM 2024: Domain 1 - Information Security Governance (Interactive Study Guide)</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F5EF; /* Warm Neutral Background */
            color: #333333;
        }
        .container { 
            max-width: 1200px;
        }
        /* Enhanced Section Header with new accent color from Domain 3 */
        .section-header {
            border-left: 6px solid #00A896; /* Vibrant Teal Accent */
            padding-left: 1.25rem;
            font-size: 2.5rem; /* Slightly larger */
            color: #222222; /* Darker text for contrast */
        }
        /* Refined Accordion Button and Content from Domain 3 */
        .accordion-button {
            background-color: #EDEAE0; /* Secondary Neutral */
            border-bottom: 1px solid #D5D2C8;
            border-radius: 0.75rem; /* More rounded */
            padding: 1rem 1.5rem; /* Increased padding */
            font-size: 1.25rem; /* Slightly larger font */
            font-weight: 700; /* Bolder */
            color: #333333;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out;
            display: flex; /* Ensure flex behavior */
            justify-content: space-between; /* Pushes content and icon to ends */
            align-items: center; /* Vertically centers items */
            text-align: left; /* Keep text aligned left within the button */
        }
        .accordion-button:hover {
            background-color: #D5D2C8; /* Darker on hover */
            transform: translateY(-1px);
        }
        .accordion-content {
            background-color: #FFFFFF;
            border-bottom: 1px solid #D5D2C8;
            border-radius: 0 0 0.75rem 0.75rem; /* Match top radius */
            padding: 1.5rem; /* More padding */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05); /* Subtle shadow */
        }
        /* Active Navigation Item from Domain 3 */
        .nav-item.active {
            border-bottom: 3px solid #00A896; /* Vibrant Teal Accent */
            font-weight: 700; /* Bolder */
            color: #222222;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Unified Styles for Interactive Cards (Frameworks, Requirements, Key Terms) */
        .concept-card, .requirement-card, .key-term-card, .change-management-card, .legal-type-card, .contract-type-card, .governance-structure-card, .risk-appetite-card, .business-driver-card, .framework-step-card, .maturity-level-card {
            background-color: #EDEAE0; /* Secondary Neutral */
            border: 1px solid #D5D2C8;
            padding: 1rem;
            border-radius: 0.75rem; /* More rounded */
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-sizing: border-box;
            text-align: left;
            font-weight: 600;
            color: #333333;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center; /* Centered vertically */
            align-items: center; /* Centered horizontally */
            box-shadow: 0 2px 5px rgba(0,0,0,0.08); /* Subtle initial shadow */
            flex-grow: 0;
            flex-shrink: 0;
        }

        .concept-card:hover, .requirement-card:hover, .key-term-card:hover, .change-management-card:hover, .legal-type-card:hover, .contract-type-card:hover, .governance-structure-card:hover, .risk-appetite-card:hover, .business-driver-card:hover, .framework-step-card:hover, .maturity-level-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15); /* More pronounced shadow on hover */
        }

        /* Active state for all interactive cards */
        .concept-card.active, .requirement-card.active, .key-term-card.active, .change-management-card.active, .legal-type-card.active, .contract-type-card.active, .governance-structure-card.active, .risk-appetite-card.active, .business-driver-card.active, .framework-step-card.active, .maturity-level-card.active {
            border-color: #00A896; /* Vibrant Teal border */
            box-shadow: 0 4px 8px rgba(0, 168, 150, 0.3); /* Teal glow */
            background-color: #E0F7F5; /* Very light teal background */
        }

        .concept-card .card-title, .requirement-card .card-title, .key-term-card .card-title, .change-management-card .card-title, .legal-type-card .card-title, .contract-type-card .card-title, .governance-structure-card .card-title, .risk-appetite-card .card-title, .business-driver-card .card-title, .framework-step-card .card-title, .maturity-level-card .card-title {
            font-size: 1.15em; /* Slightly larger title */
            margin-bottom: 0.6rem;
            text-align: center;
            color: #004085; /* Dark blue for title for consistency */
        }

        .concept-card .card-description, .requirement-card .card-description, .key-term-card .card-description, .change-management-card .card-description, .legal-type-card .card-description, .contract-type-card .card-description, .governance-structure-card .card-description, .risk-appetite-card .card-description, .business-driver-card .card-description, .framework-step-card .card-description, .maturity-level-card .card-description {
            font-weight: 400; /* Regular font weight for description */
            font-size: 0.9em;
            color: #555555;
            margin-top: 0.5rem;
            display: none; /* Hidden by default */
            text-align: left; /* Default text alignment for descriptions */
            word-break: break-word; /* Ensure text breaks within the fixed width */
        }
        /* Specific override for key-term-card description text alignment */
        .key-term-card .card-description {
            text-align: center;
        }

        .concept-card.active .card-description, .requirement-card.active .card-description, .key-term-card.active .card-description, .change-management-card.active .card-description, .legal-type-card.active .card-description, .contract-type-card.active .card-description, .governance-structure-card.active .card-description, .risk-appetite-card.active .card-description, .business-driver-card.active .card-description, .framework-step-card.active .card-description, .maturity-level-card.active .card-description {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        /* Specific min-width and width for cards */
        .concept-card {
            min-width: 200px;
            width: 200px;
            flex-basis: 200px;
        }
        .requirement-card {
            min-width: 200px;
            width: 200px;
            flex-basis: 200px;
        }
        .key-term-card {
            min-width: 150px;
            width: 150px;
            flex-basis: 150px;
        }
        .change-management-card {
            min-width: 180px; /* Adjusted for content */
            width: 180px;
            flex-basis: 180px;
            background-color: #D4EDDA; /* Light green for positive action */
            color: #155724;
        }
        .change-management-card:hover {
            background-color: #C3E6CB;
        }
        .legal-type-card {
            min-width: 200px;
            width: 200px;
            flex-basis: 200px;
            position: relative; /* Needed for positioning the pseudo-element */
            overflow: hidden; /* Ensures pseudo-element stays within bounds */
            /* Removed direct background-image properties from here */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 0;
            border: 1px solid #D5D2C8;
            border-radius: 0.75rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }

        /* Pseudo-element for background image with opacity */
        .legal-type-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0.3; /* 30% opacity */
            z-index: 1; /* Place behind content wrapper */
        }

        .legal-type-card.eu-bg::before {
            background-image: url('uploaded:UE.png-e198d13b-b3e9-489f-a163-d85455edd9d2');
        }
        .legal-type-card.us-bg::before {
            background-image: url('uploaded:USA.png-93dc6f7b-c4be-4fe9-9118-0782fbd9c6a9');
        }
        .legal-type-card.global-industry-bg::before {
            background-image: url('uploaded:Industry.png-70659c48-56e3-4e19-b868-0c7c709bedbf');
        }

        .contract-type-card {
            min-width: 200px;
            width: 200px;
            flex-basis: 200px;
        }
        .governance-structure-card {
            min-width: 200px;
            width: 200px;
            flex-basis: 200px;
        }
        .risk-appetite-card {
            min-width: 180px;
            width: 180px;
            flex-basis: 180px;
        }
        .business-driver-card {
            min-width: 200px;
            width: 200px;
            flex-basis: 200px;
        }
        .framework-step-card {
            min-width: 350px; /* Set min-width */
            width: 350px; /* Set fixed width */
            flex-basis: 350px; /* Set flex-basis to match width */
            min-height: 100px; /* Set min-height */
            max-height: 100px; /* Set max-height for collapsed state */
            overflow: hidden; /* Hide overflow when collapsed */
            background-color: #F0F8FF; /* Light blue for steps */
            color: #001f3f;
            display: flex; /* Ensure flexbox for content alignment */
            flex-direction: column; /* Stack content vertically */
            justify-content: center; /* Center content vertically */
            align-items: center; /* Center content horizontally */
            transition: all 0.3s ease-in-out; /* Smooth transition for all changes */
        }
        .framework-step-card:hover {
            background-color: #DDEBF7;
        }
        .framework-step-card.active {
            border-color: #00A896; /* Vibrant Teal border */
            box-shadow: 0 4px 8px rgba(0, 168, 150, 0.3); /* Teal glow */
            background-color: #E0F7F5; /* Very light teal background */
            max-height: 500px; /* Allow expansion to accommodate content */
            overflow: visible; /* Make content visible */
            height: auto; /* Allow height to adjust dynamically */
        }
        .maturity-level-card {
            min-width: 150px; /* Set min-width */
            max-width: 150px; /* Set max-width */
            width: 150px; /* Set fixed width */
            flex-basis: 150px; /* Set flex-basis to match width */
            min-height: 100px; /* Set min-height */
            max-height: 100px; /* Set max-height for collapsed state */
            overflow: hidden; /* Hide overflow when collapsed */
            background-color: #EDEAE0; /* Default neutral for nodes */
            color: #333333;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease-in-out; /* Combined transitions */
            font-weight: 600;
            text-align: center; /* Center text horizontally */
            display: flex;
            flex-direction: column;
            justify-content: center; /* Center content vertically */
            align-items: center; /* Center content horizontally */
        }
        .maturity-level-card:hover {
            background-color: #D5D2C8;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .maturity-level-card.active {
            border-color: #00A896;
            box-shadow: 0 4px 8px rgba(0, 168, 150, 0.3);
            background-color: #E0F7F5;
            max-height: 500px; /* Allow expansion */
            overflow: visible; /* Make content visible */
            height: auto; /* Adjust height dynamically */
        }


        /* Styles for Corporate Hierarchy Chart */
        .hierarchy-chart-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem; /* Space between elements */
            padding: 1rem;
            background-color: #F8F5EF; /* Match body background */
            border-radius: 0.5rem;
            max-width: 600px; /* Constrain width for better layout */
            margin: 1rem auto; /* Center the chart */
        }

        .role-node {
            background-color: #EDEAE0; /* Default neutral for nodes */
            color: #333333;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            font-weight: 600;
            text-align: center;
            min-width: 200px; /* Ensure some minimum width */
            width: fit-content; /* Adjust width to content */
            display: flex; /* Use flexbox for content alignment */
            flex-direction: column; /* Stack content vertically */
            justify-content: center; /* Centered vertically */
            align-items: center; /* Centered horizontally */
        }

        .role-node:hover {
            background-color: #D5D2C8; /* Darker neutral on hover */
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .role-node.active {
            border-color: #00A896; /* Vibrant Teal border */
            box-shadow: 0 4px 8px rgba(0, 168, 150, 0.3); /* Teal glow */
            background-color: #E0F7F5; /* Very light teal background */
        }

        .role-node .role-title {
            display: block;
            margin-bottom: 0.6rem; /* Space between title and cascade-description */
            font-size: 1.15em; /* Slightly larger title */
            color: #004085; /* Dark blue for title for consistency */
        }
        .role-node .role-description {
            font-weight: 400; /* Regular font weight for description */
            font-size: 0.9em;
            color: #555555;
            text-align: left; /* Align description text left */
            margin-top: 0.5rem;
            display: none; /* Hidden by default */
        }
        .role-node.active .role-description {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        .hierarchy-line {
            width: 2px;
            height: 2rem; /* Length of vertical line */
            background-color: #D5D2C8; /* Neutral line color */
        }

        .hierarchy-line-split {
            width: 60%; /* Horizontal span for split */
            height: 2px;
            background-color: #D5D2C8;
            position: relative;
            margin-top: 1rem;
            margin-bottom: 1rem;
            display: flex; /* Use flex to center children */
            justify-content: space-around; /* Distribute children */
            align-items: flex-end; /* Align stubs to the bottom */
        }
        .hierarchy-line-split::before,
        .hierarchy-line-split::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 1rem; /* Vertical stub from horizontal line */
            background-color: #D5D2C8;
            bottom: 0;
        }
        .hierarchy-line-split::before {
            left: 20%; /* Position for left branch */
            transform: translateX(-50%);
        }
        .hierarchy-line-split::after {
            right: 20%; /* Position for right branch */
            transform: translateX(50%);
        }

        /* Specific colors for roles (adapted from Domain 2) */
        .role-node.board { background-color: #A1C9CE; color: #333333; } /* Soft Blue */
        .role-node.ciso { background-color: #8FB8A1; color: #333333; } /* Soft Green */
        .role-node.data-owners { background-color: #FFD700; color: #333333; } /* Gold */
        .role-node.it-ops { background-color: #FF6384; color: #333333; } /* Pinkish Red */
        .role-node.end-users { background-color: #B0C4DE; color: #333333; } /* Light Steel Blue */


        /* Responsive Adjustments for new cards/elements */
        @media (max-width: 768px) {
            .concept-card,
            .requirement-card,
            .key-term-card,
            .change-management-card,
            .legal-type-card,
            .contract-type-card,
            .governance-structure-card,
            .risk-appetite-card,
            .business-driver-card,
            .framework-step-card,
            .maturity-level-card,
            .role-node { /* Apply to all interactive cards */
                flex: 1 1 100%; /* Stack cards on medium screens */
                max-width: 100%;
            }
            .hierarchy-line-split {
                width: 2px; /* Make it vertical on small screens */
                height: 2rem;
                margin: 1rem auto;
                flex-direction: column; /* Stack children vertically */
                justify-content: center; /* Center children */
                align-items: center; /* Center children */
            }
            .hierarchy-line-split::before,
            .hierarchy-line-split::after {
                display: none; /* Hide horizontal stubs */
            }
        }
        /* Adjusted for larger screens to maintain 6 columns for key terms */
        @media (min-width: 1024px) {
            #key-terms .grid {
                grid-template-columns: repeat(6, 1fr); /* Six columns on large screens */
                gap: 1.5rem; /* Ensure gap is consistent */
            }
            .key-term-card {
                /* Calculate width for 6 columns with gap-6 (1.5rem) */
                flex: 1 1 calc((100% - (5 * 1.5rem)) / 6);
                max-width: calc((100% - (5 * 1.5rem)) / 6);
                min-height: 180px; /* Increased min-height for more text */
            }
            .key-term-card .card-title {
                font-size: 1em; /* Slightly smaller title for more space */
            }
            .key-term-card .card-description {
                font-size: 0.85em; /* Slightly smaller description for more space */
            }
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Adjust as needed */
            height: 40vh; /* Adjust as needed */
            margin-left: auto;
            margin-right: auto;
        }
        .slider-container {
            width: 80%;
            max-width: 500px;
            margin: 2rem auto;
            text-align: center;
            background-color: #EDEAE0;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }
        .slider-container input[type="range"] {
            width: 100%;
            -webkit-appearance: none;
            height: 8px;
            background: #D5D2C8;
            outline: none;
            border-radius: 4px;
            opacity: 0.7;
            transition: opacity .2s;
        }
        .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #00A896; /* Vibrant Teal */
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .slider-container input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #00A896; /* Vibrant Teal */
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .slider-label {
            font-weight: 600;
            color: #004085;
            margin-bottom: 1rem;
            display: block;
            font-size: 1.1em;
        }
        .slider-value {
            margin-top: 1rem;
            font-size: 1.2em;
            font-weight: 700;
            color: #333333;
        }
        .slider-description {
            font-size: 0.9em;
            color: #555555;
            margin-top: 0.5rem;
        }
        /* Specific styles for background images on legal-type-cards */
        .legal-type-card {
            position: relative; /* Needed for positioning the overlay */
            overflow: hidden; /* Ensures overlay stays within bounds */
            background-size: cover;
            background-position: center;
            display: flex; /* Use flexbox to center content */
            flex-direction: column; /* Stack content vertically */
            justify-content: center; /* Center content vertically */
            align-items: center; /* Center content horizontally */
            padding: 0; /* Remove padding from the outer card to let content-wrapper handle it */
            border: 1px solid #D5D2C8; /* Keep the border */
            border-radius: 0.75rem; /* Keep the border-radius */
            box-shadow: 0 2px 5px rgba(0,0,0,0.08); /* Keep the shadow */
        }

        .legal-type-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0.3; /* 30% opacity */
            z-index: 1; /* Place behind content wrapper */
        }

        .legal-type-card.eu-bg::before {
            background-image: url('uploaded:UE.png-e198d13b-b3e9-489f-a163-d85455edd9d2');
        }
        .legal-type-card.us-bg::before {
            background-image: url('uploaded:USA.png-93dc6f7b-c4be-4fe9-9118-0782fbd9c6a9');
        }
        .legal-type-card.global-industry-bg::before {
            background-image: url('uploaded:Industry.png-70659c48-56e3-4e19-b868-0c7c709bedbf');
        }

        /* Overlay for opacity and text legibility */
        .legal-type-card .card-content-wrapper {
            position: relative; /* Establishes new stacking context for content */
            z-index: 2; /* Ensures content is above the overlay */
            background-color: rgba(255, 255, 255, 0.7); /* White overlay with 70% opacity */
            width: 100%;
            height: 100%;
            padding: 1rem; /* Match card padding */
            box-sizing: border-box; /* Include padding in width/height */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 0.75rem; /* Match card border-radius */
        }
        /* Ensure title and description are visible on image backgrounds */
        .legal-type-card .card-title {
            color: #004085; /* Original title color */
        }
        .legal-type-card .card-description {
            color: #555555; /* Original description color */
        }
        /* Styles for the new chart in B.1.e */
        .chart-container-b1e {
            position: relative;
            width: 100%;
            max-width: 900px; /* Increased max-width for charts */
            height: 50vh; /* Increased height */
            max-height: 500px; /* Increased max height */
            margin-left: auto;
            margin-right: auto;
            overflow: hidden; /* Prevent overflow */
        }
        @media (min-width: 640px) { /* sm */
            .chart-container-b1e {
                height: 45vh; /* Increased height for sm screens */
                max-height: 450px; /* Increased max height for sm screens */
            }
        }
        @media (min-width: 768px) { /* md */
            .chart-container-b1e {
                height: 40vh; /* Increased height for md screens */
                max-height: 400px; /* Increased max height for md screens */
            }
        }

        /* Styles for Framework Adoption Journey (B.2.c) */
        .framework-journey-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem; /* Space between elements */
            padding: 1rem;
            background-color: #F8F5EF; /* Match body background */
            border-radius: 0.5rem;
            max-width: 400px; /* Constrain width for better layout */
            margin: 1rem auto; /* Center the chart */
        }

        .framework-step-node {
            background-color: #EDEAE0; /* Default neutral for nodes */
            color: #333333;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease-in-out; /* Combined transitions */
            font-weight: 600;
            text-align: center;
            min-width: 350px; /* Set min-width */
            width: 350px; /* Set fixed width */
            flex-basis: 350px; /* Set flex-basis to match width */
            min-height: 100px; /* Set min-height */
            max-height: 100px; /* Set max-height for collapsed state */
            overflow: hidden; /* Hide overflow when collapsed */
            background-color: #F0F8FF; /* Light blue for steps */
            color: #001f3f;
            display: flex; /* Ensure flexbox for content alignment */
            flex-direction: column; /* Stack content vertically */
            justify-content: center; /* Center content vertically */
            align-items: center; /* Center content horizontally */
        }

        .framework-step-node:hover {
            background-color: #D5D2C8; /* Darker neutral on hover */
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .framework-step-node.active {
            border-color: #00A896;
            box-shadow: 0 4px 8px rgba(0, 168, 150, 0.3);
            background-color: #E0F7F5;
            max-height: 500px; /* Allow expansion */
            overflow: visible; /* Make content visible */
            height: auto; /* Adjust height dynamically */
        }

        .framework-step-node .node-title {
            font-size: 1.15em;
            margin-bottom: 0.6rem;
            color: #004085;
        }
        .framework-step-node .node-description {
            font-weight: 400;
            font-size: 0.9em;
            color: #555555;
            margin-top: 0.5rem;
            display: none; /* Hidden by default */
        }
        .framework-step-node.active .node-description {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        .framework-arrow {
            width: 2px;
            height: 2rem; /* Length of vertical line */
            background-color: #D5D2C8; /* Neutral line color */
            position: relative;
        }
        .framework-arrow::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) translateY(50%) rotate(135deg); /* Points downwards */
            width: 8px;
            height: 8px;
            border-top: 2px solid #D5D2C8;
            border-right: 2px solid #D5D2C8;
        }

        /* Maturity Model Specific Styles */
        .maturity-model-container {
            display: flex;
            flex-wrap: nowrap; /* Ensure no wrapping */
            justify-content: center;
            align-items: center;
            gap: 0.5rem; /* Reduced gap for closer arrows */
            padding: 1rem;
            background-color: #F8F5EF;
            border-radius: 0.5rem;
            overflow-x: auto; /* Allow horizontal scrolling on smaller screens */
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }

        .maturity-level-card {
            min-width: 150px; /* Set min-width */
            max-width: 150px; /* Set max-width */
            width: 150px; /* Set fixed width */
            flex-basis: 150px; /* Set flex-basis to match width */
            min-height: 100px; /* Set min-height */
            max-height: 100px; /* Set max-height for collapsed state */
            overflow: hidden; /* Hide overflow when collapsed */
            background-color: #EDEAE0; /* Default neutral for nodes */
            color: #333333;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease-in-out; /* Combined transitions */
            font-weight: 600;
            text-align: center; /* Center text horizontally */
            display: flex;
            flex-direction: column;
            justify-content: center; /* Center content vertically */
            align-items: center; /* Center content horizontally */
        }
        .maturity-level-card:hover {
            background-color: #D5D2C8;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .maturity-level-card.active {
            border-color: #00A896;
            box-shadow: 0 44px 8px rgba(0, 168, 150, 0.3);
            background-color: #E0F7F5;
            max-height: 500px; /* Allow expansion */
            overflow: visible; /* Make content visible */
            height: auto; /* Adjust height dynamically */
        }

        .maturity-arrow {
            width: 20px; /* Length of the horizontal arrow */
            height: 2px;
            background-color: #D5D2C8;
            position: relative;
            flex-shrink: 0; /* Prevent shrinking */
            margin: 0 0.25rem; /* Small margin to separate from cards */
        }
        .maturity-arrow::after {
            content: '';
            position: absolute;
            top: 50%;
            right: 0;
            transform: translateY(-50%) rotate(45deg); /* Points right */
            width: 8px;
            height: 8px;
            border-top: 2px solid #D5D2C8;
            border-right: 2px solid #D5D2C8;
        }

        /* New styles for Risk Appetite cards to visualize progression */
        .risk-appetite-card.risk-averse-bg {
            background-color: #C8E6C9; /* Pale Green */
        }
        .risk-appetite-card.conservative-bg {
            background-color: #FFECB3; /* Pale Yellow */
        }
        .risk-appetite-card.moderate-bg {
            background-color: #FFD580; /* Light Orange */
        }
        .risk-appetite-card.risk-aggressive-bg {
            background-color: #FFCDD2; /* Light Red */
        }
    </style>
</head>
<body class="leading-relaxed">
    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center py-8 bg-white rounded-lg shadow-md mb-8">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 mb-2">CISM Domain 1 Study Guide</h1>
            <p class="text-xl sm:text-2xl text-gray-600">Information Security Governance</p>
            <p class="text-md text-gray-500 mt-2">Your Interactive Study Guide for Strategic Security Leadership</p>
        </header>

        <nav class="bg-white p-4 rounded-lg shadow-md mb-8 flex justify-center sticky top-0 z-10 overflow-x-auto">
            <button class="nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200 active" data-target="introduction">Introduction</button>
            <button class="nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="enterprise-governance">Enterprise Governance</button>
            <button class="nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="info-sec-strategy">Information Security Strategy</button>
            <button class="nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="key-terms">Key Terms</button>
            <button class="nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="domain-summary">Domain Summary</button>
        </nav>

        <main id="content-area">
            <!-- Introduction Section -->
            <section id="introduction" class="content-section fade-in">
                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Introduction to CISM Domain 1</h2>
                <div class="p-6 bg-white rounded-lg shadow-md">
                    <p class="text-gray-700 mb-4">Welcome to the interactive study guide for CISM Domain 1: Information Security Governance. This domain is the foundational pillar of effective information security management, emphasizing the strategic alignment of security initiatives with overall business objectives. It's about establishing the framework, roles, and responsibilities that ensure information security is an integral part of the enterprise's governance structure.</p>
                    <p class="text-gray-700">As a Certified Information Security Manager, you are expected to understand how to develop, implement, and oversee an information security governance framework that not only protects information assets but also enables business operations and ensures compliance with legal, regulatory, and contractual requirements. This guide will help you explore the critical components of governance, from organizational culture to strategic planning and resource management.</p>
                </div>
            </section>

            <!-- Enterprise Governance Section -->
            <section id="enterprise-governance" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section A: Enterprise Governance</h2>
                <p class="mb-8 text-gray-700">Enterprise governance provides the structure through which the objectives of the organization are set and pursued. Information security governance must be an integral part of this broader framework.</p>

                <!-- Sub-Topic: Organizational Culture and its Impact on Information Security -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        1. Organizational Culture and its Impact
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">Organizational culture significantly influences the effectiveness of information security. A strong security culture fosters proactive behavior and shared responsibility.</p>
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Influence of corporate culture on security behaviors and decision-making.</h4>
                        <p class="text-gray-600 mb-4">Corporate culture profoundly shapes how individuals perceive and engage with security. It impacts risk appetite and influences security-related decisions. For instance, a culture prioritizing rapid innovation might accept higher security risks.</p>
                        <div class="chart-container mb-6">
                            <canvas id="securityCultureChart"></canvas>
                        </div>
                        <div class="flex flex-wrap justify-center gap-4 mb-4">
                            <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #00A896; color: white;" data-culture-type="strongCulture">Strong Security Culture</button>
                            <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #DC3545; color: white;" data-culture-type="weakCulture">Weak Security Culture</button>
                        </div>
                        <div id="culture-explanation" class="text-gray-600 text-sm italic mt-2 text-center">This chart illustrates a simulated distribution of employee security behaviors based on the prevailing organizational culture. Use the buttons to see how culture can shift these behaviors.</div>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3 mt-6">b. Promoting a security-aware culture through leadership and communication.</h4>
                        <p class="text-gray-600 mb-4">Cultivating a security-aware culture requires continuous effort, driven by leadership and effective communication. This includes comprehensive security awareness programs, clear policies, and open communication channels to foster vigilance.</p>
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Tone at the top: executive sponsorship and support.</h4>
                        <p class="text-gray-600 mb-4">The commitment of senior management is paramount. Executive sponsorship ensures visible commitment, adequate resource allocation, and accountability for security across the organization.</p>
                        <div class="slider-container">
                            <label for="leadershipEngagement" class="slider-label">Leadership Engagement Level</label>
                            <input type="range" id="leadershipEngagement" min="0" max="100" value="50" step="1">
                            <div class="slider-value" id="engagementValue">Moderate Engagement</div>
                            <div class="slider-description" id="engagementDescription">Policies are generally followed, but security may lack strong strategic momentum or innovation.</div>
                        </div>
                        <p class="text-gray-600 text-sm italic mt-2 text-center">Adjust the slider to see how different levels of leadership engagement can influence the organizational security culture.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3 mt-6">d. Change management and resistance mitigation in security initiatives.</h4>
                        <p class="text-gray-600 mb-4">Implementing new security measures often encounters resistance. Effective change management involves early stakeholder engagement, clear communication of the "why," and providing adequate training and support to facilitate adoption. Click on each step to learn more:</p>
                        <div class="flex flex-wrap justify-center gap-4 mb-6">
                            <div class="change-management-card" data-step="communicate">
                                <span class="card-title">Communicate Early & Often</span>
                                <div class="card-description hidden">Proactive and transparent communication about upcoming changes, their benefits, and potential impacts helps reduce uncertainty and build trust.</div>
                            </div>
                            <div class="change-management-card" data-step="addressConcerns">
                                <span class="card-title">Address Concerns</span>
                                <div class="card-description hidden">Establish channels for feedback and actively listen to and address employee concerns, fears, and questions about new security initiatives.</div>
                            </div>
                            <div class="change-management-card" data-step="provideTraining">
                                <span class="card-title">Provide Training & Support</span>
                                <div class="card-description hidden">Offer comprehensive and accessible training, along with ongoing support, to ensure employees understand new security processes and tools.</div>
                            </div>
                            <div class="change-management-card" data-step="celebrateSuccesses">
                                <span class="card-title">Celebrate Successes</span>
                                <div class="card-description hidden">Recognize and reward positive security behaviors and successful adoption of new measures to reinforce the desired culture and motivate continued compliance.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sub-Topic: Legal, Regulatory, and Contractual Requirements -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        2. Legal, Regulatory, and Contractual Requirements
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">Information security governance must ensure compliance with a complex web of legal, regulatory, and contractual obligations.</p>
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Identification and interpretation of applicable laws and regulations</h4>
                        <p class="text-gray-600 mb-4">Organizations must identify all pertinent laws and regulations based on their operations, industry, and geography. Explore key regulations by region/type:</p>
                        <div class="flex flex-wrap justify-center gap-4 mb-6">
                            <div class="legal-type-card eu-bg" data-legal-type="eu">
                                <div class="card-content-wrapper">
                                    <span class="card-title">European Union</span>
                                    <div class="card-description hidden">Regulations like GDPR (General Data Protection Regulation) focus on data privacy and protection for individuals within the EU.</div>
                                </div>
                            </div>
                            <div class="legal-type-card us-bg" data-legal-type="us">
                                <div class="card-content-wrapper">
                                    <span class="card-title">USA (Federal & State)</span>
                                    <div class="card-description hidden">Includes federal laws like HIPAA (Health Insurance Portability and Accountability Act) for healthcare data, and state-specific laws like CCPA (California Consumer Privacy Act).</div>
                                </div>
                            </div>
                            <div class="legal-type-card global-industry-bg" data-legal-type="globalIndustry">
                                <div class="card-content-wrapper">
                                    <span class="card-title">Global & Industry Specific</span>
                                    <div class="card-description hidden">Beyond regional laws, organizations must comply with global standards (e.g., ISO 27001) and industry-specific mandates (e.g., PCI DSS for payment cards, NERC CIP for critical infrastructure).</div>
                                </div>
                            </div>
                        </div>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Contractual obligations related to information security</h4>
                        <p class="text-gray-600 mb-4">Beyond laws, contracts impose specific security requirements. Click on a contract type to see typical security clauses:</p>
                        <div class="flex flex-wrap justify-center gap-4 mb-6">
                            <div class="contract-type-card" data-contract-type="sla">
                                <span class="card-title">Service Level Agreement (SLA)</span>
                                <div class="card-description hidden">Defines the level of service expected from a vendor, including security performance metrics, incident response times, and data protection clauses.</div>
                            </div>
                            <div class="contract-type-card" data-contract-type="baa">
                                <span class="card-title">Business Associate Agreement (BAA)</span>
                                <div class="card-description hidden">Required under HIPAA, this contract specifies how business associates (third-party service providers) will safeguard Protected Health Information (PHI) on behalf of a covered entity.</div>
                            </div>
                            <div class="contract-type-card" data-contract-type="nda">
                                <span class="card-title">Non-Disclosure Agreement (NDA)</span>
                                <div class="card-description hidden">A legal contract that outlines confidential material, knowledge, or information that the parties wish to share with one another but restrict access to by third parties. It includes clauses on data protection and handling.</div>
                            </div>
                        </div>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Security's role in legal compliance and audit readiness</h4>
                        <p class="text-gray-600 mb-4">Information security is central to achieving and demonstrating compliance. This involves establishing compliance programs, preparing for audits with robust documentation, and continuous monitoring of control effectiveness.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">d. Data protection and privacy laws by region/jurisdiction</h4>
                        <p class="text-gray-600 mb-4">The global privacy landscape necessitates understanding specific laws across jurisdictions (e.g., GDPR in EU, CCPA in California), particularly for cross-border data transfers and implementing 'privacy by design' principles.</p>

                        <h4 class="text-lg font-semibold text-gray-700">e. Intellectual property rights, industry-specific mandates</h4>
                        <p class="text-gray-600">Protecting Intellectual property through security controls and adhering to industry-specific mandates (e.g., PCI DSS, NERC CIP) are critical for protecting assets and ensuring operational continuity within specific sectors.</p>
                    </div>
                </div>

                <!-- Sub-Topic: Organizational Structures, Roles, and Responsibilities -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        3. Organizational Structures, Roles, and Responsibilities
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">Effective Information security governance relies on clearly defined organizational structures, roles, and responsibilities. This clarity ensures accountability, prevents gaps, and facilitates efficient execution of security functions.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Governance structures (centralized, decentralized, hybrid)</h4>
                        <p class="text-gray-600 mb-4">Organizations adopt different models for security governance. Explore the common structures below:</p>
                        <div class="flex flex-wrap justify-center gap-4 mb-6">
                            <div class="governance-structure-card" data-structure-type="centralized">
                                <span class="card-title">Centralized</span>
                                <div class="card-description hidden">Security decisions and control are concentrated in a single department or team (e.g., a dedicated CISO office). This provides consistency and strong oversight but can be less agile in large, diverse organizations.</div>
                            </div>
                            <div class="governance-structure-card" data-structure-type="decentralized">
                                <span class="card-title">Decentralized</span>
                                <div class="card-description hidden">Security responsibilities are distributed across various business units or departments. This can promote agility and local ownership but may lead to inconsistencies and gaps without strong coordination.</div>
                            </div>
                            <div class="governance-structure-card" data-structure-type="hybrid">
                                <span class="card-title">Hybrid</span>
                                <div class="card-description hidden">Combines elements of both centralized and decentralized models. A central security function sets overall strategy and standards, while business units handle day-to-day implementation and local adaptations. This aims to balance consistency with agility.</div>
                            </div>
                        </div>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Defining roles and responsibilities: Board, Executive, CISO, Data Owners, Users</h4>
                        <p class="text-gray-600 mb-4">Clear role definitions are fundamental to accountability. Each level, from the Board with ultimate oversight to every user adhering to policies, plays a crucial part in the security posture.</p>
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Segregation of duties (SoD), accountability, escalation paths</h4>
                        <p class="text-gray-600 mb-4">Implementing Segregation of Duties prevents a single point of control, reducing fraud and error. Clear accountability ensures ownership, while defined escalation paths enable timely incident and risk resolution.</p>
                        <h4 class="text-lg font-semibold text-gray-700">d. Security steering committees and governance forums</h4>
                        <p class="text-gray-600">Formal committees and forums provide structured decision-making and oversight, ensuring strategic direction and alignment with business objectives.</p>
                    </div>
                </div>
            </section>

            <!-- Information Security Strategy Section -->
            <section id="info-sec-strategy" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section B: Information Security Strategy</h2>
                <p class="mb-8 text-gray-700">An information security strategy translates the organization's business objectives into actionable security goals and initiatives.</p>

                <!-- Sub-Topic: Information Security Strategy Development -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        1. Information Security Strategy Development
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">Developing a robust information security strategy requires a systematic approach.</p>
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Alignment of security objectives with organizational goals</h4>
                        <p class="text-gray-600 mb-4">The cornerstone of any effective security strategy is its direct alignment with the organization's overarching business goals. Security should enable business objectives and manage risks effectively.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Defining vision, mission, and guiding principles for the security program</h4>
                        <p class="text-gray-600 mb-4">Just like the broader organization, the security program needs clear vision, mission, and guiding principles to define its purpose and inform all security decisions and actions.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Determining risk appetite and tolerance</h4>
                        <p class="text-gray-600 mb-4">Understanding the organization's willingness to accept risk (risk appetite) and acceptable deviation (risk tolerance) is crucial for shaping the security strategy and prioritizing investments. Explore different risk appetites:</p>
                        <div class="flex flex-wrap justify-center gap-4 mb-6">
                            <div class="risk-appetite-card risk-averse-bg" data-appetite-type="riskAverse">
                                <span class="card-title">Risk Averse</span>
                                <div class="card-description hidden">Prefers to avoid risk as much as possible, even if it means missing potential opportunities. Focuses heavily on preventative controls and strict compliance.</div>
                            </div>
                            <div class="risk-appetite-card conservative-bg" data-appetite-type="conservative">
                                <span class="card-title">Conservative</span>
                                <div class="card-description hidden">Willing to accept a low level of risk, but generally prefers established, proven security measures. Prioritizes stability and minimizing potential losses.</div>
                            </div>
                            <div class="risk-appetite-card moderate-bg" data-appetite-type="moderate">
                                <span class="card-title">Moderate</span>
                                <div class="card-description hidden">Balances risk and reward, accepting a reasonable level of risk to achieve business objectives. Invests in security controls that provide a good return on investment.</div>
                            </div>
                            <div class="risk-appetite-card risk-aggressive-bg" data-appetite-type="riskAggressive">
                                <span class="card-title">Risk Aggressive</span>
                                <div class="card-description hidden">Willing to take on higher levels of risk for potentially greater rewards, often seen in innovative or rapidly growing organizations. Focuses on rapid detection and response capabilities.</div>
                            </div>
                        </div>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">d. Incorporating threat landscape and business drivers</h4>
                        <p class="text-gray-600 mb-4">The strategy must be dynamic, continuously adapting to evolving external threats (threat landscape) and internal business needs (business drivers) to remain relevant and effective. Map business drivers to security objective mapper:</p>
                        <div class="flex flex-wrap justify-center gap-4 mb-6">
                            <div class="business-driver-card" data-driver-type="digitalTransformation">
                                <span class="card-title">Digital Transformation</span>
                                <div class="card-description hidden">Security objectives align with securing new digital platforms, cloud environments, and data analytics initiatives. Focus on cloud security, data privacy, and secure development.</div>
                            </div>
                            <div class="business-driver-card" data-driver-type="globalExpansion">
                                <span class="card-title">Global Expansion</span>
                                <div class="card-description hidden">Security objectives include understanding and complying with international regulations, securing global supply chains, and establishing consistent security policies across diverse geographies.</div>
                            </div>
                            <div class="business-driver-card" data-driver-type="costOptimization">
                                <span class="card-title">Cost Optimization</span>
                                <div class="card-description hidden">Security objectives focus on efficiency and cost-effectiveness of controls, leveraging automation, and optimizing security tool investments while maintaining an acceptable risk posture.</div>
                            </div>
                            <div class="business-driver-card" data-driver-type="newProductLaunch">
                                <span class="card-title">New Product Launch</span>
                                <div class="card-description hidden">Security objectives prioritize security-by-design, secure development lifecycle (SDLC), vulnerability testing, and ensuring product compliance with relevant security standards before release.</div>
                            </div>
                        </div>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">e. Prioritizing security initiatives based on business impact</h4>
                        <p class="text-gray-600 mb-4">With limited resources, security initiatives must be prioritized based on their potential business impact, leveraging Business Impact Analysis (BIA) and cost-benefit analysis.</p>
                        <div class="chart-container-b1e mb-6">
                            <canvas id="securityInitiativesChart"></canvas>
                        </div>
                        <div class="flex flex-wrap justify-center gap-4 mb-4">
                            <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #00A896; color: white;" data-priority-type="complianceDriven">Compliance-Driven</button>
                            <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #FF6384; color: white;" data-priority-type="revenueDriven">Revenue-Driven</button>
                        </div>
                        <div id="priority-explanation" class="text-gray-600 text-sm italic mt-2 text-center">This chart simulates the prioritization of security initiatives. Use the buttons to see how priorities might shift based on different business drivers or strategic focuses.</div>
                    </div>
                </div>

                <!-- Sub-Topic: Information Security Governance Frameworks and Standards -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        2. Information Security Governance Frameworks and Standards
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">Frameworks provide a structured approach to managing information security. Click on a card to learn more:</p>
                        <div class="flex flex-wrap justify-center gap-4 mb-6">
                            <div class="concept-card" data-concept="cobit">
                                <span class="card-title">COBIT</span>
                                <div class="card-description hidden"><strong>Control Objectives for Information and Related Technologies:</strong> A comprehensive framework for IT governance and management, providing a holistic approach to managing IT risks and ensuring IT alignment with business goals. It helps organizations create optimal value from IT by maintaining a balance between realizing benefits and optimizing risk levels and resource use.</div>
                            </div>
                            <div class="concept-card" data-concept="iso27001">
                                <span class="card-title">ISO/IEC 27001</span>
                                <div class="card-description hidden"><strong>Information Security Management System (ISMS):</strong> An international standard that specifies requirements for establishing, implementing, maintaining, and continually improving an ISMS within the context of the organization's overall business risks. Certification to ISO 27001 demonstrates a systematic approach to managing sensitive company information.</div>
                            </div>
                            <div class="concept-card" data-concept="nist-csf">
                                <span class="card-title">NIST CSF</span>
                                <div class="card-description hidden"><strong>National Institute of Standards and Technology Cybersecurity Framework:</strong> A voluntary framework providing a common language for understanding, managing, and expressing cybersecurity risk. It consists of five core functions: Identify, Protect, Detect, Respond, Recover, offering a flexible way to manage cybersecurity risk.</div>
                            </div>
                            <div class="concept-card" data-concept="itil">
                                <span class="card-title">ITIL</span>
                                <div class="card-description hidden"><strong>Information Technology Infrastructure Library:</strong> A framework for IT service management that describes processes, procedures, tasks, and checklists that are not organization-specific, used to establish a minimum level of competency. While not solely security-focused, it supports security processes.</div>
                            </div>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Selection and Implementation:</h4>
                        <p class="text-gray-600 mb-4">Choosing the right framework depends on organizational context, industry, and regulatory landscape. Implementation involves adapting the framework's principles to the specific needs of the enterprise.</p>
                        <h4 class="text-lg font-semibold text-gray-700">c. Integrating governance frameworks into enterprise governance</h4>
                        <p class="text-gray-600 mb-4">Security frameworks must be integrated seamlessly into the broader enterprise governance structure through harmonization, consistent language, and a robust top-down/bottom-up communication flow.</p>
                        <h5 class="text-md font-bold text-gray-800 mb-2">Framework Adoption Journey</h5>
                        <p class="text-gray-700 mb-4">Implementing a governance framework is a structured process. Click on each step to understand the typical activities involved:</p>
                        <div class="framework-journey-container">
                            <div class="framework-step-node" data-step-id="step1">
                                <span class="node-title">1. Define Scope & Objectives</span>
                                <div class="node-description hidden">Clearly define the scope of the ISMS (Information Security Management System), identify organizational context, and establish the objectives and policies for information security. This aligns security with business goals.</div>
                            </div>
                            <div class="framework-arrow"></div>
                            <div class="framework-step-node" data-step-id="step2">
                                <span class="node-title">2. Assess Current State & Gaps</span>
                                <div class="node-description hidden">Conduct a comprehensive assessment of the organization's current information security posture, identify existing controls, and pinpoint gaps against the chosen framework's requirements. This includes risk assessment.</div>
                            </div>
                            <div class="framework-arrow"></div>
                            <div class="framework-step-node" data-step-id="step3">
                                <span class="node-title">3. Design & Plan Controls</span>
                                <div class="node-description hidden">Based on the risk assessment and identified gaps, design and plan the implementation of appropriate security controls. This involves selecting controls from the framework's annexes (e.g., ISO 27002) and developing a detailed implementation plan.</div>
                            </div>
                            <div class="framework-arrow"></div>
                            <div class="framework-step-node" data-step-id="step4">
                                <span class="node-title">4. Implement Controls</span>
                                <div class="node-description hidden">Execute the control implementation plan, deploying new security technologies, updating processes, and conducting necessary training. This phase focuses on putting the planned security measures into operation.</div>
                            </div>
                            <div class="framework-arrow"></div>
                            <div class="framework-step-node" data-step-id="step5">
                                <span class="node-title">5. Monitor, Review & Improve</span>
                                <div class="node-description hidden">Continuously monitor the effectiveness of implemented controls, conduct regular reviews and audits, and make necessary adjustments for continuous improvement. This ensures the ISMS remains effective and adapts to changes in the threat landscape or business environment.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sub-Topic: Strategic Planning (e.g., Budgets, Resources, Business Case) -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        3. Strategic Planning (Budgets, Resources, Business Case)
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">Effective strategic planning ensures that information security initiatives are adequately resourced and justified.</p>
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Justification and strategic alignment of security investments</h4>
                        <p class="text-gray-600 mb-4">Strategic planning translates the security strategy into practical implementation, involving careful resource allocation, financial justification, and continuous performance measurement.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Building multi-year information security roadmap</h4>
                        <p class="text-gray-600 mb-4">A security roadmap outlines the evolution of the security program over time, outlining phases to bridge the gap between the current and desired security states, while remaining flexible to adapt to changes.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Developing a business case for security investments</h4>
                        <p class="text-gray-600 mb-4">A strong business case is essential for securing funding. It clearly articulates the problem, proposed solution, tangible and intangible benefits, costs, and the associated risks of not investing.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">d. Budgeting, staffing, and resource allocation</h4>
                        <p class="text-gray-600 mb-4">Strategic planning includes developing annual and multi-year budgets, assessing staffing needs (internal, contractors, MSSPs), and prioritizing resource allocation based on the roadmap and risk priorities. Allocate a hypothetical security budget below:</p>
                        <div class="p-4 bg-gray-50 rounded-md shadow-sm mb-6">
                            <h5 class="text-md font-bold text-gray-800 mb-2">Security Budget Allocator</h5>
                            <label for="totalBudget" class="block text-gray-700 text-sm font-bold mb-1">Overall Budget ($):</label>
                            <input type="text" id="totalBudget" value="1,000,000" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200 mb-4">

                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label for="techToolsPct" class="block text-gray-700 text-sm font-bold mb-1">Technology & Tools (%):</label>
                                    <input type="number" id="techToolsPct" value="40" min="0" max="100" step="1" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                </div>
                                <div>
                                    <label for="personnelStaffingPct" class="block text-gray-700 text-sm font-bold mb-1">Personnel & Staffing (%):</label>
                                    <input type="number" id="personnelStaffingPct" value="35" min="0" max="100" step="1" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                </div>
                                <div>
                                    <label for="trainingAwarenessPct" class="block text-gray-700 text-sm font-bold mb-1">Training & Awareness (%):</label>
                                    <input type="number" id="trainingAwarenessPct" value="15" min="0" max="100" step="1" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                </div>
                                <div>
                                    <label for="complianceAuditPct" class="block text-gray-700 text-sm font-bold mb-1">Compliance & Audit (%):</label>
                                    <input type="number" id="complianceAuditPct" value="10" min="0" max="100" step="1" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                </div>
                            </div>
                            <div class="chart-container mb-4">
                                <canvas id="budgetChart"></canvas>
                            </div>
                            <div id="budget-explanation" class="text-gray-600 text-sm italic mt-2 text-center">Adjust the percentages above. The total must equal 100%. The chart dynamically updates to show your budget allocation.</div>
                        </div>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">e. Defining and monitoring KPIs and KRIs to measure strategic performance</h4>
                        <p class="text-gray-600 mb-4">To ensure effectiveness, security performance is measured using Key Performance Indicators (KPIs) for current performance and Key Risk Indicators (KRIs) for anticipating future problems. Regular reporting provides insights to management.</p>
                        <div class="chart-container-b1e mb-6">
                            <canvas id="kriTrendChart"></canvas>
                        </div>
                        <div class="flex flex-wrap justify-center gap-4 mb-4">
                            <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #DC3545; color: white;" data-kri-type="criticalVulnerabilities">Critical Vulnerabilities Detected</button>
                            <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #FFD700; color: #333333;" data-kri-type="phishingAttempts">Phishing Attempts Reported</button>
                            <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #004085; color: white;" data-kri-type="failedAccess">Failed Access Attempts</button>
                        </div>
                        <div id="kri-explanation" class="text-gray-600 text-sm italic mt-2 text-center">This line chart illustrates simulated trends for various Key Risk Indicators (KRIs) over time, helping to anticipate potential issues. Click a button to see its trend.</div>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">f. Continuous improvement through maturity models (e.g., CMMI, PDCA)</h4>
                        <p class="text-gray-600 mb-4">Information security requires continuous improvement, often guided by maturity models like CMMI and iterative methodologies such as the Plan-Do-Check-Act (PDCA) cycle. Explore common maturity levels:</p>
                        <div class="maturity-model-container">
                            <div class="maturity-level-card" data-maturity-level="initial">
                                <span class="card-title">Initial</span>
                                <div class="card-description hidden">Processes are ad hoc and chaotic; success depends on individual effort. Security is reactive, with no standardized procedures.</div>
                            </div>
                            <div class="maturity-arrow"></div>
                            <div class="maturity-level-card" data-maturity-level="managed">
                                <span class="card-title">Managed</span>
                                <div class="card-description hidden">Processes are planned and executed in accordance with policies. Basic security controls are in place, but performance is not yet consistently measured.</div>
                            </div>
                            <div class="maturity-arrow"></div>
                            <div class="maturity-level-card" data-maturity-level="defined">
                                <span class="card-title">Defined</span>
                                <div class="card-description hidden">Processes are well-characterized and understood, described in standards, procedures, tools, and methods. Security is integrated into the organization's standard practices, and roles are clear.</div>
                            </div>
                            <div class="maturity-arrow"></div>
                            <div class="maturity-level-card" data-maturity-level="quantitativelyManaged">
                                <span class="card-title">Quantitatively Managed</span>
                                <div class="card-description hidden">Processes are controlled using statistical and other quantitative techniques. Security performance is measured and controlled, allowing for data-driven decision-making.</div>
                            </div>
                            <div class="maturity-arrow"></div>
                            <div class="maturity-level-card" data-maturity-level="optimizing">
                                <span class="card-title">Optimizing</span>
                                <div class="card-description hidden">Continuous process improvement is enabled by quantitative feedback and innovative new ideas and technologies. Security is a proactive, strategic enabler for the business, constantly adapting to new threats and opportunities.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Key Terms Section -->
            <section id="key-terms" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Key Terms</h2>
                <p class="mb-8 text-gray-700">Test your knowledge of key terms in Information Security Governance with these interactive flashcards. Click on a card to reveal its definition.</p>

                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-6">
                    <!-- Key Terms will be populated here by JavaScript -->
                </div>
            </section>

            <!-- Domain Summary Section -->
            <section id="domain-summary" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Domain Summary</h2>
                <div class="p-6 bg-white rounded-lg shadow-md">
                    <p class="text-gray-700 mb-4">Domain 1: Information Security Governance is the foundational domain of the CISM certification, emphasizing the strategic leadership required to establish and maintain an effective information security program. It underscores that information security is not merely a technical function but a critical business imperative that must be seamlessly integrated into the enterprise's overall governance structure.</p>
                    <p class="text-gray-700 mb-4">This domain covers the critical aspects of understanding and influencing organizational culture to foster a security-aware environment. It highlights the necessity of identifying and adhering to a complex landscape of legal, regulatory, and contractual requirements, ensuring that the security strategy remains compliant and relevant. A key focus is on defining clear organizational structures, roles, and responsibilities, ensuring accountability from the board level down to individual end-users, and establishing robust reporting mechanisms.</p>
                    <p class="text-700">Furthermore, Domain 1 delves into the strategic development of information security, emphasizing its alignment with business objectives. It introduces various governance frameworks and standards like COBIT, ISO/IEC 27001, and NIST CSF, which provide structured approaches to managing security. Finally, it addresses the practicalities of strategic planning, including budgeting, resource management, and developing compelling business cases to justify security investments, all while leveraging performance metrics to demonstrate the program's value and support continuous improvement.</p>
                </div>
            </section>
        </main>

        <footer class="text-center py-6 mt-8 text-gray-500 text-sm">
            <p>&copy; 2024 CISM Study Guide. All rights reserved. For educational purposes only.</p>
        </footer>
    </div>

    <script>
        // JS Variables for current state and base data
        const currentSection = {
            id: 'introduction' // Default to introduction
        };

        // Data for Organizational Culture Chart (A.1.a)
        let securityCultureChartInstance;
        const securityCultureData = {
            labels: ['Vigilant & Proactive', 'Compliant (Policy-Driven)', 'Indifferent/Unaware', 'Resistant/Bypassing Controls'],
            colors: ['#00A896', '#A1C9CE', '#FFD700', '#FF6384'],
            strongCulture: {
                data: [50, 30, 15, 5],
                explanation: "This represents a strong security culture where a majority of employees are vigilant and proactive, actively contributing to security. Policies are mostly adhered to, and resistance is minimal."
            },
            weakCulture: {
                data: [10, 20, 40, 30],
                explanation: "This represents a weak security culture where a significant portion of employees are indifferent or actively resistant to security controls, leading to higher risks. Policies are often bypassed."
            }
        };

        // Data for Leadership Engagement Slider (A.1.c)
        const leadershipEngagementLevels = [
            { value: 0, label: "Minimal Engagement", description: "Security is seen as an IT-only issue, with little to no strategic direction or support from leadership. Resources are scarce, and initiatives often fail due to lack of buy-in." },
            { value: 25, label: "Basic Engagement", description: "Leadership provides some support, but it's often reactive or compliance-driven. Security is acknowledged but not fully integrated into business strategy. Resources are limited." },
            { value: 50, label: "Moderate Engagement", description: "Policies are generally followed, but security may lack strong strategic momentum or innovation. Leadership understands the importance but may not actively champion initiatives." },
            { value: 75, label: "Strong Engagement", description: "Leadership actively champions security, integrating it into business strategy and decision-making. Adequate resources are allocated, and security is seen as a competitive advantage. Proactive risk management is common." },
            { value: 100, label: "Transformative Engagement", description: "Security is a core business value, driven by a highly engaged and visible leadership. Innovation in security is encouraged, and it's deeply embedded in the organizational DNA. Security is a key differentiator." }
        ];

        // Data for Change Management Cards (A.1.d)
        const changeManagementSteps = {
            communicate: {
                title: "Communicate Early & Often",
                description: "Proactive and transparent communication about upcoming changes, their benefits, and potential impacts helps reduce uncertainty and build trust. This includes explaining the 'why' behind security initiatives."
            },
            addressConcerns: {
                title: "Address Concerns",
                description: "Establish channels for feedback and actively listen to and address employee concerns, fears, and questions about new security initiatives. Empathy and clear explanations are key to mitigating resistance."
            },
            provideTraining: {
                title: "Provide Training & Support",
                description: "Offer comprehensive and accessible training, along with ongoing support, to ensure employees understand new security processes and tools. Practical, hands-on training can significantly improve adoption."
            },
            celebrateSuccesses: {
                title: "Celebrate Successes",
                description: "Recognize and reward positive security behaviors and successful adoption of new measures to reinforce the desired culture and motivate continued compliance. This builds a positive feedback loop."
            }
        };


        // Data for Legal, Regulatory, and Contractual Requirements (Topic 1.1.2)
        const legalTypeDescriptions = {
            eu: {
                title: "European Union Regulations",
                description: "Regulations like GDPR (General Data Protection Regulation) focus on data privacy and protection for individuals within the EU. It mandates strict rules on data handling, consent, and breach notification, impacting any organization processing EU citizens' data."
            },
            us: {
                title: "USA (Federal & State) Regulations",
                description: "Includes federal laws like HIPAA (Health Insurance Portability and Accountability Act) for healthcare data, GLBA (Gramm-Leach-Bliley Act) for financial institutions, and state-specific laws like CCPA (California Consumer Privacy Act) for consumer privacy. Compliance varies by industry and state."
            },
            globalIndustry: {
                title: "Global & Industry Specific Regulations",
                description: "Beyond regional laws, organizations must comply with global standards (e.g., ISO 27001 for Information Security Management Systems) and industry-specific mandates (e.g., PCI DSS for payment card data security, NERC CIP for critical infrastructure protection in North America). These often have international reach."
            }
        };

        const contractTypeDescriptions = {
            sla: {
                title: "Service Level Agreement (SLA)",
                description: "Defines the level of service expected from a vendor, including security performance metrics, incident response times, and data protection clauses. It ensures that outsourced services meet agreed-upon security standards."
            },
            baa: {
                title: "Business Associate Agreement (BAA)",
                description: "Required under HIPAA, this contract specifies how business associates (third-party service providers handling Protected Health Information) will safeguard PHI on behalf of a covered entity. It outlines permissible uses and disclosures of PHI."
            },
            nda: {
                title: "Non-Disclosure Agreement (NDA)",
                description: "A legal contract that outlines confidential material, knowledge, or information that the parties wish to share with one another but restrict access to by third parties. It includes clauses on data protection and handling, ensuring confidentiality of shared sensitive information."
            }
        };

        // Data for Information Security Governance Frameworks and Standards (Topic 1.2.2)
        const conceptDescriptions = {
            cobit: "<strong>Control Objectives for Information and Related Technologies:</strong> A comprehensive framework for IT governance and management, providing a holistic approach to managing IT risks and ensuring IT alignment with business goals. It helps organizations create optimal value from IT by maintaining a balance between realizing benefits and optimizing risk levels and resource use.",
            iso27001: "<strong>Information Security Management System (ISMS):</strong> An international standard that specifies requirements for establishing, implementing, maintaining, and continually improving an ISMS within the context of the organization's overall business risks. Certification to ISO 27001 demonstrates a systematic approach to managing sensitive company information.",
            "nist-csf": "<strong>National Institute of Standards and Technology Cybersecurity Framework:</strong> A voluntary framework providing a common language for understanding, managing, and expressing cybersecurity risk. It consists of five core functions: Identify, Protect, Detect, Respond, Recover, offering a flexible way to manage cybersecurity risk.",
            itil: "<strong>Information Technology Infrastructure Library:</strong> A framework for IT service management that describes processes, procedures, tasks, and checklists that are not organization-specific, used to establish a minimum level of competency. While not solely security-focused, it supports security processes."
        };

        // Data for Key Terms
        const keyTermsData = [
            { term: "Information Security Governance", definition: "The system by which an organization directs and controls information security activities to achieve its objectives." },
            { term: "Risk Appetite", definition: "The amount and type of risk that an organization is willing to take in order to meet its strategic objectives." },
            { term: "Organizational Culture", definition: "The shared values, beliefs, attitudes, and behaviors that characterize an organization and influence how information security is perceived and practiced." },
            { term: "Due Diligence", definition: "The exercise of reasonable care in the investigation of a matter before entering into an agreement or a transaction." },
            { term: "Due Care", definition: "The level of ordinary care that a reasonable and prudent person would exercise under the same or similar circumstances." },
            { term: "Information Security Strategy", definition: "A long-term plan that outlines the organization's approach to protecting its information assets, aligned with business objectives and risk appetite." },
            { term: "COBIT", definition: "A framework for enterprise IT governance and management, providing a holistic approach to managing IT risks and ensuring IT alignment with business goals." },
            { term: "ISO/IEC 27001", definition: "An international standard that provides requirements for establishing, implementing, maintaining, and continually improving an Information Security Management System (ISMS)." },
            { term: "NIST Cybersecurity Framework (CSF)", definition: "A voluntary framework providing a common language for understanding, managing, and expressing cybersecurity risk, structured around five core functions: Identify, Protect, Detect, Respond, Recover." },
            { term: "Key Performance Indicator (KPI)", definition: "A measurable value that demonstrates how effectively a company is achieving key business objectives. In security, it measures the performance of security controls or processes." },
            { term: "Key Goal Indicator (KGI)", definition: "A metric that indicates whether a high-level goal is being achieved. In security, it measures the achievement of strategic information security objectives." },
            { term: "Business Case", definition: "A documented argument or justification for undertaking a project or initiative, including its financial and non-financial benefits, costs, and risks." },
            { term: "Legal & Regulatory Compliance", definition: "Adherence to laws, regulations, and industry standards that govern an organization's information handling and security practices (e.g., GDPR, HIPAA, SOX)." },
            { term: "Information Asset", definition: "Any information or information system that has value to the organization, requiring protection (e.g., customer data, intellectual property, critical systems)." }
        ];

        // Data for Organizational Structures, Roles, and Responsibilities (Topic 1.1.3)
        const detailedRoleDescriptions = {
            board: {
                title: "Board/Executive Management Responsibilities",
                description: "The Board and Executive Management hold ultimate accountability for information security governance. Their responsibilities include defining the organization's overall risk appetite, approving major information security strategies and significant investments, and providing high-level oversight to ensure alignment with business objectives and regulatory requirements. They ensure adequate resources are allocated and monitor the overall effectiveness of the governance framework."
            },
            ciso: {
                title: "CISO / Information Security Manager Responsibilities",
                description: "The CISO (Chief Information Security Officer) or Information Security Manager is responsible for leading the development, implementation, and maintenance of the information security program. This includes advising senior leadership on governance matters, developing the information security strategy, ensuring compliance, managing security risks, and reporting on the overall security posture and effectiveness of controls."
            },
            dataOwners: {
                title: "Data Owners / Business Unit Heads Responsibilities",
                description: "Data Owners and Business Unit Heads are accountable for the security and integrity of information assets within their respective domains. They are responsible for classifying data, defining access requirements, making risk acceptance decisions for their data, and ensuring that information security policies are adhered to within their business processes. They collaborate with the CISO to align security practices with business needs."
            },
            itOps: {
                title: "IT Operations / Security Teams Responsibilities",
                description: "IT Operations and dedicated Security Teams are responsible for the technical implementation and operational maintenance of security controls and infrastructure. Their duties include implementing security policies, managing security tools, performing vulnerability management, responding to security incidents, and ensuring the secure operation of IT systems in alignment with the overall information security strategy and governance directives."
            },
            endUsers: {
                title: "End User Responsibilities",
                description: "Every end user plays a critical role in information security. Their responsibilities include adhering to security policies and procedures, practicing good security hygiene (e.g., strong passwords, identifying phishing), reporting suspicious activities, and protecting the information assets they interact with daily. Their compliance with security guidelines is essential for maintaining the organization's security posture."
            }
        };

        // Data for Governance Structures (A.3.a)
        const governanceStructureDescriptions = {
            centralized: {
                title: "Centralized Governance",
                description: "Security decisions and control are concentrated in a single department or team (e.g., a dedicated CISO office). This provides consistency and strong oversight but can be less agile in large, diverse organizations."
            },
            decentralized: {
                title: "Decentralized Governance",
                description: "Security responsibilities are distributed across various business units or departments. This can promote agility and local ownership but may lead to inconsistencies and gaps without strong coordination."
            },
            hybrid: {
                title: "Hybrid Governance",
                description: "Combines elements of both centralized and decentralized models. A central security function sets overall strategy and standards, while business units handle day-to-day implementation and local adaptations. This aims to balance consistency with agility."
            }
        };

        // Data for Risk Appetite Spectrum (B.1.c)
        const riskAppetiteDescriptions = {
            riskAverse: {
                title: "Risk Averse",
                description: "Prefers to avoid risk as much as possible, even if it means missing potential opportunities. Focuses heavily on preventative controls and strict compliance."
            },
            conservative: {
                title: "Conservative",
                description: "Willing to accept a low level of risk, but generally prefers established, proven security measures. Prioritizes stability and minimizing potential losses."
            },
            moderate: {
                title: "Moderate",
                description: "Balances risk and reward, accepting a reasonable level of risk to achieve business objectives. Invests in security controls that provide a good return on investment."
            },
            riskAggressive: {
                title: "Risk Aggressive",
                description: "Willing to take on higher levels of risk for potentially greater rewards, often seen in innovative or rapidly growing organizations. Focuses on rapid detection and response capabilities."
            }
        };

        // Data for Business Driver to Security Objective Mapper (B.1.d)
        const businessDriverDescriptions = {
            digitalTransformation: {
                title: "Digital Transformation",
                description: "Security objectives align with securing new digital platforms, cloud environments, and data analytics initiatives. Focus on cloud security, data privacy, and secure development."
            },
            globalExpansion: {
                title: "Global Expansion",
                description: "Security objectives include understanding and complying with international regulations, securing global supply chains, and establishing consistent security policies across diverse geographies."
            },
            costOptimization: {
                title: "Cost Optimization",
                description: "Security objectives focus on efficiency and cost-effectiveness of controls, leveraging automation, and optimizing security tool investments while maintaining an acceptable risk posture."
            },
            newProductLaunch: {
                title: "New Product Launch",
                description: "Security objectives prioritize security-by-design, secure development lifecycle (SDLC), vulnerability testing, and ensuring product compliance with relevant security standards before release."
            }
        };

        // Data for Prioritizing security initiatives based on business impact (B.1.e)
        let securityInitiativesChartInstance;
        const securityInitiativesData = {
            labels: ['Data Protection Enhancement', 'Cloud Security Migration', 'Incident Response Plan', 'Security Awareness Program', 'Vendor Risk Management'],
            colors: ['#A1C9CE', '#8FB8A1', '#FFD700', '#FF6384', '#6A5ACD'],
            complianceDriven: {
                data: [80, 60, 40, 70, 50], // Higher priority for compliance-related initiatives
                explanation: "This view prioritizes security initiatives based on a compliance-driven approach. Initiatives directly addressing regulatory requirements or audit findings are given higher priority."
            },
            revenueDriven: {
                data: [50, 75, 85, 30, 60], // Higher priority for revenue/innovation-related initiatives
                explanation: "This view prioritizes security initiatives based on a revenue-driven approach. Initiatives that directly support new business opportunities, product launches, or market expansion are given higher priority."
            }
        };

        // Data for Framework Adoption Journey (B.2.c)
        const frameworkSteps = {
            step1: {
                title: "1. Define Scope & Objectives",
                description: "Clearly define the scope of the ISMS (Information Security Management System), identify organizational context, and establish the objectives and policies for information security. This aligns security with business goals."
            },
            step2: {
                title: "2. Assess Current State & Gaps",
                description: "Conduct a comprehensive assessment of the organization's current information security posture, identify existing controls, and pinpoint gaps against the chosen framework's requirements. This includes risk assessment."
            },
            step3: {
                title: "3. Design & Plan Controls",
                description: "Based on the risk assessment and identified gaps, design and plan the implementation of appropriate security controls. This involves selecting controls from the framework's annexes (e.g., ISO 27002) and developing a detailed implementation plan."
            },
            step4: {
                title: "4. Implement Controls",
                description: "Execute the control implementation plan, deploying new security technologies, updating processes, and conducting necessary training. This phase focuses on putting the planned security measures into operation."
            },
            step5: {
                title: "5. Monitor, Review & Improve",
                description: "Continuously monitor the effectiveness of implemented controls, conduct regular reviews and audits, and make necessary adjustments for continuous improvement. This ensures the ISMS remains effective and adapts to changes in the threat landscape or business environment."
            }
        };

        // Data for Budget Allocator (B.3.d)
        let budgetChartInstance;
        const budgetData = {
            labels: ['Technology & Tools', 'Personnel & Staffing', 'Training & Awareness', 'Compliance & Audit'],
            colors: ['#A1C9CE', '#FFD700', '#FF6384', '#8FB8A1'],
            initial: {
                data: [40, 35, 15, 10], // Default percentages
                explanation: "This chart dynamically updates to show your budget allocation based on the percentages you enter. The total must equal 100%."
            }
        };

        // Data for KRI Trend Chart (B.3.e)
        let kriTrendChartInstance;
        const kriTrendData = {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            criticalVulnerabilities: {
                label: 'Critical Vulnerabilities Detected (Count)',
                data: [25, 22, 18, 15, 12, 10, 8, 7, 6, 5, 4, 3], // Simulating a decreasing trend
                borderColor: '#DC3545', // Red
                backgroundColor: 'rgba(220, 53, 69, 0.2)'
            },
            phishingAttempts: {
                label: 'Phishing Attempts Reported (Count)',
                data: [10, 12, 15, 13, 11, 9, 8, 10, 12, 11, 9, 7], // Simulating fluctuations
                borderColor: '#FFD700', // Gold
                backgroundColor: 'rgba(255, 215, 0, 0.2)'
            },
            failedAccess: {
                label: 'Failed Access Attempts (Count)',
                data: [50, 45, 40, 38, 35, 30, 28, 25, 22, 20, 18, 15], // Simulating decreasing trend
                borderColor: '#004085', // Dark Blue
                backgroundColor: 'rgba(0, 64, 133, 0.2)'
            }
        };

        // Data for Maturity Levels (B.3.f)
        const maturityLevelDescriptions = {
            initial: {
                title: "Initial",
                description: "Processes are ad hoc and chaotic; success depends on individual effort. Security is reactive, with no standardized procedures or consistent outcomes."
            },
            managed: {
                title: "Managed",
                description: "Processes are planned and executed in accordance with policies. Basic security controls are in place, but performance is not yet consistently measured or optimized."
            },
            defined: {
                title: "Defined",
                description: "Processes are well-characterized and understood, described in standards, procedures, tools, and methods. Security is integrated into the organization's standard practices, and roles are clear."
            },
            quantitativelyManaged: {
                title: "Quantitatively Managed",
                description: "Processes are controlled using statistical and other quantitative techniques. Security performance is measured and controlled, allowing for data-driven decision-making and predictive analysis."
            },
            optimizing: {
                title: "Optimizing",
                description: "Continuous process improvement is enabled by quantitative feedback and innovative new ideas and technologies. Security is a proactive, strategic enabler for the business, constantly adapting to new threats and opportunities."
            }
        };


        // Chart Initialization and Update Functions
        const initSecurityCultureChart = () => {
            const ctx = document.getElementById('securityCultureChart').getContext('2d');
            securityCultureChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: securityCultureData.labels,
                    datasets: [{
                        data: securityCultureData.strongCulture.data,
                        backgroundColor: securityCultureData.colors,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed) {
                                        label += context.parsed + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        };

        const updateSecurityCultureChart = (cultureType) => {
            if (securityCultureChartInstance) {
                const data = securityCultureData[cultureType];
                securityCultureChartInstance.data.datasets[0].data = data.data;
                securityCultureChartInstance.update();
                document.getElementById('culture-explanation').textContent = data.explanation;
            }
        };

        const initSecurityInitiativesChart = () => {
            const ctx = document.getElementById('securityInitiativesChart').getContext('2d');
            securityInitiativesChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: securityInitiativesData.labels,
                    datasets: [{
                        label: 'Priority Score',
                        data: securityInitiativesData.complianceDriven.data,
                        backgroundColor: securityInitiativesData.colors,
                        borderColor: securityInitiativesData.colors.map(color => color.replace('0.2)', '1)')), // Solid border
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Priority Score'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Security Initiative'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // Hide dataset label as it's a single bar series
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y;
                                }
                            }
                        }
                    }
                }
            });
        };

        const updateSecurityInitiativesChart = (priorityType) => {
            if (securityInitiativesChartInstance) {
                const data = securityInitiativesData[priorityType];
                securityInitiativesChartInstance.data.datasets[0].data = data.data;
                securityInitiativesChartInstance.update();
                document.getElementById('priority-explanation').textContent = data.explanation;
            }
        };

        const initBudgetChart = () => {
            const ctx = document.getElementById('budgetChart').getContext('2d');
            budgetChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: budgetData.labels,
                    datasets: [{
                        data: budgetData.initial.data,
                        backgroundColor: budgetData.colors,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed) {
                                        label += context.parsed + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        };

        const updateBudgetChart = () => {
            const totalBudgetInput = document.getElementById('totalBudget');
            // Ensure totalBudgetInput exists before trying to access its value
            const rawTotalBudget = totalBudgetInput ? totalBudgetInput.value.replace(/,/g, '') : '0';
            let totalBudget = parseFloat(rawTotalBudget);

            if (!isNaN(totalBudget)) {
                // Format the input value immediately after parsing
                if (totalBudgetInput) { // Check again before setting value
                    totalBudgetInput.value = totalBudget.toLocaleString('en-US');
                }
            } else {
                totalBudget = 0; // Treat invalid input as 0 for calculation
            }

            const techTools = parseFloat(document.getElementById('techToolsPct').value) || 0;
            const personnelStaffing = parseFloat(document.getElementById('personnelStaffingPct').value) || 0;
            const trainingAwareness = parseFloat(document.getElementById('trainingAwarenessPct').value) || 0;
            const complianceAudit = parseFloat(document.getElementById('complianceAuditPct').value) || 0;

            const totalPercentages = techTools + personnelStaffing + trainingAwareness + complianceAudit;

            if (budgetChartInstance && totalPercentages === 100) {
                budgetChartInstance.data.datasets[0].data = [techTools, personnelStaffing, trainingAwareness, complianceAudit];
                budgetChartInstance.update();
                document.getElementById('budget-explanation').textContent = "Adjust the percentages above. The total must equal 100%. The chart dynamically updates to show your budget allocation.";
            } else if (totalPercentages !== 100) {
                document.getElementById('budget-explanation').textContent = `Percentages must total 100%. Current total: ${totalPercentages}%.`;
            }
        };

        const initKriTrendChart = () => {
            const ctx = document.getElementById('kriTrendChart').getContext('2d');
            kriTrendChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: kriTrendData.labels,
                    datasets: [{
                        label: kriTrendData.criticalVulnerabilities.label,
                        data: kriTrendData.criticalVulnerabilities.data,
                        borderColor: kriTrendData.criticalVulnerabilities.borderColor,
                        backgroundColor: kriTrendData.criticalVulnerabilities.backgroundColor,
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Count'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Month'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return context[0].label;
                                }
                            }
                        }
                    }
                }
            });
        };

        const updateKriTrendChart = (kriType) => {
            if (kriTrendChartInstance) {
                const data = kriTrendData[kriType];
                kriTrendChartInstance.data.datasets[0].label = data.label;
                kriTrendChartInstance.data.datasets[0].data = data.data;
                kriTrendChartInstance.data.datasets[0].borderColor = data.borderColor;
                kriTrendChartInstance.data.datasets[0].backgroundColor = data.backgroundColor;
                kriTrendChartInstance.update();
                document.getElementById('kri-explanation').textContent = `This line chart illustrates simulated trends for various Key Risk Indicators (KRIs) over time, helping to anticipate potential issues. Click a button to see its trend. Currently showing: ${data.label}.`;
            }
        };


        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Initial Chart Render
            initSecurityCultureChart();
            initSecurityInitiativesChart();
            initBudgetChart(); // Initialize budget chart
            initKriTrendChart(); // Initialize KRI trend chart

            // Initial budget chart update
            updateBudgetChart();

            // Navigation
            document.querySelectorAll('.nav-item').forEach(button => {
                button.addEventListener('click', () => {
                    document.querySelectorAll('.nav-item').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    document.querySelectorAll('.content-section').forEach(section => {
                        section.classList.add('hidden');
                        section.classList.remove('fade-in');
                    });

                    const targetSection = document.getElementById(button.dataset.target);
                    targetSection.classList.remove('hidden');
                    targetSection.classList.add('fade-in');
                    currentSection.id = button.dataset.target;

                    // Specific rendering for Key Terms section if activated
                    if (button.dataset.target === 'key-terms') {
                        renderKeyTerms();
                    }
                });
            });

            // Set the Introduction tab as active by default on load
            const introButton = document.querySelector('.nav-item[data-target="introduction"]');
            const introSection = document.getElementById('introduction');
            if (introButton && introSection) {
                introButton.classList.add('active');
                introSection.classList.remove('hidden');
                introSection.classList.add('fade-in');
                currentSection.id = 'introduction';
            }

            // Accordion Functionality
            document.querySelectorAll('.accordion-button').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('.accordion-icon');

                    if (content.classList.contains('hidden')) {
                        content.classList.remove('hidden');
                        content.classList.add('fade-in');
                        icon.textContent = '–';
                    } else {
                        content.classList.add('hidden');
                        content.classList.remove('fade-in');
                        icon.textContent = '+';
                    }
                });
            });

            // Security Culture Chart Buttons
            document.querySelectorAll('[data-culture-type]').forEach(button => {
                button.addEventListener('click', () => {
                    updateSecurityCultureChart(button.dataset.cultureType);
                });
            });

            // Leadership Engagement Slider
            const leadershipEngagementSlider = document.getElementById('leadershipEngagement');
            const engagementValueDisplay = document.getElementById('engagementValue');
            const engagementDescriptionDisplay = document.getElementById('engagementDescription');

            const updateEngagementDisplay = (value) => {
                let level = leadershipEngagementLevels[0]; // Default to minimal
                for (let i = 0; i < leadershipEngagementLevels.length; i++) {
                    if (value >= leadershipEngagementLevels[i].value) {
                        level = leadershipEngagementLevels[i];
                    }
                }
                engagementValueDisplay.textContent = level.label;
                engagementDescriptionDisplay.textContent = level.description;
            };

            leadershipEngagementSlider.addEventListener('input', (event) => {
                updateEngagementDisplay(parseInt(event.target.value));
            });
            // Initial update for slider
            updateEngagementDisplay(parseInt(leadershipEngagementSlider.value));


            // Change Management Cards
            document.querySelectorAll('.change-management-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const stepKey = card.dataset.step;

                    // Close all other open cards
                    document.querySelectorAll('.change-management-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    // Toggle the clicked card's active class
                    card.classList.toggle('active');

                    // If the card is now active, populate its description
                    if (card.classList.contains('active') && descriptionDiv && changeManagementSteps[stepKey]) {
                        descriptionDiv.innerHTML = `<p>${changeManagementSteps[stepKey].description}</p>`; // Set content
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = ''; // Clear content if deactivating
                    }
                });
            });


            // Legal Type Cards (new interactive)
            document.querySelectorAll('.legal-type-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const legalTypeKey = card.dataset.legalType;

                    // Close all other open cards in this section
                    document.querySelectorAll('.legal-type-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    // Toggle the clicked card's active class
                    card.classList.toggle('active');

                    // If the card is now active, populate its description
                    if (card.classList.contains('active') && descriptionDiv && legalTypeDescriptions[legalTypeKey]) {
                        descriptionDiv.innerHTML = `<p>${legalTypeDescriptions[legalTypeKey].description}</p>`; // Set content
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = ''; // Clear content if deactivating
                    }
                });
            });

            // Contract Type Cards (new interactive)
            document.querySelectorAll('.contract-type-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const contractTypeKey = card.dataset.contractType;

                    // Close all other open cards in this section
                    document.querySelectorAll('.contract-type-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    // Toggle the clicked card's active class
                    card.classList.toggle('active');

                    // If the card is now active, populate its description
                    if (card.classList.contains('active') && descriptionDiv && contractTypeDescriptions[contractTypeKey]) {
                        descriptionDiv.innerHTML = `<p>${contractTypeDescriptions[contractTypeKey].description}</p>`; // Set content
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = ''; // Clear content if deactivating
                    }
                });
            });


            // Legal, Regulatory, and Contractual Requirements Card Toggles (requirement-card)
            document.querySelectorAll('.requirement-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const reqKey = card.dataset.req;

                    // Close all other open cards in this section
                    document.querySelectorAll('.requirement-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    // Toggle the clicked card's active class
                    card.classList.toggle('active');

                    // If the card is now active, populate its description
                    if (card.classList.contains('active') && descriptionDiv && requirementDescriptions[reqKey]) {
                        descriptionDiv.innerHTML = `<p>${requirementDescriptions[reqKey]}</p>`; // Set content
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = ''; // Clear content if deactivating
                    }
                });
            });

            // Information Security Governance Frameworks and Standards Card Toggles (concept-card)
            document.querySelectorAll('.concept-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const conceptKey = card.dataset.concept;

                    // Close all other open cards in this section
                    document.querySelectorAll('.concept-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    // Toggle the clicked card's active class
                    card.classList.toggle('active');

                    // If the card is now active, populate its description
                    if (card.classList.contains('active') && descriptionDiv && conceptDescriptions[conceptKey]) {
                        descriptionDiv.innerHTML = `<p>${conceptDescriptions[conceptKey]}</p>`; // Set content
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = ''; // Clear content if deactivating
                    }
                });
            });

            // Risk and Control Ownership Role Details (role-node)
            document.querySelectorAll('.role-node').forEach(roleNode => {
                roleNode.addEventListener('click', () => {
                    const roleKey = roleNode.dataset.role;
                    const roleInfo = detailedRoleDescriptions[roleKey];
                    const roleDescriptionDiv = roleNode.querySelector('.role-description');

                    // Close all other open role descriptions
                    document.querySelectorAll('.role-node').forEach(otherRoleNode => {
                        const otherRoleDescriptionDiv = otherRoleNode.querySelector('.role-description');
                        if (otherRoleNode !== roleNode && otherRoleDescriptionDiv && !otherRoleDescriptionDiv.classList.contains('hidden')) {
                            otherRoleNode.classList.remove('active');
                        }
                    });

                    // Toggle the clicked role's active class
                    roleNode.classList.toggle('active');

                    // If the role node is now active, populate its description
                    if (roleNode.classList.contains('active') && roleDescriptionDiv && roleInfo) {
                        roleDescriptionDiv.innerHTML = `<p>${roleInfo.description}</p>`; // Set content
                    } else if (roleDescriptionDiv) {
                        roleDescriptionDiv.innerHTML = ''; // Clear content if deactivating
                    }
                });
            });

            // Governance Structure Cards (new interactive)
            document.querySelectorAll('.governance-structure-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const structureTypeKey = card.dataset.structureType;

                    // Close all other open cards in this section
                    document.querySelectorAll('.governance-structure-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    // Toggle the clicked card's active class
                    card.classList.toggle('active');

                    // If the card is now active, populate its description
                    if (card.classList.contains('active') && descriptionDiv && governanceStructureDescriptions[structureTypeKey]) {
                        descriptionDiv.innerHTML = `<p>${governanceStructureDescriptions[structureTypeKey].description}</p>`; // Set content
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = ''; // Clear content if deactivating
                    }
                });
            });

            // Risk Appetite Cards (new interactive)
            document.querySelectorAll('.risk-appetite-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const appetiteTypeKey = card.dataset.appetiteType;

                    document.querySelectorAll('.risk-appetite-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    card.classList.toggle('active');

                    if (card.classList.contains('active') && descriptionDiv && riskAppetiteDescriptions[appetiteTypeKey]) {
                        descriptionDiv.innerHTML = `<p>${riskAppetiteDescriptions[appetiteTypeKey].description}</p>`;
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = '';
                    }
                });
            });

            // Business Driver Cards (new interactive)
            document.querySelectorAll('.business-driver-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const driverTypeKey = card.dataset.driverType;

                    document.querySelectorAll('.business-driver-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    card.classList.toggle('active');

                    if (card.classList.contains('active') && descriptionDiv && businessDriverDescriptions[driverTypeKey]) {
                        descriptionDiv.innerHTML = `<p>${businessDriverDescriptions[driverTypeKey].description}</p>`;
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = '';
                    }
                });
            });

            // Security Initiatives Chart Buttons
            document.querySelectorAll('[data-priority-type]').forEach(button => {
                button.addEventListener('click', () => {
                    updateSecurityInitiativesChart(button.dataset.priorityType);
                });
            });

            // Budget Allocator Inputs
            document.getElementById('totalBudget').addEventListener('input', updateBudgetChart);
            document.getElementById('techToolsPct').addEventListener('input', updateBudgetChart);
            document.getElementById('personnelStaffingPct').addEventListener('input', updateBudgetChart);
            document.getElementById('trainingAwarenessPct').addEventListener('input', updateBudgetChart);
            document.getElementById('complianceAuditPct').addEventListener('input', updateBudgetChart);

            // KRI Trend Chart Buttons
            document.querySelectorAll('[data-kri-type]').forEach(button => {
                button.addEventListener('click', () => {
                    updateKriTrendChart(button.dataset.kriType);
                });
            });

            // Maturity Level Cards
            document.querySelectorAll('.maturity-level-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const levelTypeKey = card.dataset.maturityLevel;

                    document.querySelectorAll('.maturity-level-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    card.classList.toggle('active');

                    if (card.classList.contains('active') && descriptionDiv && maturityLevelDescriptions[levelTypeKey]) {
                        descriptionDiv.innerHTML = `<p>${maturityLevelDescriptions[levelTypeKey].description}</p>`;
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = '';
                    }
                });
            });


            // Framework Adoption Journey Nodes
            document.querySelectorAll('.framework-step-node').forEach(node => {
                node.addEventListener('click', () => {
                    const descriptionDiv = node.querySelector('.node-description');
                    const stepId = node.dataset.stepId;

                    document.querySelectorAll('.framework-step-node').forEach(otherNode => {
                        const otherDescriptionDiv = otherNode.querySelector('.node-description');
                        if (otherNode !== node && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherNode.classList.remove('active');
                        }
                    });

                    node.classList.toggle('active');

                    if (node.classList.contains('active') && descriptionDiv && frameworkSteps[stepId]) {
                        descriptionDiv.innerHTML = `<p>${frameworkSteps[stepId].description}</p>`;
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = '';
                    }
                });
            });


            // Function to render Key Terms cards
            const renderKeyTerms = () => {
                const keyTermsContainer = document.querySelector('#key-terms .grid');
                if (!keyTermsContainer) return; // Exit if container not found
                keyTermsContainer.innerHTML = ''; // Clear existing cards

                keyTermsData.forEach((item, index) => {
                    const cardHtml = `
                        <div class="key-term-card" data-term-key="${index}">
                            <h3 class="card-title">${item.term}</h3>
                            <div class="card-description"></div>
                        </div>
                    `;
                    keyTermsContainer.insertAdjacentHTML('beforeend', cardHtml);
                });

                // Add event listeners for key term cards
                document.querySelectorAll('.key-term-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const descriptionDiv = card.querySelector('.card-description');
                        const termIndex = parseInt(card.dataset.termKey);

                        // Close all other open cards and remove 'active' class
                        document.querySelectorAll('.key-term-card').forEach(otherCard => {
                            if (otherCard !== card) {
                                otherCard.classList.remove('active');
                            }
                        });

                        // Toggle the clicked card's active class
                        card.classList.toggle('active');

                        // If the card is now active, populate its description
                        if (card.classList.contains('active') && descriptionDiv && keyTermsData[termIndex]) {
                            descriptionDiv.innerHTML = `<p>${keyTermsData[termIndex].definition}</p>`; // Set content
                        } else if (descriptionDiv) {
                            descriptionDiv.innerHTML = '';
                        }
                    });
                });
            };
        });
    </script>
</body>
</html>
