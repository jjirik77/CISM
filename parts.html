<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CISM Interactive Study Guide (All Domains)</title>
    <!-- Tailwind CSS CDN for utility classes -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN for interactive charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* --- MASTER STYLESHEET (Combined & Deduplicated from all 4 Domains) --- */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        
        /* --- BASE & LAYOUT --- */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F5EF; /* Warm Neutral Background */
            color: #333333;
        }
        .container {
            max-width: 1200px;
        }
        .section-header {
            border-left: 6px solid #00A896; /* Vibrant Teal Accent */
            padding-left: 1.25rem;
            font-size: 2.2rem; /* Standardized size */
            color: #222222; /* Darker text for contrast */
        }

        /* --- NAVIGATION --- */
        .master-nav-item {
            transition: all 0.2s ease-in-out;
            text-align: left;
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
        }
        .master-nav-item.active {
            background-color: #E0F7F5; /* Light Teal */
            border-left: 4px solid #00A896;
        }
        .master-nav-item.active .domain-title {
             color: #00796B;
        }
        .master-nav-item:not(.active):hover {
            background-color: #e2e8f0; /* light gray hover */
        }

        .domain-nav-item { /* For intra-domain navigation */
            transition: all 0.2s ease-in-out;
        }
        .domain-nav-item.active {
            border-bottom: 3px solid #00A896;
            font-weight: 700;
            color: #222222;
        }
        
        /* --- ACCORDIONS --- */
        .accordion-button {
            background-color: #EDEAE0;
            border-bottom: 1px solid #D5D2C8;
            border-radius: 0.75rem;
            padding: 1rem 1.5rem;
            font-size: 1.25rem;
            font-weight: 700;
            color: #333333;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-align: left;
            cursor: pointer;
        }
        .accordion-button:hover {
            background-color: #D5D2C8;
            transform: translateY(-1px);
        }
        .accordion-content {
            background-color: #FFFFFF;
            border: 1px solid #D5D2C8;
            border-top: none;
            border-radius: 0 0 0.75rem 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }

        /* --- INTERACTIVE CARDS (UNIFIED) --- */
        .interactive-card, .concept-card, .requirement-card, .key-term-card, .change-management-card, .legal-type-card, .contract-type-card, .governance-structure-card, .risk-appetite-card, .business-driver-card, .framework-step-node, .maturity-level-card, .risk-framework-card, .risk-response-card, .risk-method-card, .vulnerability-scenario-card, .role-node, .flow-node, .incident-lifecycle-node {
            background-color: #EDEAE0;
            border: 1px solid #D5D2C8;
            padding: 1rem;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            box-sizing: border-box;
            text-align: center;
            font-weight: 600;
            color: #333333;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
            max-height: 120px; /* Base max-height for transition */
            overflow: hidden;
        }
        .interactive-card:hover, .concept-card:hover, .requirement-card:hover, .key-term-card:hover, .change-management-card:hover, .legal-type-card:hover, .contract-type-card:hover, .governance-structure-card:hover, .risk-appetite-card:hover, .business-driver-card:hover, .framework-step-node:hover, .maturity-level-card:hover, .risk-framework-card:hover, .risk-response-card:hover, .risk-method-card:hover, .vulnerability-scenario-card:hover, .role-node:hover, .flow-node:hover, .incident-lifecycle-node:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        .interactive-card.active, .concept-card.active, .requirement-card.active, .key-term-card.active, .change-management-card.active, .legal-type-card.active, .contract-type-card.active, .governance-structure-card.active, .risk-appetite-card.active, .business-driver-card.active, .framework-step-node.active, .maturity-level-card.active, .risk-framework-card.active, .risk-response-card.active, .risk-method-card.active, .vulnerability-scenario-card.active, .role-node.active, .flow-node.active, .incident-lifecycle-node.active {
            border-color: #00A896;
            box-shadow: 0 4px 8px rgba(0, 168, 150, 0.3);
            background-color: #E0F7F5;
            max-height: 5000px; /* Set a very large max-height to ensure full expansion */
        }
        .card-title, .role-title, .node-title {
            font-size: 1.1em;
            margin-bottom: 0.6rem;
            color: #004085;
        }
        .card-description, .role-description, .node-description {
            font-weight: 400;
            font-size: 0.9em;
            color: #555555;
            margin-top: 0.5rem;
            display: none;
            text-align: left;
            word-break: break-word;
        }
        .active .card-description, .active .role-description, .active .node-description {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        .key-term-card .card-description { text-align: center; }
        .vulnerability-scenario-card .card-description { text-align: left; }

        /* --- Polished Table Styles --- */
        .styled-table {
            width: 100%;
            max-width: 100%;
            margin: 1.5rem auto;
            border-collapse: collapse;
            font-size: 1rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .styled-table th, .styled-table td {
            padding: 1rem 1.25rem;
            text-align: left;
            border: none;
            border-bottom: 1px solid #e2e8f0;
        }
        .styled-table th {
            background-color: #f8fafc;
            font-weight: 700;
            color: #334155;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 0.85rem;
        }
        .styled-table td {
            background-color: #FFFFFF;
            color: #475569;
        }
        .styled-table tbody tr:last-child td {
            border-bottom: none;
        }
        .styled-table .highlight {
            font-weight: 700;
            color: #00796B;
        }
        .styled-table td:first-child, .styled-table th:first-child {
            font-weight: 600;
            color: #334155;
        }
        
        /* --- KEYFRAMES --- */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        /* --- DOMAIN SPECIFIC STYLES --- */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            height: 50vh;
            max-height: 500px;
            margin-left: auto;
            margin-right: auto;
            overflow: hidden;
        }
        .slider-container {
            width: 80%;
            max-width: 500px;
            margin: 2rem auto;
            text-align: center;
            background-color: #EDEAE0;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }
        .slider-container input[type="range"] { width: 100%; }

        .framework-journey-container, .hierarchy-chart-container, .incident-lifecycle-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background-color: #F8F5EF;
            border-radius: 0.5rem;
            max-width: 600px;
            margin: 1rem auto;
        }
        .framework-arrow, .hierarchy-line, .incident-lifecycle-arrow {
            width: 2px;
            height: 2rem;
            background-color: #D5D2C8;
        }
        
        .maturity-arrow-right {
            font-size: 2.5rem;
            color: #b0bec5;
            line-height: 1;
        }

        .risk-matrix-table, .risk-scorecard-table {
            width: 100%;
            max-width: 600px;
            margin: 1rem auto;
            border-collapse: collapse;
        }
        .risk-matrix-table th, .risk-matrix-table td, .risk-scorecard-table th, .risk-scorecard-table td {
            border: 1px solid #D5D2C8;
            padding: 0.75rem;
            text-align: center;
            font-weight: 600;
        }
        .risk-matrix-table th, .risk-scorecard-table th {
            background-color: #EDEAE0;
            color: #333333;
        }
        .risk-matrix-table td, .risk-scorecard-table td {
            background-color: #FFFFFF;
        }
        .risk-matrix-table .low, .risk-scorecard-table .risk-level-low { background-color: #D4EDDA; color: #155724; }
        .risk-matrix-table .medium, .risk-scorecard-table .risk-level-medium { background-color: #FFF3CD; color: #856404; }
        .risk-matrix-table .high, .risk-scorecard-table .risk-level-high { background-color: #F8D7DA; color: #721C24; }
        .risk-matrix-table .critical, .risk-scorecard-table .critical { background-color: #DC3545; color: #FFFFFF; }

        .risk-response-card.mitigate { background-color: #D4EDDA; color: #155724; }
        .risk-response-card.mitigate:hover { background-color: #C3E6CB; }
        .risk-response-card.transfer { background-color: #CCE5FF; color: #004085; }
        .risk-response-card.transfer:hover { background-color: #B8DAFF; }
        .risk-response-card.avoid { background-color: #F8D7DA; color: #721C24; }
        .risk-response-card.avoid:hover { background-color: #F5C6CB; }
        .risk-response-card.accept { background-color: #FFF3CD; color: #856404; }
        .risk-response-card.accept:hover { background-color: #FFECB3; }

        .risk-method-card.qualitative { background-color: #F0F8FF; color: #001f3f; }
        .risk-method-card.qualitative:hover { background-color: #E0F2FF; }
        .risk-method-card.quantitative { background-color: #F5FFFA; color: #003300; }
        .risk-method-card.quantitative:hover { background-color: #E6FFF2; }
        .risk-method-card.hybrid { background-color: #FAEBD7; color: #4B0082; }
        .risk-method-card.hybrid:hover { background-color: #F0DDC0; }

        .btn-ransomware { background-color: #A1C9CE; color: #333333; }
        .btn-ransomware:hover { background-color: #8FB8A1; }
        .btn-insider-threats { background-color: #8FB8A1; color: #333333; }
        .btn-insider-threats:hover { background-color: #6F9C7D; }
        .btn-third-party-risks { background-color: #FFD700; color: #333333; }
        .btn-third-party-risks:hover { background-color: #E0B800; }
        .btn-phishing { background-color: #FF6384; color: #FFFFFF; }
        .btn-phishing:hover { background-color: #E04B6D; }
        .btn-ddos { background-color: #6A5ACD; color: #FFFFFF; }
        .btn-ddos:hover { background-color: #5A4DAA; }
        .btn-apt { background-color: #DAA520; color: #333333; }
        .btn-apt:hover { background-color: #B8860B; }

        .flow-scenario { display: flex; flex-direction: column; align-items: center; margin-bottom: 2rem; }
        .flow-scenario .flow-node { max-width: 150px; }
        .flow-arrow { width: 2px; height: 2rem; background-color: #D5D2C8; margin: 0.5rem 0; position: relative; }
        .flow-arrow::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%) translateY(50%) rotate(135deg); width: 8px; height: 8px; border-top: 2px solid #D5D2C8; border-right: 2px solid #D5D2C8; }
        .vulnerability-node { background-color: #F0F8FF; }
        .vulnerability-node:hover { background-color: #DDEBF7; }
        .threat-node { background-color: #FFF3CD; }
        .threat-node:hover { background-color: #FFE699; }
        .impact-node { background-color: #F8D7DA; }
        .impact-node:hover { background-color: #F5C6CB; }
        
        /* --- QUIZ STYLES --- */
        .quiz-question-container {
            background-color: #fff;
            padding: 2rem;
            margin-bottom: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.07);
        }
        .quiz-option {
            display: block;
            width: 100%;
            text-align: left;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border: 2px solid #e2e8f0;
            border-radius: 0.5rem;
            background-color: #f8fafc;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .quiz-option:hover {
            border-color: #00A896;
            background-color: #E0F7F5;
        }
        .quiz-option.selected {
            border-color: #00796B;
            background-color: #B2DFDB;
        }
        .quiz-feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
        }
        .quiz-feedback.correct {
            background-color: #D4EDDA;
            color: #155724;
            border-left: 5px solid #28A745;
        }
        .quiz-feedback.incorrect {
            background-color: #F8D7DA;
            color: #721C24;
            border-left: 5px solid #DC3545;
        }
        .quiz-explanation {
            margin-top: 0.5rem;
            font-style: italic;
            color: #475569;
        }
        #quiz-results {
            background-color: #E0F7F5;
            border: 2px solid #00A896;
            padding: 2rem;
            text-align: center;
            border-radius: 0.75rem;
        }
    </style>
</head>
<body class="leading-relaxed">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <!-- MASTER HEADER -->
        <header class="text-center py-6 bg-white rounded-lg shadow-lg mb-8">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 mb-2">CISM Study Guide</h1>
            <p class="text-xl sm:text-2xl text-gray-600">Comprehensive Interactive Educational Resource for CISM Certification Exam</p>
        </header>

        <!-- Main Content Layout (2-column on desktop, 1-column on mobile) -->
        <div class="flex flex-col md:flex-row gap-8">
            
            <!-- Left Column: Master Navigation -->
            <aside class="md:w-1/4 lg:w-1/5">
                <nav id="master-navigation" class="bg-white p-4 rounded-lg shadow-md flex flex-col space-y-2 sticky top-4">
                    <button class="master-nav-item text-gray-700 active" data-domain-target="about-cism">
                        <div class="flex flex-col">
                            <span class="font-bold text-base domain-title">CISM Introduction</span>
                            <span class="text-sm font-normal">Certification Overview</span>
                        </div>
                    </button>
                    <button class="master-nav-item text-gray-700" data-domain-target="domain-1">
                        <div class="flex flex-col">
                            <span class="font-bold text-base domain-title">Domain 1</span>
                            <span class="text-sm font-normal">Governance</span>
                        </div>
                    </button>
                    <button class="master-nav-item text-gray-700" data-domain-target="domain-2">
                        <div class="flex flex-col">
                            <span class="font-bold text-base domain-title">Domain 2</span>
                            <span class="text-sm font-normal">Risk Management</span>
                        </div>
                    </button>
                    <button class="master-nav-item text-gray-700" data-domain-target="domain-3">
                        <div class="flex flex-col">
                            <span class="font-bold text-base domain-title">Domain 3</span>
                            <span class="text-sm font-normal">Program Development</span>
                        </div>
                    </button>
                    <button class="master-nav-item text-gray-700" data-domain-target="domain-4">
                        <div class="flex flex-col">
                            <span class="font-bold text-base domain-title">Domain 4</span>
                            <span class="text-sm font-normal">Incident Management</span>
                        </div>
                    </button>
                    <button class="master-nav-item text-gray-700" data-domain-target="assessment">
                        <div class="flex flex-col">
                            <span class="font-bold text-base domain-title">Assessment</span>
                            <span class="text-sm font-normal">Test Your Knowledge</span>
                        </div>
                    </button>
                </nav>
            </aside>

            <!-- Right Column: Main Content Area -->
            <main class="flex-1">
                <div id="domains-content-area">
                    <!-- =============================================================================== -->
                    <!-- == ABOUT CISM ================================================================= -->
                    <!-- =============================================================================== -->
                    <div id="about-cism" class="domain-content-section fade-in">
                        <header class="text-center py-8 bg-white rounded-lg shadow-md mb-8">
                            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 mb-2">CISM Certification Overview</h1>
                            <p class="text-xl sm:text-2xl text-gray-600">Certified Information Security Manager</p>
                            <p class="text-md text-gray-500 mt-2">Your guide to the premier credential for information security leadership.</p>
                        </header>

                        <nav class="bg-white p-4 rounded-lg shadow-md mb-8 flex justify-center sticky top-0 z-10">
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200 active" data-target="overview">Why CISM?</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="exam-details">Exam Details</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="maintenance">Maintenance</button>
                        </nav>

                        <main id="content-area">
                            <!-- Why CISM? Section -->
                            <section id="overview" class="content-section fade-in">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Why Pursue the CISM Certification?</h2>
                                <div class="p-6 bg-white rounded-lg shadow-md mb-6">
                                    <p class="text-gray-700">The Certified Information Security Manager (CISM) certification, issued by ISACA, is a premier credential for professionals managing and overseeing information security systems in alignment with business goals. Focused on governance, risk management, and leadership, CISM is ideal for security managers, CISOs, and consultants who drive security strategies across the enterprise. Click on the cards below to explore the key benefits.</p>
                                </div>
                                <div id="why-cism-cards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" data-group="why-cism">
                                    <!-- Cards will be populated by JavaScript -->
                                </div>
                            </section>

                            <!-- Exam Details Section -->
                            <section id="exam-details" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">CISM Exam Details</h2>
                                <p class="mb-8 text-gray-700">Everything you need to know about the CISM exam, from its format and cost to the experience required and testing options.</p>

                                <!-- Accordion for Exam Details -->
                                <div class="space-y-4">
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">
                                            <span>Exam Format & Domains</span>
                                            <span class="accordion-icon text-2xl">+</span>
                                        </button>
                                        <div class="accordion-content hidden p-6">
                                            <ul class="list-disc list-inside text-gray-700 space-y-2 mb-4">
                                                <li><strong>Format:</strong> 150 multiple-choice questions</li>
                                                <li><strong>Duration:</strong> 4 hours (240 minutes)</li>
                                                <li><strong>Passing Score:</strong> 450 out of 800 (scaled score)</li>
                                            </ul>
                                            <div id="domain-cards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 my-4" data-group="exam-domains">
                                                <!-- Domain cards will be injected here by JS -->
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">
                                            <span>Cost of Certification</span>
                                            <span class="accordion-icon text-2xl">+</span>
                                        </button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">The cost varies depending on your ISACA membership status. Members receive a significant discount on both the exam and annual maintenance fees.</p>
                                            <table class="styled-table">
                                                <thead>
                                                    <tr>
                                                        <th>Category</th>
                                                        <th>Exam Fee</th>
                                                        <th>Annual Maintenance Fee</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><strong>ISACA Member</strong></td>
                                                        <td class="highlight">$575 USD</td>
                                                        <td class="highlight">$45 USD</td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>Non-Member</strong></td>
                                                        <td class="highlight">$760 USD</td>
                                                        <td class="highlight">$85 USD</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">
                                            <span>Experience & Membership Requirements</span>
                                            <span class="accordion-icon text-2xl">+</span>
                                        </button>
                                        <div class="accordion-content hidden p-6">
                                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Experience Required</h4>
                                            <p class="text-gray-700 mb-4">A minimum of <strong>5 years</strong> of professional information security management work experience is required for certification.</p>
                                            <ul class="list-disc list-inside text-gray-700 space-y-2 mb-4">
                                                <li>3 of those years must be in at least 3 of the 4 CISM domains.</li>
                                                <li>Substitutions for up to 2 years of general experience are available based on qualifying certifications (like CISSP, CISA) or a postgraduate degree in a related field.</li>
                                            </ul>
                                             <h4 class="text-lg font-semibold text-gray-800 mb-2">ISACA Membership (Optional)</h4>
                                             <p class="text-gray-700">While not mandatory, ISACA membership offers significant benefits, including exam discounts, free webinars, access to research, and networking opportunities with a global community of professionals.</p>
                                        </div>
                                    </div>
                                     <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">
                                            <span>Where to Take the Exam</span>
                                            <span class="accordion-icon text-2xl">+</span>
                                        </button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">ISACA offers flexible testing options to accommodate candidates worldwide. You can schedule your exam year-round through the official ISACA website.</p>
                                             <ul class="list-disc list-inside text-gray-700 space-y-3">
                                                 <li>
                                                     <strong>Remote Proctored Online Exam:</strong> Take the exam from the comfort of your home or office. This option is available through both PSI and Pearson VUE platforms, monitored by a live proctor via webcam.
                                                 </li>
                                                 <li>
                                                     <strong>In-Person Testing Centers:</strong> For those who prefer a traditional testing environment, the exam is offered at Pearson VUE testing centers located globally.
                                                 </li>
                                             </ul>
                                            <p class="mt-4 text-gray-600 text-sm italic">Visit <a href="https://www.isaca.org" target="_blank" class="text-blue-600 hover:underline">www.isaca.org</a> to find a testing center or schedule your remote exam.</p>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- Maintenance Section -->
                            <section id="maintenance" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Maintaining Your CISM Certification</h2>
                                <p class="mb-8 text-gray-700">Holding the CISM certification is an ongoing commitment to professional development. To maintain your credential, you must adhere to ISACA's requirements for continuing professional education (CPE) and professional conduct.</p>
                                <div class="p-6 bg-white rounded-lg shadow-md">
                                    <h4 class="text-xl font-bold text-gray-800 mb-4">CPE Requirements</h4>
                                    <p class="text-gray-700 mb-4">You must demonstrate your commitment to keeping your skills current by earning and reporting Continuing Professional Education (CPE) credits.</p>
                                    <ul class="list-disc list-inside text-gray-700 space-y-2 mb-6">
                                       <li>Earn a minimum of <strong>20 CPE credits annually</strong>.</li>
                                       <li>Earn a total of <strong>120 CPE credits over a 3-year reporting cycle</strong>.</li>
                                    </ul>

                                    <h4 class="text-xl font-bold text-gray-800 mb-4">Annual Maintenance Fee</h4>
                                    <p class="text-gray-700 mb-4">An annual fee is required to maintain your certification in good standing.</p>
                                     <table class="styled-table">
                                        <thead>
                                            <tr>
                                                <th>Category</th>
                                                <th>Annual Maintenance Fee</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><strong>ISACA Member</strong></td>
                                                <td class="highlight">$45 USD</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Non-Member</strong></td>
                                                <td class="highlight">$85 USD</td>
                                            </tr>
                                        </tbody>
                                    </table>

                                     <h4 class="text-xl font-bold text-gray-800 mt-6 mb-4">Other Requirements</h4>
                                     <ul class="list-disc list-inside text-gray-700 space-y-2">
                                         <li>Adhere to ISACAâ€™s <strong>Code of Professional Ethics</strong>.</li>
                                         <li>Comply with the CISM <strong>Continuing Professional Education (CPE) Policy</strong> and reporting requirements.</li>
                                     </ul>
                                </div>
                            </section>
                        </main>
                    </div>

                    <!-- =============================================================================== -->
                    <!-- == DOMAIN 1: INFORMATION SECURITY GOVERNANCE ================================== -->
                    <!-- =============================================================================== -->
                    <div id="domain-1" class="domain-content-section hidden">
                        <header class="text-center py-8 bg-white rounded-lg shadow-md mb-8">
                            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 mb-2">CISM Domain 1 Study Guide</h1>
                            <p class="text-xl sm:text-2xl text-gray-600">Information Security Governance</p>
                            <p class="text-md text-gray-500 mt-2">Your Interactive Study Guide for Strategic Security Leadership</p>
                        </header>

                        <nav class="bg-white p-4 rounded-lg shadow-md mb-8 flex justify-center sticky top-0 z-10 overflow-x-auto">
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200 active" data-target="introduction-d1">Introduction</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="enterprise-governance-d1">Enterprise Governance</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="info-sec-strategy-d1">Information Security Strategy</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="key-terms-d1">Key Terms</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="domain-summary-d1">Domain Summary</button>
                        </nav>

                        <main>
                            <!-- Introduction Section -->
                            <section id="introduction-d1" class="content-section fade-in">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Introduction to CISM Domain 1</h2>
                                <div class="p-6 bg-white rounded-lg shadow-md">
                                    <p class="text-gray-700 mb-4">Welcome to the interactive study guide for CISM Domain 1: Information Security Governance. This domain is the foundational pillar of effective information security management, emphasizing the strategic alignment of security initiatives with overall business objectives. It's about establishing the framework, roles, and responsibilities that ensure information security is an integral part of the enterprise's governance structure.</p>
                                    <p class="text-gray-700">As a Certified Information Security Manager, you are expected to understand how to develop, implement, and oversee an information security governance framework that not only protects information assets but also enables business operations and ensures compliance with legal, regulatory, and contractual requirements. This guide will help you explore the critical components of governance, from organizational culture to strategic planning and resource management.</p>
                                </div>
                            </section>

                            <!-- Enterprise Governance Section -->
                            <section id="enterprise-governance-d1" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section A: Enterprise Governance</h2>
                                <p class="mb-8 text-gray-700">Enterprise governance provides the structure through which the objectives of the organization are set and pursued. Information security governance must be an integral part of this broader framework.</p>

                                <!-- Accordions for Section A -->
                                <div class="space-y-4">
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">1. Organizational Culture and its Impact<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                             <p class="text-gray-700 mb-4">Organizational culture significantly influences the effectiveness of information security. A strong security culture fosters proactive behavior and shared responsibility.</p>
                                             <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Influence of corporate culture on security behaviors and decision-making.</h4>
                                             <p class="text-gray-600 mb-4">Corporate culture profoundly shapes how individuals perceive and engage with security. It impacts risk appetite and influences security-related decisions. For instance, a culture prioritizing rapid innovation might accept higher security risks.</p>
                                             <div class="chart-container mb-6"><canvas id="securityCultureChart"></canvas></div>
                                             <div class="flex flex-wrap justify-center gap-4 mb-4">
                                                 <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #00A896; color: white;" data-culture-type="strongCulture">Strong Security Culture</button>
                                                 <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #DC3545; color: white;" data-culture-type="weakCulture">Weak Security Culture</button>
                                             </div>
                                             <div id="culture-explanation" class="text-gray-600 text-sm italic mt-2 text-center">This chart illustrates a simulated distribution of employee security behaviors based on the prevailing organizational culture. Use the buttons to see how culture can shift these behaviors.</div>
                                            
                                             <h4 class="text-lg font-semibold text-gray-700 mb-3 mt-6">b. Promoting a security-aware culture through leadership and communication.</h4>
                                             <p class="text-gray-600 mb-4">Cultivating a security-aware culture requires continuous effort, driven by leadership and effective communication. This includes comprehensive security awareness programs, clear policies, and open communication channels to foster vigilance.</p>
                                            
                                             <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Tone at the top: executive sponsorship and support.</h4>
                                             <p class="text-gray-600 mb-4">The commitment of senior management is paramount. Executive sponsorship ensures visible commitment, adequate resource allocation, and accountability for security across the organization.</p>
                                             <div class="slider-container">
                                                 <label for="leadershipEngagement" class="slider-label">Leadership Engagement Level</label>
                                                 <input type="range" id="leadershipEngagement" min="0" max="100" value="50" step="1">
                                                 <div class="slider-value" id="engagementValue">Moderate Engagement</div>
                                                 <div class="slider-description" id="engagementDescription">Policies are generally followed, but security may lack strong strategic momentum or innovation.</div>
                                             </div>
                                             <p class="text-gray-600 text-sm italic mt-2 text-center">Adjust the slider to see how different levels of leadership engagement can influence the organizational security culture.</p>

                                             <h4 class="text-lg font-semibold text-gray-700 mb-3 mt-6">d. Change management and resistance mitigation in security initiatives.</h4>
                                             <p class="text-gray-600 mb-4">Implementing new security measures often encounters resistance. Effective change management involves early stakeholder engagement, clear communication of the "why," and providing adequate training and support to facilitate adoption. Click on each step to learn more:</p>
                                             <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6" data-group="change-management">
                                                 <div class="change-management-card"><span class="card-title">Communicate Early & Often</span><div class="card-description">Proactive and transparent communication about upcoming changes, their benefits, and potential impacts helps reduce uncertainty and build trust.</div></div>
                                                 <div class="change-management-card"><span class="card-title">Address Concerns</span><div class="card-description">Establish channels for feedback and actively listen to and address employee concerns, fears, and questions about new security initiatives.</div></div>
                                                 <div class="change-management-card"><span class="card-title">Provide Training & Support</span><div class="card-description">Offer comprehensive and accessible training, along with ongoing support, to ensure employees understand new security processes and tools.</div></div>
                                                 <div class="change-management-card"><span class="card-title">Celebrate Successes</span><div class="card-description">Recognize and reward positive security behaviors and successful adoption of new measures to reinforce the desired culture and motivate continued compliance.</div></div>
                                             </div>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">2. Legal, Regulatory, and Contractual Requirements<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Information security governance must ensure compliance with a complex web of legal, regulatory, and contractual obligations.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Identification and interpretation of applicable laws and regulations</h4>
                                            <p class="text-gray-600 mb-4">Organizations must identify all pertinent laws and regulations based on their operations, industry, and geography. Explore key regulations by region/type:</p>
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6" data-group="legal-type">
                                                <div class="concept-card"> <span class="card-title">European Union</span><div class="card-description">Regulations like GDPR (General Data Protection Regulation) focus on data privacy and protection for individuals within the EU.</div></div>
                                                <div class="concept-card"> <span class="card-title">USA (Federal & State)</span><div class="card-description">Includes federal laws like HIPAA (Health Insurance Portability and Accountability Act) for healthcare data, and state-specific laws like CCPA (California Consumer Privacy Act).</div></div>
                                                <div class="concept-card"> <span class="card-title">Global & Industry Specific</span><div class="card-description">Beyond regional laws, organizations must comply with global standards (e.g., ISO 27001) and industry-specific mandates (e.g., PCI DSS for payment cards, NERC CIP for critical infrastructure).</div></div>
                                            </div>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Contractual obligations related to information security</h4>
                                            <p class="text-gray-600 mb-4">Beyond laws, contracts impose specific security requirements. Click on a contract type to see typical security clauses:</p>
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6" data-group="contract-type">
                                                <div class="concept-card"><span class="card-title">Service Level Agreement (SLA)</span><div class="card-description">Defines the level of service expected from a vendor, including security performance metrics, incident response times, and data protection clauses.</div></div>
                                                <div class="concept-card"><span class="card-title">Business Associate Agreement (BAA)</span><div class="card-description">Required under HIPAA, this contract specifies how business associates (third-party service providers) will safeguard Protected Health Information (PHI) on behalf of a covered entity.</div></div>
                                                <div class="concept-card"><span class="card-title">Non-Disclosure Agreement (NDA)</span><div class="card-description">A legal contract that outlines confidential material, knowledge, or information that the parties wish to share with one another but restrict access to by third parties. It includes clauses on data protection and handling.</div></div>
                                            </div>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Security's role in legal compliance and audit readiness</h4>
                                            <p class="text-gray-600 mb-4">Information security is central to achieving and demonstrating compliance. This involves establishing compliance programs, preparing for audits with robust documentation, and continuous monitoring of control effectiveness.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">d. Data protection and privacy laws by region/jurisdiction</h4>
                                            <p class="text-gray-600 mb-4">The global privacy landscape necessitates understanding specific laws across jurisdictions (e.g., GDPR in EU, CCPA in California), particularly for cross-border data transfers and implementing 'privacy by design' principles.</p>
                                            <h4 class="text-lg font-semibold text-gray-700">e. Intellectual property rights, industry-specific mandates</h4>
                                            <p class="text-gray-600">Protecting Intellectual property through security controls and adhering to industry-specific mandates (e.g., PCI DSS, NERC CIP) are critical for protecting assets and ensuring operational continuity within specific sectors.</p>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">3. Organizational Structures, Roles, and Responsibilities<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Effective Information security governance relies on clearly defined organizational structures, roles, and responsibilities. This clarity ensures accountability, prevents gaps, and facilitates efficient execution of security functions.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Governance structures (centralized, decentralized, hybrid)</h4>
                                            <p class="text-gray-600 mb-4">Organizations adopt different models for security governance. Explore the common structures below:</p>
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6" data-group="governance-structure">
                                                 <div class="concept-card"><span class="card-title">Centralized</span><div class="card-description">Security decisions and control are concentrated in a single department or team (e.g., a dedicated CISO office). This provides consistency and strong oversight but can be less agile in large, diverse organizations.</div></div>
                                                 <div class="concept-card"><span class="card-title">Decentralized</span><div class="card-description">Security responsibilities are distributed across various business units or departments. This can promote agility and local ownership but may lead to inconsistencies and gaps without strong coordination.</div></div>
                                                 <div class="concept-card"><span class="card-title">Hybrid</span><div class="card-description">Combines elements of both centralized and decentralized models. A central security function sets overall strategy and standards, while business units handle day-to-day implementation and local adaptations. This aims to balance consistency with agility.</div></div>
                                            </div>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Defining roles and responsibilities: Board, Executive, CISO, Data Owners, Users</h4>
                                            <p class="text-gray-600 mb-4">Clear role definitions are fundamental to accountability. Each level, from the Board with ultimate oversight to every user adhering to policies, plays a crucial part in the security posture.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Segregation of duties (SoD), accountability, escalation paths</h4>
                                            <p class="text-gray-600 mb-4">Implementing Segregation of Duties prevents a single point of control, reducing fraud and error. Clear accountability ensures ownership, while defined escalation paths enable timely incident and risk resolution.</p>
                                            <h4 class="text-lg font-semibold text-gray-700">d. Security steering committees and governance forums</h4>
                                            <p class="text-gray-600">Formal committees and forums provide structured decision-making and oversight, ensuring strategic direction and alignment with business objectives.</p>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- Information Security Strategy Section -->
                            <section id="info-sec-strategy-d1" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section B: Information Security Strategy</h2>
                                <p class="mb-8 text-gray-700">An information security strategy translates the organization's business objectives into actionable security goals and initiatives.</p>
                                
                                <div class="space-y-4">
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">1. Information Security Strategy Development<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Developing a robust information security strategy requires a systematic approach.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Alignment of security objectives with organizational goals</h4>
                                            <p class="text-gray-600 mb-4">The cornerstone of any effective security strategy is its direct alignment with the organization's overarching business goals. Security should enable business objectives and manage risks effectively.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Defining vision, mission, and guiding principles for the security program</h4>
                                            <p class="text-gray-600 mb-4">Just like the broader organization, the security program needs clear vision, mission, and guiding principles to define its purpose and inform all security decisions and actions.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Determining risk appetite and tolerance</h4>
                                            <p class="text-gray-600 mb-4">Understanding the organization's willingness to accept risk (risk appetite) and acceptable deviation (risk tolerance) is crucial for shaping the security strategy and prioritizing investments. Explore different risk appetites:</p>
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6" data-group="risk-appetite">
                                                <div class="risk-appetite-card"><span class="card-title">Risk Averse</span><div class="card-description">Prefers to avoid risk as much as possible, even if it means missing potential opportunities. Focuses heavily on preventative controls and strict compliance.</div></div>
                                                <div class="risk-appetite-card"><span class="card-title">Conservative</span><div class="card-description">Willing to accept a low level of risk, but generally prefers established, proven security measures. Prioritizes stability and minimizing potential losses.</div></div>
                                                <div class="risk-appetite-card"><span class="card-title">Moderate</span><div class="card-description">Balances risk and reward, accepting a reasonable level of risk to achieve business objectives. Invests in security controls that provide a good return on investment.</div></div>
                                                <div class="risk-appetite-card"><span class="card-title">Risk Aggressive</span><div class="card-description">Willing to take on higher levels of risk for potentially greater rewards, often seen in innovative or rapidly growing organizations. Focuses on rapid detection and response capabilities.</div></div>
                                            </div>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">d. Incorporating threat landscape and business drivers</h4>
                                            <p class="text-gray-600 mb-4">The strategy must be dynamic, continuously adapting to evolving external threats (threat landscape) and internal business needs (business drivers) to remain relevant and effective. Map business drivers to security objective mapper:</p>
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6" data-group="business-driver">
                                                <div class="business-driver-card"><span class="card-title">Digital Transformation</span><div class="card-description">Security objectives align with securing new digital platforms, cloud environments, and data analytics initiatives. Focus on cloud security, data privacy, and secure development.</div></div>
                                                <div class="business-driver-card"><span class="card-title">Global Expansion</span><div class="card-description">Security objectives include understanding and complying with international regulations and securing global supply chains.</div></div>
                                                <div class="business-driver-card"><span class="card-title">Cost Optimization</span><div class="card-description">Security objectives focus on efficiency and cost-effectiveness of controls while maintaining an acceptable risk posture.</div></div>
                                                <div class="business-driver-card"><span class="card-title">New Product Launch</span><div class="card-description">Security objectives prioritize security-by-design, vulnerability testing, and ensuring product compliance before release.</div></div>
                                            </div>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">e. Prioritizing security initiatives based on business impact</h4>
                                            <p class="text-gray-600 mb-4">With limited resources, security initiatives must be prioritized based on their potential business impact, leveraging Business Impact Analysis (BIA) and cost-benefit analysis.</p>
                                            <div class="chart-container-b1e mb-6"><canvas id="securityInitiativesChart"></canvas></div>
                                            <div class="flex flex-wrap justify-center gap-4 mb-4">
                                                <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #00A896; color: white;" data-priority-type="complianceDriven">Compliance-Driven</button>
                                                <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #FF6384; color: white;" data-priority-type="revenueDriven">Revenue-Driven</button>
                                            </div>
                                            <div id="priority-explanation" class="text-gray-600 text-sm italic mt-2 text-center">This chart simulates the prioritization of security initiatives. Use the buttons to see how priorities might shift based on different business drivers or strategic focuses.</div>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">2. Frameworks and Standards<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Frameworks provide a structured approach to managing information security. Click on a card to learn more:</p>
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6" data-group="framework">
                                                <div class="concept-card"><span class="card-title">COBIT</span><div class="card-description"><strong>Control Objectives for Information and Related Technologies:</strong> A comprehensive framework for IT governance and management, providing a holistic approach to managing IT risks and ensuring IT alignment with business goals. It helps organizations create optimal value from IT by maintaining a balance between realizing benefits and optimizing risk levels and resource use.</div></div>
                                                <div class="concept-card"><span class="card-title">ISO/IEC 27001</span><div class="card-description"><strong>Information Security Management System (ISMS):</strong> An international standard that specifies requirements for establishing, implementing, maintaining, and continually improving an ISMS within the context of the organization's overall business risks. Certification to ISO 27001 demonstrates a systematic approach to managing sensitive company information.</div></div>
                                                <div class="concept-card"><span class="card-title">NIST CSF</span><div class="card-description"><strong>National Institute of Standards and Technology Cybersecurity Framework:</strong> A voluntary framework providing a common language for understanding, managing, and expressing cybersecurity risk. It consists of five core functions: Identify, Protect, Detect, Respond, Recover, offering a flexible way to manage cybersecurity risk.</div></div>
                                                <div class="concept-card"><span class="card-title">ITIL</span><div class="card-description"><strong>Information Technology Infrastructure Library:</strong> A framework for IT service management that describes processes, procedures, tasks, and checklists that are not organization-specific, used to establish a minimum level of competency. While not solely security-focused, it supports security processes.</div></div>
                                            </div>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Selection and Implementation:</h4>
                                            <p class="text-gray-600 mb-4">Choosing the right framework depends on organizational context, industry, and regulatory landscape. Implementation involves adapting the framework's principles to the specific needs of the enterprise.</p>
                                            <h4 class="text-lg font-semibold text-gray-700">c. Integrating governance frameworks into enterprise governance</h4>
                                            <p class="text-gray-600 mb-4">Security frameworks must be integrated seamlessly into the broader enterprise governance structure through harmonization, consistent language, and a robust top-down/bottom-up communication flow.</p>
                                            <h5 class="text-md font-bold text-gray-800 mb-2">Framework Adoption Journey</h5>
                                            <div class="framework-journey-container" data-group="framework-step">
                                                <div class="framework-step-node"><span class="card-title">1. Define Scope & Objectives</span><div class="card-description">Clearly define the scope of the ISMS (Information Security Management System), identify organizational context, and establish the objectives and policies for information security. This aligns security with business goals.</div></div>
                                                <div class="framework-arrow"></div>
                                                <div class="framework-step-node"><span class="card-title">2. Assess Current State & Gaps</span><div class="card-description">Conduct a comprehensive assessment of the organization's current information security posture, identify existing controls, and pinpoint gaps against the chosen framework's requirements. This includes risk assessment.</div></div>
                                                <div class="framework-arrow"></div>
                                                <div class="framework-step-node"><span class="card-title">3. Design & Plan Controls</span><div class="card-description">Based on the risk assessment and identified gaps, design and plan the implementation of appropriate security controls. This involves selecting controls from the framework's annexes (e.g., ISO 27002) and developing a detailed implementation plan.</div></div>
                                                <div class="framework-arrow"></div>
                                                <div class="framework-step-node"><span class="card-title">4. Implement Controls</span><div class="card-description">Execute the control implementation plan, deploying new security technologies, updating processes, and conducting necessary training. This phase focuses on putting the planned security measures into operation.</div></div>
                                                <div class="framework-arrow"></div>
                                                <div class="framework-step-node"><span class="card-title">5. Monitor, Review & Improve</span><div class="card-description">Continuously monitor the effectiveness of implemented controls, conduct regular reviews and audits, and make necessary adjustments for continuous improvement. This ensures the ISMS remains effective and adapts to changes in the threat landscape or business environment.</div></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">3. Strategic Planning (Budgets, Resources, Business Case)<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Effective strategic planning ensures that information security initiatives are adequately resourced and justified.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Justification and strategic alignment of security investments</h4>
                                            <p class="text-gray-600 mb-4">Strategic planning translates the security strategy into practical implementation, involving careful resource allocation, financial justification, and continuous performance measurement.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Building multi-year information security roadmap</h4>
                                            <p class="text-gray-600 mb-4">A security roadmap outlines the evolution of the security program over time, outlining phases to bridge the gap between the current and desired security states, while remaining flexible to adapt to changes.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Developing a business case for security investments</h4>
                                            <p class="text-gray-600 mb-4">A strong business case is essential for securing funding. It clearly articulates the problem, proposed solution, tangible and intangible benefits, costs, and the associated risks of not investing.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">d. Budgeting, staffing, and resource allocation</h4>
                                            <p class="text-gray-600 mb-4">Strategic planning includes developing annual and multi-year budgets, assessing staffing needs (internal, contractors, MSSPs), and prioritizing resource allocation based on the roadmap and risk priorities. Allocate a hypothetical security budget below:</p>
                                            <div class="p-4 bg-gray-50 rounded-md shadow-sm mb-6">
                                                <h5 class="text-md font-bold text-gray-800 mb-2">Security Budget Allocator</h5>
                                                <label for="totalBudget" class="block text-gray-700 text-sm font-bold mb-1">Overall Budget ($):</label>
                                                <input type="text" id="totalBudget" value="1,000,000" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200 mb-4">
                                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                                                    <div>
                                                        <label for="techToolsPct" class="block text-gray-700 text-sm font-bold mb-1">Technology & Tools (%):</label>
                                                        <input type="number" id="techToolsPct" value="40" min="0" max="100" step="1" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                                    </div>
                                                    <div>
                                                        <label for="personnelStaffingPct" class="block text-gray-700 text-sm font-bold mb-1">Personnel & Staffing (%):</label>
                                                        <input type="number" id="personnelStaffingPct" value="35" min="0" max="100" step="1" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                                    </div>
                                                    <div>
                                                        <label for="trainingAwarenessPct" class="block text-gray-700 text-sm font-bold mb-1">Training & Awareness (%):</label>
                                                        <input type="number" id="trainingAwarenessPct" value="15" min="0" max="100" step="1" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                                    </div>
                                                    <div>
                                                        <label for="complianceAuditPct" class="block text-gray-700 text-sm font-bold mb-1">Compliance & Audit (%):</label>
                                                        <input type="number" id="complianceAuditPct" value="10" min="0" max="100" step="1" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                                    </div>
                                                </div>
                                                <div class="chart-container mb-4"><canvas id="budgetChart"></canvas></div>
                                                <div id="budget-explanation" class="text-gray-600 text-sm italic mt-2 text-center">Adjust the percentages above. The total must equal 100%.</div>
                                            </div>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">e. Defining and monitoring KPIs and KRIs to measure strategic performance</h4>
                                            <p class="text-gray-600 mb-4">To ensure effectiveness, security performance is measured using Key Performance Indicators (KPIs) for current performance and Key Risk Indicators (KRIs) for anticipating future problems. Regular reporting provides insights to management.</p>
                                            <div class="chart-container mb-6"><canvas id="kriTrendChart"></canvas></div>
                                            <div class="flex flex-wrap justify-center gap-4 mb-4">
                                                <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #DC3545; color: white;" data-kri-type="criticalVulnerabilities">Critical Vulnerabilities Detected</button>
                                                <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #FFD700; color: #333333;" data-kri-type="phishingAttempts">Phishing Attempts Reported</button>
                                                <button class="px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" style="background-color: #004085; color: white;" data-kri-type="failedAccess">Failed Access Attempts</button>
                                            </div>
                                            <div id="kri-explanation" class="text-gray-600 text-sm italic mt-2 text-center">This line chart illustrates simulated trends for various Key Risk Indicators (KRIs) over time, helping to anticipate potential issues. Click a button to see its trend.</div>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">f. Continuous improvement through maturity models (e.g., CMMI, PDCA)</h4>
                                            <p class="text-gray-600 mb-4">Information security requires continuous improvement, often guided by maturity models like CMMI and iterative methodologies such as the Plan-Do-Check-Act (PDCA) cycle. Explore common maturity levels:</p>
                                            <div class="flex flex-wrap justify-center items-center gap-4" data-group="maturity-level">
                                                <div class="maturity-level-card"><span class="card-title">Initial</span><div class="card-description">Processes are ad hoc and chaotic; success depends on individual effort. Security is reactive, with no standardized procedures.</div></div>
                                                <span class="maturity-arrow-right">&rarr;</span>
                                                <div class="maturity-level-card"><span class="card-title">Managed</span><div class="card-description">Processes are planned and executed in accordance with policies. Basic security controls are in place, but performance is not yet consistently measured.</div></div>
                                                <span class="maturity-arrow-right">&rarr;</span>
                                                <div class="maturity-level-card"><span class="card-title">Defined</span><div class="card-description">Processes are well-characterized and understood, described in standards, procedures, tools, and methods. Security is integrated into the organization's standard practices, and roles are clear.</div></div>
                                                <span class="maturity-arrow-right">&rarr;</span>
                                                <div class="maturity-level-card"><span class="card-title">Quantitatively Managed</span><div class="card-description">Processes are controlled using statistical and other quantitative techniques. Security performance is measured and controlled, allowing for data-driven decision-making.</div></div>
                                                <span class="maturity-arrow-right">&rarr;</span>
                                                <div class="maturity-level-card"><span class="card-title">Optimizing</span><div class="card-description">Continuous process improvement is enabled by quantitative feedback and innovative new ideas and technologies. Security is a proactive, strategic enabler for the business, constantly adapting to new threats and opportunities.</div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- Key Terms Section -->
                            <section id="key-terms-d1" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Key Terms</h2>
                                <p class="mb-8 text-gray-700">Test your knowledge of key terms in Information Security Governance with these interactive flashcards. Click on a card to reveal its definition.</p>
                                <div id="key-terms-grid-d1" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6" data-group="key-terms-d1">
                                    <div class="key-term-card"><h3 class="card-title">Information Security Governance</h3><div class="card-description"><p>The system by which an organization directs and controls information security activities to achieve its objectives.</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">Risk Appetite</h3><div class="card-description"><p>The amount and type of risk that an organization is willing to take in order to meet its strategic objectives.</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">Organizational Culture</h3><div class="card-description"><p>The shared values, beliefs, attitudes, and behaviors that characterize an organization and influence how information security is perceived and practiced.</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">Due Diligence</h3><div class="card-description"><p>The exercise of reasonable care in the investigation of a matter before entering into an agreement or a transaction.</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">Due Care</h3><div class="card-description"><p>The level of ordinary care that a reasonable and prudent person would exercise under the same or similar circumstances.</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">Information Security Strategy</h3><div class="card-description"><p>A long-term plan that outlines the organization's approach to protecting its information assets, aligned with business objectives and risk appetite.</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">COBIT</h3><div class="card-description"><p>A framework for enterprise IT governance and management, providing a holistic approach to managing IT risks and ensuring IT alignment with business goals.</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">ISO/IEC 27001</h3><div class="card-description"><p>An international standard that provides requirements for establishing, implementing, maintaining, and continually improving an Information Security Management System (ISMS).</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">NIST Cybersecurity Framework (CSF)</h3><div class="card-description"><p>A voluntary framework providing a common language for understanding, managing, and expressing cybersecurity risk, structured around five core functions: Identify, Protect, Detect, Respond, Recover.</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">Key Performance Indicator (KPI)</h3><div class="card-description"><p>A measurable value that demonstrates how effectively a company is achieving key business objectives. In security, it measures the performance of security controls or processes.</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">Key Goal Indicator (KGI)</h3><div class="card-description"><p>A metric that indicates whether a high-level goal is being achieved. In security, it measures the achievement of strategic information security objectives.</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">Business Case</h3><div class="card-description"><p>A documented argument or justification for undertaking a project or initiative, including its financial and non-financial benefits, costs, and risks.</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">Legal & Regulatory Compliance</h3><div class="card-description"><p>Adherence to laws, regulations, and industry standards that govern an organization's information handling and security practices (e.g., GDPR, HIPAA, SOX).</p></div></div>
                                    <div class="key-term-card"><h3 class="card-title">Information Asset</h3><div class="card-description"><p>Any information or information system that has value to the organization, requiring protection (e.g., customer data, intellectual property, critical systems).</p></div></div>
                                </div>
                            </section>

                            <!-- Domain Summary Section -->
                            <section id="domain-summary-d1" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Domain Summary</h2>
                                <div class="p-6 bg-white rounded-lg shadow-md">
                                    <p class="text-gray-700 mb-4">Domain 1: Information Security Governance is the foundational domain of the CISM certification, emphasizing the strategic leadership required to establish and maintain an effective information security program. It underscores that information security is not merely a technical function but a critical business imperative that must be seamlessly integrated into the enterprise's overall governance structure.</p>
                                    <p class="text-gray-700 mb-4">This domain covers the critical aspects of understanding and influencing organizational culture to foster a security-aware environment. It highlights the necessity of identifying and adhering to a complex landscape of legal, regulatory, and contractual requirements, ensuring that the security strategy remains compliant and relevant. A key focus is on defining clear organizational structures, roles, and responsibilities, ensuring accountability from the board level down to individual end-users, and establishing robust reporting mechanisms.</p>
                                    <p class="text-gray-700">Furthermore, Domain 1 delves into the strategic development of information security, emphasizing its alignment with business objectives. It introduces various governance frameworks and standards like COBIT, ISO/IEC 27001, and NIST CSF, which provide structured approaches to managing security. Finally, it addresses the practicalities of strategic planning, including budgeting, resource management, and developing compelling business cases to justify security investments, all while leveraging performance metrics to demonstrate the program's value and support continuous improvement.</p>
                                </div>
                            </section>
                        </main>
                    </div>
        
                    <!-- =============================================================================== -->
                    <!-- == DOMAIN 2: INFORMATION SECURITY RISK MANAGEMENT =============================== -->
                    <!-- =============================================================================== -->
                    <div id="domain-2" class="domain-content-section hidden">
                        <header class="text-center py-8 bg-white rounded-lg shadow-md mb-8">
                            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 mb-2">CISM Domain 2 Study Guide</h1>
                            <p class="text-xl sm:text-2xl text-gray-600">Information Security Risk Management</p>
                            <p class="text-md text-gray-500 mt-2">Your Interactive Study Guide for Proactive Security Protection</p>
                        </header>

                        <nav class="bg-white p-4 rounded-lg shadow-md mb-8 flex justify-center sticky top-0 z-10 overflow-x-auto">
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200 active" data-target="introduction-d2">Introduction</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="risk-assessment-d2">Information Security Risk Assessment</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="risk-response-d2">Information Security Risk Response</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="key-terms-d2">Key Terms</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="domain-summary-d2">Domain Summary</button>
                        </nav>

                        <main id="content-area-d2">
                            <section id="introduction-d2" class="content-section fade-in">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Introduction to CISM Domain 2</h2>
                                <div class="p-6 bg-white rounded-lg shadow-md">
                                    <p class="text-gray-700 mb-4">Welcome to the interactive study guide for CISM Domain 2: Information Security Risk Management. This domain is the cornerstone of effective information security, focusing on how organizations identify, assess, respond to, and monitor risks to their valuable information assets. A strong grasp of these principles is not just theoretical; it's crucial for making informed, business-aligned decisions that proactively protect the enterprise.</p>
                                    <p class="text-gray-700">Throughout this guide, you will explore the dynamic threat landscape, learn how to analyze vulnerabilities, apply various risk assessment methodologies, and understand the critical strategies for responding to risks. We will also delve into the importance of clear risk and control ownership and the continuous process of monitoring and reporting. This interactive format is designed to enhance your learning experience, making complex topics more accessible and engaging.</p>
                                </div>
                            </section>

                            <section id="risk-assessment-d2" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section A: Information Security Risk Assessment</h2>
                                <p class="mb-8 text-gray-700">Information security risk assessment is the systematic process of identifying potential threats and vulnerabilities, analyzing their potential impact, and determining the likelihood of their occurrence. It's about understanding "what could go wrong" and "how bad it could be".</p>

                                <div class="space-y-4">
                                    <!-- Sub-Domain: Emerging Risk and Threat Landscape -->
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                                            1. Emerging Risk and Threat Landscape
                                            <span class="accordion-icon text-2xl">+</span>
                                        </button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">The threat landscape is constantly evolving. As an information security manager, you must be vigilant and proactive in understanding new and evolving dangers.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Understand emerging and evolving threats (e.g., ransomware, insider threats, third-party risks).</h4>
                                            <p class="text-gray-600 mb-4">Explore the common distribution of various emerging threats and how they impact organizations:</p>
                                            <div class="chart-container mb-6">
                                                <canvas id="threatDistributionChart"></canvas>
                                            </div>
                                            <div class="flex flex-wrap justify-center gap-4 mb-4">
                                                <button class="toggle-chart-data btn-ransomware px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="ransomwareFocus">Ransomware</button>
                                                <button class="toggle-chart-data btn-insider-threats px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="insiderFocus">Insider Threats</button>
                                                <button class="toggle-chart-data btn-third-party-risks px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="thirdPartyFocus">Third-Party Risks</button>
                                                <button class="toggle-chart-data btn-phishing px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="phishingFocus">Phishing</button>
                                                <button class="toggle-chart-data btn-ddos px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="ddosFocus">DDoS</button>
                                                <button class="toggle-chart-data btn-apt px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="aptFocus">APT</button>
                                            </div>
                                            <div id="threat-explanation" class="text-gray-600 text-sm italic mt-2 text-center">This chart illustrates a simulated distribution of common emerging threats. Use the buttons to view different focuses.</div>
                                            
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Monitor threat intelligence feeds and industry trend reports.</h4>
                                            <p class="text-gray-600 mb-4">Threat intelligence helps organizations understand the "who, what, where, when, why, and how" of attacks, while industry reports provide broad trends for strategic planning.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Analyze external drivers like regulatory shifts, geopolitical risks, and technological disruption.</h4>
                                            <p class="text-gray-600">New regulations (e.g., updated data privacy laws), global events, and emerging technologies (e.g., AI, IoT) constantly introduce new security challenges and risks that must be analyzed.</p>
                                        </div>
                                    </div>

                                    <!-- Sub-Domain: Vulnerability and Control Deficiency Analysis -->
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                                            2. Vulnerability and Control Deficiency Analysis
                                            <span class="accordion-icon text-2xl">+</span>
                                        </button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Once threats are understood, the next step is to identify where an organization is susceptible to these threats.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Identify and assess weaknesses in IT systems, processes, and controls.</h4>
                                            <p class="text-gray-600 mb-4">This involves using various methods like vulnerability scanning, penetration testing, and security audits to pinpoint weaknesses.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Determine exposure levels due to missing or ineffective controls.</h4>
                                            <p class="text-gray-600 mb-4">A control might exist but be poorly designed or implemented, leading to increased exposure and higher potential impact.</p>

                                            <h4 class="text-lg font-semibold text-gray-700">c. Map vulnerabilities to threats and evaluate potential impacts.</h4>
                                            <p class="text-gray-600 mb-4">Understand which threats could exploit identified vulnerabilities and the potential impact on confidentiality, integrity, availability, and overall business operations. See the example mapping below:</p>
                                            <div class="mb-6 p-4 bg-gray-50 rounded-md shadow-sm">
                                                <h6 class="text-md font-semibold text-gray-700 mb-2 text-center">Sample Vulnerability-Threat-Impact Mapping</h6>
                                                <div class="grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-5 gap-4 mt-4">
                                                    <!-- Scenario 1: Unpatched Web Server -->
                                                    <div class="flow-scenario" data-scenario-id="0">
                                                        <div class="flow-node vulnerability-node" data-node-type="vulnerability">
                                                            <span class="node-title">Unpatched Web Server</span>
                                                            <div class="node-description hidden">Servers with outdated software or missing security patches are prime targets for attackers looking to exploit known weaknesses.</div>
                                                        </div>
                                                        <div class="flow-arrow hidden" data-arrow-id="0-1"></div>
                                                        <div class="flow-node threat-node hidden" data-node-type="threat">
                                                            <span class="node-title">Remote Code Execution (RCE)</span>
                                                            <div class="node-description hidden">RCE allows an attacker to execute arbitrary code on a remote system, gaining full control. This is often achieved through exploiting software vulnerabilities.</div>
                                                        </div>
                                                        <div class="flow-arrow hidden" data-arrow-id="1-2"></div>
                                                        <div class="flow-node impact-node hidden" data-node-type="impact">
                                                            <span class="node-title">Data Breach, System Compromise</span>
                                                            <div class="node-description hidden">Confidentiality, Integrity, Availability impact.</div>
                                                        </div>
                                                    </div>
                                                    <!-- Scenario 2: Weak Employee Password Policy -->
                                                    <div class="flow-scenario" data-scenario-id="1">
                                                        <div class="flow-node vulnerability-node" data-node-type="vulnerability">
                                                            <span class="node-title">Weak Employee Password Policy</span>
                                                            <div class="node-description hidden">Policies allowing simple, common, or reused passwords make accounts easy targets for automated guessing attacks.</div>
                                                        </div>
                                                        <div class="flow-arrow hidden" data-arrow-id="0-1"></div>
                                                        <div class="flow-node threat-node hidden" data-node-type="threat">
                                                            <span class="node-title">Brute-force/Credential Stuffing</span>
                                                            <div class="node-description hidden">Brute-force attacks try many passwords until one works. Credential stuffing uses stolen username/password pairs from other breaches to try and log into new systems.</div>
                                                        </div>
                                                        <div class="flow-arrow hidden" data-arrow-id="1-2"></div>
                                                        <div class="flow-node impact-node hidden" data-node-type="impact">
                                                            <span class="node-title">Unauthorized Access</span>
                                                            <div class="node-description hidden">Confidentiality, Integrity impact.</div>
                                                        </div>
                                                    </div>
                                                    <!-- Scenario 3: Lack of Data Encryption at Rest -->
                                                    <div class="flow-scenario" data-scenario-id="2">
                                                        <div class="flow-node vulnerability-node" data-node-type="vulnerability">
                                                            <span class="node-title">Lack of Data Encryption at Rest</span>
                                                            <div class="node-description hidden">Storing sensitive data on devices (laptops, servers, backups) without encryption means the data is readable if the device is lost or stolen.</div>
                                                        </div>
                                                        <div class="flow-arrow hidden" data-arrow-id="0-1"></div>
                                                        <div class="flow-node threat-node hidden" data-node-type="threat">
                                                            <span class="node-title">Physical Theft of Storage Device</span>
                                                            <div class="node-description hidden">An attacker physically gains possession of a storage device containing unencrypted sensitive data.</div>
                                                        </div>
                                                        <div class="flow-arrow hidden" data-arrow-id="1-2"></div>
                                                        <div class="flow-node impact-node hidden" data-node-type="impact">
                                                            <span class="node-title">Data Exposure</span>
                                                            <div class="node-description hidden">Confidentiality impact.</div>
                                                        </div>
                                                    </div>
                                                    <!-- Scenario 4: Single Point of Failure in Network -->
                                                    <div class="flow-scenario" data-scenario-id="3">
                                                        <div class="flow-node vulnerability-node" data-node-type="vulnerability">
                                                            <span class="node-title">Single Point of Failure</span>
                                                            <div class="node-description hidden">A critical component (e.g., a single router, server, or internet link) whose failure would bring down an entire system or service.</div>
                                                        </div>
                                                        <div class="flow-arrow hidden" data-arrow-id="0-1"></div>
                                                        <div class="flow-node threat-node hidden" data-node-type="threat">
                                                            <span class="node-title">Hardware Failure / DDoS</span>
                                                            <div class="node-description hidden">Hardware failure is an accidental event. A DDoS attack is a malicious attempt to disrupt normal traffic of a targeted server, service or network by overwhelming the target or its surrounding infrastructure with a flood of Internet traffic.</div>
                                                        </div>
                                                        <div class="flow-arrow hidden" data-arrow-id="1-2"></div>
                                                        <div class="flow-node impact-node hidden" data-node-type="impact">
                                                            <span class="node-title">Service Outage, Business Disruption</span>
                                                            <div class="node-description hidden">Availability impact.</div>
                                                        </div>
                                                    </div>
                                                    <!-- Scenario 5: Insufficient Security Awareness Training -->
                                                    <div class="flow-scenario" data-scenario-id="4">
                                                        <div class="flow-node vulnerability-node" data-node-type="vulnerability">
                                                            <span class="node-title">Insufficient Awareness Training</span>
                                                            <div class="node-description hidden">Employees who are not regularly trained on common attack vectors are more susceptible to falling for scams.</div>
                                                        </div>
                                                        <div class="flow-arrow hidden" data-arrow-id="0-1"></div>
                                                        <div class="flow-node threat-node hidden" data-node-type="threat">
                                                            <span class="node-title">Phishing / Social Engineering</span>
                                                            <div class="node-description hidden">Phishing uses deceptive emails or messages. Social engineering manipulates people into performing actions or divulging confidential information.</div>
                                                        </div>
                                                        <div class="flow-arrow hidden" data-arrow-id="1-2"></div>
                                                        <div class="flow-node impact-node hidden" data-node-type="impact">
                                                            <span class="node-title">Credential Theft, Malware, Financial Fraud</span>
                                                            <div class="node-description hidden">Confidentiality, Integrity, Financial impact.</div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p class="text-gray-600 text-sm italic mt-2 text-center">Click on a card to see the potential impact of the vulnerability and threat combination.</p>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Sub-Domain: Risk Assessment and Analysis -->
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                                            3. Risk Assessment and Analysis
                                            <span class="accordion-icon text-2xl">+</span>
                                        </button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">This is where the identified threats, vulnerabilities, and impacts are formally analyzed to quantify or qualify the risk.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Apply qualitative, quantitative, and hybrid risk assessment methods.</h4>
                                            <p class="text-gray-600 mb-4">Explore the characteristics of different risk assessment methods:</p>
                                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6" data-group="risk-method">
                                                <div class="risk-method-card qualitative" data-method="qualitative">
                                                    <span class="card-title">Qualitative</span>
                                                    <div class="card-description hidden">Uses descriptive terms (e.g., high, medium, low) for likelihood and impact. It's subjective but quick and often used for initial assessments or when precise data is unavailable. Good for prioritization.</div>
                                                </div>
                                                <div class="risk-method-card quantitative" data-method="quantitative">
                                                    <span class="card-title">Quantitative</span>
                                                    <div class="card-description hidden">Assigns numerical values (e.g., monetary cost, probability percentages) to likelihood and impact. It aims to provide a more objective and measurable view of risk. Useful for cost-benefit analysis (e.g., SLE, ARO, ALE).</div>
                                                </div>
                                                <div class="risk-method-card hybrid" data-method="hybrid">
                                                    <span class="card-title">Hybrid</span>
                                                    <div class="card-description hidden">Combines elements of both qualitative and quantitative approaches. Often, qualitative assessments are used to identify and prioritize risks, and then quantitative analysis is applied to the most critical risks for detailed analysis.</div>
                                                </div>
                                            </div>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Determine inherent and residual risk.</h4>
                                            <p class="text-gray-600 mb-4"><strong>Inherent risk</strong> is the raw risk before controls. <strong>Residual risk</strong> is what remains after controls are applied.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Use standardized risk frameworks (e.g., ISO/IEC 27005, NIST SP 800-30, FAIR, OCTAVE).</h4>
                                            <p class="text-gray-600 mb-4">These frameworks provide structure and consistency for risk management processes. Click on a card to learn more:</p>
                                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6" data-group="risk-framework">
                                                <div class="risk-framework-card" data-framework="iso27005">
                                                    <span class="card-title">ISO/IEC 27005</span>
                                                    <div class="card-description hidden">Provides guidelines for information security risk management. It supports the general concepts specified in ISO/IEC 27001 (for ISMS) and is designed to assist the satisfactory implementation of information security based on a risk management approach."</div>
                                                </div>
                                                <div class="risk-framework-card" data-framework="nist80030">
                                                    <span class="card-title">NIST SP 800-30</span>
                                                    <div class="card-description hidden">A guide for conducting risk assessments, developed by the National Institute of Standards and Technology (NIST). It provides a systematic approach to identifying, analyzing, and mitigating risks to information systems and organizations."</div>
                                                </div>
                                                <div class="risk-framework-card" data-framework="fair">
                                                    <span class="card-title">FAIR</span>
                                                    <div class="card-description hidden">A quantitative risk analysis model that focuses on understanding and measuring information risk in financial terms. It helps break down complex risk scenarios into measurable components, enabling more objective risk comparisons and cost-benefit analyses."</div>
                                                </div>
                                                <div class="risk-framework-card" data-framework="octave">
                                                    <span class="card-title">OCTAVE</span>
                                                    <div class="card-description hidden">A suite of methods that help organizations assess and manage information security risks. It emphasizes a self-directed approach where organizations identify and prioritize risks based on their own operational risk environment, involving key stakeholders from across the organization."</div>
                                                </div>
                                            </div>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">d. Evaluate risks based on likelihood and business impact.</h4>
                                            <p class="text-gray-600 mb-4">Plotting likelihood against impact helps prioritize risks and align with the organization's risk appetite and tolerance.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">e. Practical Risk Calculations</h4>
                                            <p class="text-gray-600 mb-4">Understanding how to quantify risk is crucial for making informed decisions and justifying security investments.</p>

                                            <div class="mb-6 p-4 bg-gray-50 rounded-md shadow-sm">
                                                <h5 class="text-md font-bold text-gray-800 mb-2">Qualitative Risk Example (Risk Register Entry & Matrix)</h5>
                                                <p class="text-gray-700 mb-2">Consider a "High" risk of a "Phishing Attack leading to Credential Theft" with a "Medium" likelihood and "High" impact. This would be documented in a risk register and can be visualized on a matrix:</p>
                                                <ul class="list-disc list-inside text-gray-600 ml-4 mb-4">
                                                    <li><strong>Risk ID:</strong> R-001</li>
                                                    <li><strong>Risk Description:</strong> Phishing attack leading to credential theft.</li>
                                                    <li><strong>Inherent Risk:</strong> High</li>
                                                    <li><strong>Likelihood:</strong> Medium</li>
                                                    <li><strong>Impact:</strong> High (e.g., data breach, financial loss)</li>
                                                    <li><strong>Proposed Response:</strong> Mitigate (e.g., advanced email filtering, user training)</li>
                                                    <li><strong>Residual Risk:</strong> Medium (after controls)</li>
                                                </ul>

                                                <h6 class="text-md font-semibold text-gray-700 mb-2 text-center">Example Risk Matrix (Likelihood vs. Impact)</h6>
                                                <table class="risk-matrix-table">
                                                    <thead>
                                                        <tr>
                                                            <th>Likelihood \ Impact</th>
                                                            <th>Low</th>
                                                            <th>Medium</th>
                                                            <th>High</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>High</td>
                                                            <td class="medium">Medium</td>
                                                            <td class="high">High</td>
                                                            <td class="critical">Critical</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Medium</td>
                                                            <td class="low">Low</td>
                                                            <td class="medium">Medium</td>
                                                            <td class="high">High</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Low</td>
                                                            <td class="low">Low</td>
                                                            <td class="low">Low</td>
                                                            <td class="medium">Medium</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <p class="text-gray-600 text-sm italic mt-2 text-center">In this matrix, our example risk (Medium Likelihood, High Impact) falls into the "High" category.</p>
                                            </div>

                                            <div class="mb-6 p-4 bg-gray-50 rounded-md shadow-sm">
                                                <h5 class="text-md font-bold text-gray-800 mb-2">Quantitative Risk Calculation (ALE)</h5>
                                                <p class="text-gray-700 mb-2">Calculate the Annualized Loss Expectancy (ALE) for a given asset:</p>
                                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                                                    <div>
                                                        <label for="assetValue" class="block text-gray-700 text-sm font-bold mb-1">Asset Value (AV) ($):</label>
                                                        <input type="text" id="assetValue" value="100,000" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                                    </div>
                                                    <div>
                                                        <label for="exposureFactor" class="block text-gray-700 text-sm font-bold mb-1">Exposure Factor (EF) (% loss):</label>
                                                        <input type="number" id="exposureFactor" value="0.75" min="0" max="1" step="0.01" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                                    </div>
                                                </div>
                                                <p class="text-gray-700 mb-2"><strong>Single Loss Expectancy (SLE):</strong> $AV \times EF$</p>
                                                <p class="text-lg font-semibold text-gray-800 mb-4">SLE: $<span id="sleResult"></span></p>

                                                <label for="aro" class="block text-gray-700 text-sm font-bold mb-1">Annualized Rate of Occurrence (ARO) (times/year):</label>
                                                <input type="number" id="aro" value="0.5" min="0" step="0.1" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200 mb-4">

                                                <p class="text-gray-700 mb-2"><strong>Annualized Loss Expectancy (ALE):</strong> $SLE \times ARO$</p>
                                                <p class="text-lg font-semibold text-gray-800">ALE: $<span id="aleResult"></span></p>
                                                <p class="text-gray-600 text-sm italic mt-2">Adjust the values above to see how SLE and ALE change. ARO of 0.5 means the event is expected to occur once every two years.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section id="risk-response-d2" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section B: Information Security Risk Response</h2>
                                <p class="mb-8 text-gray-700">Once risks have been assessed and analyzed, the next critical phase is to determine how to address them. This involves selecting and implementing appropriate risk treatment strategies.</p>
                                <div class="space-y-4">
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                                            1. Risk Treatment / Risk Response Options
                                            <span class="accordion-icon text-2xl">+</span>
                                        </button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">There are generally four primary strategies for responding to identified risks.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Develop and apply appropriate response strategies:</h4>
                                            <p class="text-gray-600 mb-4">Click on a card to learn about each strategy:</p>
                                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6" data-group="risk-response">
                                                <div class="risk-response-card mitigate" data-response="mitigate">
                                                    <span class="card-title">Mitigate</span>
                                                    <div class="card-description hidden">Reduce the likelihood or impact of a risk through the implementation of security controls (e.g., firewalls, encryption, security awareness training). This is the most common response.</div>
                                                </div>
                                                <div class="risk-response-card transfer" data-response="transfer">
                                                    <span class="card-title">Transfer</span>
                                                    <div class="card-description hidden">Shift the financial or operational burden of a risk to a third party (e.g., purchasing cyber insurance, outsourcing to a vendor with strong security clauses).</div>
                                                </div>
                                                <div class="risk-response-card avoid" data-response="avoid">
                                                    <span class="card-title">Avoid</span>
                                                    <div class="card-description hidden">Eliminate the risk entirely by choosing not to engage in or ceasing an activity that gives rise to the risk (e.g., deciding not to store sensitive customer data, discontinuing an insecure legacy application).</div>
                                                </div>
                                                <div class="risk-response-card accept" data-response="accept">
                                                    <span class="card-title">Accept</span>
                                                    <div class="card-description hidden">Acknowledge the existence of a risk and decide to take no further action to mitigate it, usually because the cost of mitigation outweighs the potential impact, or the risk is below the organization's risk tolerance. Requires formal management approval.</div>
                                                </div>
                                            </div>
                                            
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Ensure treatment aligns with legal, regulatory, and business constraints.</h4>
                                            <p class="text-gray-600 mb-4">Risk treatment decisions must comply with all applicable laws and regulations and support overall business objectives.</p>

                                            <h4 class="text-lg font-semibold text-gray-700">c. Select controls using frameworks like ISO/IEC 27002 and NIST CSF.</h4>
                                            <p class="text-gray-600">These frameworks provide a comprehensive set of generic information security controls and best practices for implementation.</p>
                                        </div>
                                    </div>

                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                                            2. Risk and Control Ownership
                                            <span class="accordion-icon text-2xl">+</span>
                                        </button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Clear accountability is essential for effective risk management.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Assign risk ownership to appropriate stakeholders (e.g., data owners, business units).</h4>
                                            <p class="text-gray-600 mb-4">Risks belong to the business functions that generate or are most impacted by them, not solely to the security department.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Establish accountability for control implementation and operation.</h4>
                                            <p class="text-gray-600 mb-4">Individuals or teams responsible for the implementation and maintenance of specific security controls must be clearly defined.</p>

                                            <h4 class="text-lg font-semibold text-gray-700">c. Define responsibilities in risk treatment plans and governance documentation.</h4>
                                            <p class="text-gray-600 mb-4">Formal documentation like risk treatment plans and governance policies ensure that risk management is embedded into the organizational culture. Explore typical roles and their ownership responsibilities in the hierarchy below:</p>
                                            <div class="mb-6 p-4 bg-gray-50 rounded-md shadow-sm">
                                                <h6 class="text-md font-semibold text-gray-700 mb-4 text-center">Corporate Hierarchy: Risk and Control Ownership</h6>
                                                <div class="hierarchy-chart-container" data-group="role-hierarchy">
                                                    <div class="role-node board" data-role="board">
                                                        <span class="role-title">Board/Executive Management</span>
                                                        <div class="role-description hidden"></div>
                                                    </div>
                                                    <div class="hierarchy-line"></div>
                                                    <div class="role-node ciso" data-role="ciso">
                                                        <span class="role-title">CISO / Information Security Manager</span>
                                                        <div class="role-description hidden"></div>
                                                    </div>
                                                    <div class="hierarchy-line"></div>
                                                    <div class="flex justify-center gap-8 w-full">
                                                        <div class="role-node data-owners" data-role="dataOwners">
                                                            <span class="role-title">Data Owners / Business Unit Heads</span>
                                                            <div class="role-description hidden"></div>
                                                        </div>
                                                        <div class="role-node it-ops" data-role="itOps">
                                                            <span class="role-title">IT Operations / Security Teams</span>
                                                            <div class="role-description hidden"></div>
                                                        </div>
                                                    </div>
                                                    <div class="hierarchy-line"></div>
                                                    <div class="role-node end-users" data-role="endUsers">
                                                        <span class="role-title">End Users</span>
                                                        <div class="role-description hidden"></div>
                                                    </div>
                                                </div>
                                                <p class="text-gray-600 text-sm italic mt-2 text-center">Click on a role in the hierarchy above to see a detailed description of their responsibilities.</p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                                            3. Risk Monitoring and Reporting
                                            <span class="accordion-icon text-2xl">+</span>
                                        </button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Risk management is not a one-time event; it's a continuous process that requires ongoing monitoring and communication.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Monitor key risk indicators (KRIs), control effectiveness, and residual risk levels.</h4>
                                            <p class="text-gray-600 mb-4">Continuously track metrics that provide early warning signals of increasing risk exposure and assess the ongoing effectiveness of security controls.</p>
                                            <div class="chart-container mb-6">
                                                <canvas id="riskMonitoringKRIChart"></canvas>
                                            </div>
                                            <div class="mb-4">
                                                <label for="riskMonitoringKRISelect" class="block text-gray-700 text-sm font-bold mb-2">Select KRI to view trend:</label>
                                                <select id="riskMonitoringKRISelect" class="block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-200">
                                                    <option value="unpatchedSystems">Unpatched Critical Systems</option>
                                                    <option value="securityIncidents">Security Incidents Trend</option>
                                                    <option value="thirdPartyBreaches">Third-Party Breach Incidents</option>
                                                </select>
                                            </div>
                                            <p class="text-gray-600 text-sm italic">This line chart illustrates simulated trends for various Key Risk Indicators (KRIs) related to risk monitoring. Select an KRI from the dropdown to see its trend.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Maintain and update the risk register.</h4>
                                            <p class="text-gray-600 mb-4">The risk register is a living document that tracks all identified risks, their status, and assigned ownership.</p>
                                            
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Report risk trends and posture to leadership and boards using dashboards, scorecards, and executive summaries.</h4>
                                            <p class="text-gray-600 mb-4">Tailor reports to the audience, providing high-level, strategic overviews for leadership to support informed decision-making. Below is a sample risk posture scorecard:</p>
                                            <div class="mb-6 p-4 bg-gray-50 rounded-md shadow-sm">
                                                <h6 class="text-md font-semibold text-gray-700 mb-2 text-center">Sample Quarterly Risk Posture Scorecard</h6>
                                                <table class="risk-scorecard-table">
                                                    <thead>
                                                        <tr>
                                                            <th>Risk Area</th>
                                                            <th>Current Level</th>
                                                            <th>Trend</th>
                                                            <th>Last Review</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>Cyber Attack Surface</td>
                                                            <td class="risk-level-medium">Medium</td>
                                                            <td class="trend-stable">Stable</td>
                                                            <td>Q2 2024</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Data Privacy Compliance</td>
                                                            <td class="risk-level-low">Low</td>
                                                            <td class="trend-down">Improving</td>
                                                            <td>Q2 2024</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Third-Party Vendor Risk</td>
                                                            <td class="risk-level-high">High</td>
                                                            <td class="trend-up">Worsening</td>
                                                            <td>Q2 2024</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Insider Threat</td>
                                                            <td class="risk-level-medium">Medium</td>
                                                            <td class="trend-stable">Stable</td>
                                                            <td>Q2 2024</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Operational Resilience</td>
                                                            <td class="risk-level-low">Low</td>
                                                            <td class="trend-down">Improving</td>
                                                            <td>Q2 2024</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <p class="text-gray-600 text-sm italic mt-2 text-center">This scorecard provides a high-level summary of key risk areas, their current status, and trend, ideal for executive reporting.</p>
                                            </div>
                                            
                                            <h4 class="text-lg font-semibold text-gray-700">d. Support continuous improvement in risk response and awareness.</h4>
                                            <p class="text-gray-600">Establish feedback loops and ongoing security awareness programs to continuously enhance the organization's risk posture.</p>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section id="key-terms-d2" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Key Terms</h2>
                                <p class="mb-8 text-gray-700">Test your knowledge of key terms in Information Security Risk Management with these interactive flashcards. Click on a card to reveal its definition.</p>
                                <div id="key-terms-grid-d2" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6" data-group="key-terms-d2">
                                    <!-- Key terms will be populated by JS -->
                                </div>
                            </section>

                            <section id="domain-summary-d2" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Domain Summary</h2>
                                <div class="p-6 bg-white rounded-lg shadow-md">
                                    <p class="text-gray-700 mb-4">Domain 2: Information Security Risk Management is a critical component of the CISM framework, focusing on the systematic identification, assessment, response, and monitoring of risks to an organization's information assets. It emphasizes a proactive approach to understanding the evolving threat landscape, including emerging threats like ransomware, insider threats, and third-party risks, and analyzing their potential impact.</p>
                                    <p class="text-gray-700 mb-4">The domain covers various risk assessment methodologies, including qualitative, quantitative, and hybrid approaches, and the use of standardized frameworks such as ISO/IEC 27005, NIST SP 800-30, FAIR, and OCTAVE. It highlights the importance of distinguishing between inherent and residual risk and evaluating risks based on their likelihood and business impact. Furthermore, Domain 2 delves into risk response strategiesâ€”mitigating with controls, transferring through contracts or insurance, avoiding risky activities, or accepting risks with management approvalâ€”ensuring these align with legal, regulatory, and business constraints.</p>
                                    <p class="text-gray-700">Crucially, this domain stresses the assignment of clear risk and control ownership to appropriate stakeholders, establishing accountability for implementation and operation. Finally, it covers the continuous process of risk monitoring and reporting, including maintaining risk registers, tracking Key Risk Indicators (KRIs), and communicating risk posture to leadership through dashboards and executive summaries, all aimed at supporting continuous improvement in the organization's security posture.</p>
                                </div>
                            </section>
                        </main>
                    </div>

                    <!-- =============================================================================== -->
                    <!-- == DOMAIN 3: PROGRAM DEVELOPMENT & MANAGEMENT ================================= -->
                    <!-- =============================================================================== -->
                    <div id="domain-3" class="domain-content-section hidden">
                        <header class="text-center py-8 bg-white rounded-lg shadow-md mb-8">
                            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 mb-2">CISM Domain 3 Study Guide</h1>
                            <p class="text-xl sm:text-2xl text-gray-600">Information Security Program Development and Management</p>
                            <p class="text-md text-gray-500 mt-2">Building and maintaining the engine of your security strategy.</p>
                        </header>

                        <nav class="bg-white p-4 rounded-lg shadow-md mb-8 flex justify-center sticky top-0 z-10 overflow-x-auto">
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200 active" data-target="introduction-d3">Introduction</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="program-development-d3">Program Development</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="program-management-d3">Program Management</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="key-terms-d3">Key Terms</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="domain-summary-d3">Domain Summary</button>
                        </nav>

                        <main>
                            <section id="introduction-d3" class="content-section fade-in">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Introduction to CISM Domain 3</h2>
                                <div class="p-6 bg-white rounded-lg shadow-md">
                                    <p class="text-gray-700 mb-4">Welcome to Domain 3. This domain translates the high-level strategy and governance from Domain 1 and the risk management principles from Domain 2 into a tangible, functioning Information Security Program. It's about building the security architecture, policies, controls, and capabilities needed to protect the organization's information assets.</p>
                                    <p class="text-gray-700">Here, you will learn how to develop a security program that is aligned with business objectives, manage its resources effectively, and ensure it operates efficiently. This includes everything from defining security architecture and creating policies to managing security technologies and measuring program performance. This domain is the operational heart of the CISM's responsibilities.</p>
                                </div>
                            </section>

                            <section id="program-development-d3" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section A: Information Security Program Development</h2>
                                <div class="space-y-4">
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">1. Information Security Program Resources (People, Tools, Technologies)<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Building an information security program requires the right blend of human capital, effective tools, and appropriate technologies. Proper resource allocation ensures the program has the necessary support to achieve its objectives.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Identify and allocate internal/external staff, tools, and technologies.</h4>
                                            <p class="text-gray-600 mb-4">Effective resource planning is crucial. This involves assessing current capabilities and identifying where additional people, tools, or technologies are needed, aligning them with the program's scope and budget. Below is a simulation of budget allocation:</p>

                                            <div class="p-4 bg-gray-50 rounded-md shadow-sm mb-6">
                                                <h5 class="text-md font-bold text-gray-800 mb-2 text-center">Simulated Security Budget Allocation</h5>
                                                <div class="mb-4">
                                                    <label for="totalBudgetD3" class="block text-gray-700 text-sm font-bold mb-1">Total Annual Budget ($):</label>
                                                    <input type="text" id="totalBudgetD3" value="1,000,000" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                                </div>
                                                <p class="text-sm text-gray-600 mb-2">Allocate Percentages (Sum to 100%):</p>
                                                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                                                    <div>
                                                        <label for="peoplePct" class="block text-gray-700 text-sm font-bold mb-1">People (%):</label>
                                                        <input type="number" id="peoplePct" value="40" min="0" max="100" step="1" class="budget-pct-input w-full p-2 border border-gray-300 rounded-md">
                                                        <div id="peopleValue" class="text-sm text-gray-500 mt-1">$400,000</div>
                                                    </div>
                                                    <div>
                                                        <label for="toolsPct" class="block text-gray-700 text-sm font-bold mb-1">Tools & Software (%):</label>
                                                        <input type="number" id="toolsPct" value="30" min="0" max="100" step="1" class="budget-pct-input w-full p-2 border border-gray-300 rounded-md">
                                                        <div id="toolsValue" class="text-sm text-gray-500 mt-1">$300,000</div>
                                                    </div>
                                                    <div>
                                                        <label for="trainingPct" class="block text-gray-700 text-sm font-bold mb-1">Training & Awareness (%):</label>
                                                        <input type="number" id="trainingPct" value="15" min="0" max="100" step="1" class="budget-pct-input w-full p-2 border border-gray-300 rounded-md">
                                                        <div id="trainingValue" class="text-sm text-gray-500 mt-1">$150,000</div>
                                                    </div>
                                                    <div>
                                                        <label for="compliancePct" class="block text-gray-700 text-sm font-bold mb-1">Compliance & Audit (%):</label>
                                                        <input type="number" id="compliancePct" value="15" min="0" max="100" step="1" class="budget-pct-input w-full p-2 border border-gray-300 rounded-md">
                                                        <div id="complianceValue" class="text-sm text-gray-500 mt-1">$150,000</div>
                                                    </div>
                                                </div>
                                                <div id="allocation-feedback" class="text-center font-bold mb-4"></div>
                                                <div class="chart-container mb-4" style="height: 300px;"><canvas id="d3BudgetChart"></canvas></div>
                                                <p class="text-gray-600 text-sm italic text-center">Adjust the percentages and total budget to see the allocation changes.</p>
                                            </div>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Align resources with organizational structure and program scope.</h4>
                                            <p class="text-gray-600 mb-4">Security resources must be strategically positioned within the organization to maximize their effectiveness. This means understanding reporting lines, collaboration points, and the overall scope of the security program relative to business operations.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Ensure roles and responsibilities are defined and supported.</h4>
                                            <p class="text-gray-600">Clear roles, documented responsibilities, and management support are vital. This ensures accountability and empowers security personnel to carry out their duties effectively, fostering a security-conscious culture.</p>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">2. Information Asset Identification and Classification<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">You can't protect what you don't know you have. Identifying and classifying information assets is the foundational step in determining appropriate security controls.</p>
                                            
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Maintain an accurate inventory of data, systems, and infrastructure.</h4>
                                            <p class="text-gray-600 mb-4">A comprehensive and up-to-date inventory is essential. This includes all forms of data (at rest, in transit, in processing), hardware, software, and network components, ensuring all critical assets are accounted for.</p>
                                            
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Apply classification based on business impact (e.g., confidentiality, criticality).</h4>
                                            <p class="text-gray-600 mb-4">Information classification categorizes data based on its sensitivity, value, and the impact its compromise would have on the business (e.g., financial, reputational, legal). This drives control selection. See an example classification table below:</p>
                                            
                                            <div class="overflow-x-auto">
                                                <h5 class="text-md font-bold text-gray-800 mb-2 text-center">Sample Information Classification and Business Impact</h5>
                                                <table class="styled-table w-full my-4">
                                                    <thead>
                                                        <tr>
                                                            <th>Classification Level</th>
                                                            <th>Confidentiality Impact</th>
                                                            <th>Integrity Impact</th>
                                                            <th>Availability Impact</th>
                                                            <th>Handling Guidelines (Examples)</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td class="font-bold text-gray-600">Public</td>
                                                            <td>Low (No significant harm)</td>
                                                            <td>Low</td>
                                                            <td>Low</td>
                                                            <td>Publicly shareable, no access restrictions.</td>
                                                        </tr>
                                                        <tr>
                                                            <td class="font-bold text-blue-600">Internal Use</td>
                                                            <td>Moderate (Minor business disruption)</td>
                                                            <td>Moderate</td>
                                                            <td>Moderate</td>
                                                            <td>Share within organization, restricted external sharing.</td>
                                                        </tr>
                                                        <tr>
                                                            <td class="font-bold text-yellow-600">Confidential</td>
                                                            <td>High (Significant business disruption, legal/financial impact)</td>
                                                            <td>High</td>
                                                            <td>High</td>
                                                            <td>Restricted access to authorized personnel, encryption, strict audit trails.</td>
                                                        </tr>
                                                        <tr>
                                                            <td class="font-bold text-red-600">Restricted / Sensitive</td>
                                                            <td>Severe (Critical business impact, severe legal/financial penalties)</td>
                                                            <td>Severe</td>
                                                            <td>Severe</td>
                                                            <td>Highly restricted, need-to-know, strong encryption, multi-factor authentication, secure environments.</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <p class="text-gray-600 text-sm italic text-center mt-2">Classification dictates the level of protection an asset requires.</p>

                                            <h4 class="text-lg font-semibold text-gray-700 mb-3 mt-6">c. Assign data ownership and handling guidelines.</h4>
                                            <p class="text-gray-600">Assigning clear data ownership ensures accountability for protecting specific datasets. Data owners, typically business managers, define access rights and approve handling procedures, ensuring data is used and protected according to its classification.</p>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">3. Industry Standards and Frameworks for Information Security<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                             <p class="text-gray-700 mb-4">Leveraging established frameworks provides a structured, recognized approach to designing and managing an Information Security program. They offer best practices and help ensure compliance and effectiveness.</p>
                                             <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Use frameworks such as ISO/IEC 27001, NIST CSF, COBIT, TOGAF, and SABSA.</h4>
                                             <p class="text-gray-600 mb-4">Each framework serves a distinct purpose, offering guidance for different aspects of information security management and governance. Click on a card to learn more about its primary use case:</p>
                                             <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-6" data-group="framework-d3-detailed">
                                                <div class="concept-card"><span class="card-title">ISO/IEC 27001</span><div class="card-description">A family of standards that helps organizations keep information assets secure. ISO/IEC 27001 is the best-known standard providing requirements for an ISMS.</div></div>
                                                <div class="concept-card"><span class="card-title">NIST CSF</span><div class="card-description">Provides a policy framework of computer security guidance for how private sector organizations can assess and improve their ability to prevent, detect, and respond to cyber attacks.</div></div>
                                                <div class="concept-card"><span class="card-title">COBIT</span><div class="card-description">A comprehensive framework for the governance and management of enterprise IT that supports enterprise goal achievement.</div></div>
                                                <div class="concept-card"><span class="card-title">TOGAF</span><div class="card-description">The Open Group Architecture Framework. A framework for enterprise architecture that provides a comprehensive approach for designing, planning, implementing, and governing an enterprise information architecture.</div></div>
                                                <div class="concept-card"><span class="card-title">SABSA</span><div class="card-description">A framework for developing a risk-driven enterprise information security architecture and for delivering security infrastructure solutions.</div></div>
                                            </div>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Align program practices with regulatory, business, and technical standards.</h4>
                                            <p class="text-gray-600 mb-4">A well-designed security program integrates legal mandates, industry best practices, and internal business requirements. This ensures compliance, relevance, and operational efficiency.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Map frameworks to enterprise and security objectives.</h4>
                                            <p class="text-gray-600">The chosen frameworks should not be implemented in isolation but explicitly mapped to the organization's strategic goals and security objectives. This demonstrates the business value of security initiatives.</p>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">4. Information Security Policies, Procedures, and Guidelines<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">These documents form the backbone of the security program, translating strategic objectives into actionable requirements for the entire organization.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Establish version control and review cycles.</h4>
                                            <p class="text-gray-600 mb-4">Security documentation is dynamic. Implementing version control ensures consistency and auditability, while regular review cycles (e.g., annually, or after significant changes) keep them current and effective. See the continuous policy review cycle below:</p>
                                            <div class="framework-journey-container my-6" data-group="policy-review-cycle">
                                                <div class="framework-step-node" style="background-color: #cce7ff;"><span class="card-title">Develop/Update Policy</span><div class="card-description">Draft a new policy or revise an existing one based on new risks, technologies, or business requirements.</div></div>
                                                <div class="framework-arrow"></div>
                                                <div class="framework-step-node" style="background-color: #d4edda;"><span class="card-title">Review & Approve</span><div class="card-description">Circulate the draft policy among key stakeholders (e.g., legal, HR, IT) and obtain formal approval from management.</div></div>
                                                <div class="framework-arrow"></div>
                                                <div class="framework-step-node" style="background-color: #fff3cd;"><span class="card-title">Communicate & Implement</span><div class="card-description">Disseminate the final policy to all relevant personnel and integrate it into operational procedures and training programs.</div></div>
                                                <div class="framework-arrow"></div>
                                                <div class="framework-step-node" style="background-color: #e2d9f3;"><span class="card-title">Monitor & Enforce</span><div class="card-description">Use technical and administrative controls to monitor compliance with the policy and apply consistent enforcement actions for non-compliance.</div></div>
                                                <div class="framework-arrow"></div>
                                                <div class="framework-step-node" style="background-color: #f8d7da;"><span class="card-title">Audit & Assess Effectiveness</span><div class="card-description">Periodically conduct audits and assessments to verify that the policy is being followed and is effectively mitigating risk.</div></div>
                                                <div class="framework-arrow"></div>
                                                <div class="framework-step-node" style="background-color: #d1ecf1;"><span class="card-title">Identify Gaps/Changes Needed</span><div class="card-description">Based on monitoring and audit results, identify any gaps or areas for improvement, which initiates the cycle again.</div></div>
                                            </div>
                                            <p class="text-gray-600 text-sm italic text-center">Policies require a continuous lifecycle of development, approval, implementation, and review. Click on each step to learn more.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3 mt-6">c. Ensure policies support compliance and are auditable.</h4>
                                            <p class="text-gray-600">Policies must clearly align with regulatory requirements and industry standards. They should also be written in a way that allows for easy verification and auditing of compliance.</p>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">5. Information Security Program Metrics<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                                                                       <p class="text-gray-600 mb-4">You can't manage what you can't measure. A robust metrics program is essential for demonstrating the effectiveness, efficiency, and value of the security program to stakeholders.</p>
                                            <table class="styled-table">
                                                <thead>
                                                    <tr>
                                                        <th>Metric Type</th>
                                                        <th>Purpose</th>
                                                        <th>Example</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><strong>KPI (Key Performance Indicator)</strong></td>
                                                        <td>Measures how well the program is performing against its objectives.</td>
                                                        <td class="highlight">Time to patch critical vulnerabilities.</td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>KRI (Key Risk Indicator)</strong></td>
                                                        <td>Provides an early warning of potential risks.</td>
                                                        <td class="highlight">Number of failed login attempts on critical systems.</td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>KGI (Key Goal Indicator)</strong></td>
                                                        <td>Measures progress towards a strategic goal.</td>
                                                        <td class="highlight">Reduction in financial loss from security incidents.</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section id="program-management-d3" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section B: Information Security Program Management</h2>
                                <div class="space-y-4">
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">1. Information Security Control Design and Selection<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Controls are the safeguards and countermeasures used to protect information assets. Their design and selection must be based on risk assessments and aligned with the organization's security architecture.</p>
                                            <ul class="list-disc list-inside text-gray-700 space-y-2">
                                                <li><strong>Control Types:</strong> Understand and apply different types of controls: preventative (stop incidents), detective (identify incidents), and corrective (remediate incidents).</li>
                                                <li><strong>Control Selection:</strong> Choose controls that are effective, efficient, and appropriate for the level of risk. This involves a cost-benefit analysis.</li>
                                                <li><strong>Compensating Controls:</strong> Implement alternative controls when a primary control cannot be used.</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">2. Information Security Control Integration and Implementation<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Implementing controls is a project in itself, requiring careful planning, integration with existing systems, and management of change to ensure they operate as intended without disrupting business processes.</p>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">3. Information Security Control Testing and Evaluation<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Controls must be regularly tested to ensure they are effective and operating as designed. This is a critical part of the 'Check' phase in a Plan-Do-Check-Act (PDCA) cycle.</p>
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" data-group="testing-methods-d3">
                                                <div class="concept-card"><span class="card-title">Vulnerability Scans</span><div class="card-description">Automated tools that scan systems for known vulnerabilities.</div></div>
                                                <div class="concept-card"><span class="card-title">Penetration Testing</span><div class="card-description">A simulated cyber attack against your computer system to check for exploitable vulnerabilities.</div></div>
                                                <div class="concept-card"><span class="card-title">Security Audits</span><div class="card-description">A formal, systematic review of security policies, procedures, and controls against a defined standard.</div></div>
                                                <div class="concept-card"><span class="card-title">Code Review</span><div class="card-description">Manual or automated review of source code to identify security flaws.</div></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">4. Information Security Awareness and Training<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">The human element is often the weakest link in security. A strong awareness and training program is essential to build a security-conscious culture and reduce human error.</p>
                                            <ul class="list-disc list-inside text-gray-700 space-y-2">
                                                <li><strong>Awareness:</strong> Aims to change behavior and reinforce the importance of security (e.g., posters, newsletters).</li>
                                                <li><strong>Training:</strong> Teaches specific skills needed to perform a job securely (e.g., secure coding practices for developers).</li>
                                                <li><strong>Education:</strong> Provides in-depth knowledge and understanding of security principles.</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">5. Management of External Services<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Organizations increasingly rely on third-party vendors and service providers. Managing the risks associated with these external services is a critical component of the security program.</p>
                                            <ul class="list-disc list-inside text-gray-700 space-y-2">
                                                <li><strong>Due Diligence:</strong> Assess the security posture of vendors before entering into a contract.</li>
                                                <li><strong>Contractual Agreements:</strong> Ensure contracts include clear security requirements, right-to-audit clauses, and defined SLAs.</li>
                                                <li><strong>Ongoing Monitoring:</strong> Continuously monitor vendor performance and compliance with security requirements.</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">6. Information Security Program Communications and Reporting<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Effective communication is key to gaining support for the security program and demonstrating its value. Reporting must be tailored to the audience.</p>
                                            <table class="styled-table">
                                                <thead>
                                                    <tr>
                                                        <th>Audience</th>
                                                        <th>Focus of Communication</th>
                                                        <th>Example Metrics</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><strong>Board of Directors / Senior Management</strong></td>
                                                        <td>Strategic alignment, risk posture, ROI</td>
                                                        <td class="highlight">KGIs, ALE, compliance status</td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>Business Unit Managers</strong></td>
                                                        <td>Impact on business processes, control effectiveness</td>
                                                        <td class="highlight">KRIs for their specific area, audit findings</td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>Technical Staff</strong></td>
                                                        <td>Operational performance, vulnerabilities</td>
                                                        <td class="highlight">KPIs, patch levels, incident statistics</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section id="key-terms-d3" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Key Terms</h2>
                                <p class="mb-8 text-gray-700">Click on a card to reveal its definition.</p>
                                <div id="key-terms-grid-d3" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6" data-group="key-terms-d3">
                                    <!-- Key terms populated by JS -->
                                </div>
                            </section>

                            <section id="domain-summary-d3" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Domain Summary</h2>
                                <div class="p-6 bg-white rounded-lg shadow-md">
                                    <p class="text-gray-700 mb-4">Domain 3 focuses on the practical application of governance and risk management principles by developing and managing a comprehensive information security program. It begins with ensuring the program is strategically aligned with business goals, supported by a clear security architecture and a roadmap for future development. A core component is the creation of a clear documentation hierarchyâ€”policies, standards, procedures, and guidelinesâ€”that provides direction and ensures consistency across the organization.</p>
                                    <p class="text-gray-700">The domain then shifts to the ongoing management of the program, covering the effective allocation and management of resources, including personnel and security technologies. It emphasizes the importance of a structured approach to identifying, acquiring, and managing security controls and services. Finally, Domain 3 underscores the necessity of a robust metrics program, using KPIs, KRIs, and KGIs to measure performance, monitor risks, and report the program's value to senior management, thereby facilitating informed decision-making and driving continuous improvement.</p>
                                </div>
                            </section>
                        </main>
                    </div>

                    <!-- =============================================================================== -->
                    <!-- == DOMAIN 4: INCIDENT MANAGEMENT ============================================== -->
                    <!-- =============================================================================== -->
                    <div id="domain-4" class="domain-content-section hidden">
                        <header class="text-center py-8 bg-white rounded-lg shadow-md mb-8">
                            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 mb-2">CISM Domain 4 Study Guide</h1>
                            <p class="text-xl sm:text-2xl text-gray-600">Information Security Incident Management</p>
                            <p class="text-md text-gray-500 mt-2">Responding to and recovering from security events.</p>
                        </header>

                        <nav class="bg-white p-4 rounded-lg shadow-md mb-8 flex justify-center sticky top-0 z-10 overflow-x-auto">
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200 active" data-target="introduction-d4">Introduction</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="incident-readiness-d4">Readiness & Planning</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="incident-response-d4">Response & Recovery</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="key-terms-d4">Key Terms</button>
                            <button class="domain-nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="domain-summary-d4">Domain Summary</button>
                        </nav>

                        <main>
                            <section id="introduction-d4" class="content-section fade-in">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Introduction to CISM Domain 4</h2>
                                <div class="p-6 bg-white rounded-lg shadow-md">
                                    <p class="text-gray-700 mb-4">Welcome to Domain 4. No matter how robust a security program is, incidents are inevitable. This domain focuses on ensuring the organization is prepared to respond to and recover from security incidents in a way that minimizes business impact, cost, and reputational damage.</p>
                                    <p class="text-gray-700">Effective incident management is about more than just technical response; it requires a well-defined plan, clear roles and responsibilities, and effective communication. This guide will walk you through the entire incident management lifecycle, from preparation and planning to post-incident analysis and program improvement. A mature incident management capability is a hallmark of a resilient organization.</p>
                                </div>
                            </section>

                            <section id="incident-readiness-d4" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section A: Incident Management Readiness</h2>
                                <div class="space-y-4">
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">1. The Incident Response Plan (IRP)<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">The IRP is the formal, documented plan that guides an organization's response to security incidents.</p>
                                            <h4 class="text-lg font-semibold text-gray-700 mb-3">Key Components of an IRP:</h4>
                                            <ul class="list-disc list-inside text-gray-700 space-y-2">
                                                <li><strong>Mission, Strategy, and Goals:</strong> Defines the purpose and objectives of the incident response capability.</li>
                                                <li><strong>Roles and Responsibilities:</strong> Establishes the Computer Incident Response Team (CIRT) and defines who does what during an incident.</li>
                                                <li><strong>Incident Classification:</strong> Provides a system for categorizing incidents based on severity and impact to prioritize response efforts.</li>
                                                <li><strong>Communication Plan:</strong> Outlines how, when, and with whom to communicate (e.g., stakeholders, legal, law enforcement, customers).</li>
                                                <li><strong>Response Procedures:</strong> Details the technical steps for each phase of the incident lifecycle.</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">2. Business Impact Analysis (BIA) and BCP/DRP Integration<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">Incident response must be integrated with broader business continuity and disaster recovery efforts.</p>
                                            <ul class="list-disc list-inside text-gray-700 space-y-2">
                                                <li><strong>Business Impact Analysis (BIA):</strong> Identifies critical business processes and the impact of a disruption to them. This helps prioritize incident response efforts.</li>
                                                <li><strong>Integration with BCP/DRP:</strong> The Incident Response Plan (IRP) is a key input to the Business Continuity Plan (BCP) and Disaster Recovery Plan (DRP). A security incident can often be the trigger for activating these broader plans.</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-md">
                                        <button class="accordion-button w-full">3. Testing and Training<span class="accordion-icon text-2xl">+</span></button>
                                        <div class="accordion-content hidden p-6">
                                            <p class="text-gray-700 mb-4">A plan is useless if it's not tested and if the team is not trained. Regular testing ensures the plan is effective and that the team is ready.</p>
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" data-group="testing-types">
                                                <div class="concept-card"><span class="card-title">Walkthroughs</span><div class="card-description">A team meeting where members verbally go through the steps of the IRP for a specific scenario to ensure it is understood.</div></div>
                                                <div class="concept-card"><span class="card-title">Tabletop Exercises</span><div class="card-description">A discussion-based session where the team talks through their roles and responses to a simulated incident scenario. Excellent for testing decision-making processes.</div></div>
                                                <div class="concept-card"><span class="card-title">Functional Drills</span><div class="card-description">A hands-on test of a specific function of the IRP, such as restoring a system from backup or failing over to a secondary site.</div></div>
                                                <div class="concept-card"><span class="card-title">Full-Scale Simulations</span><div class="card-description">A comprehensive, realistic test that simulates a major incident, involving multiple teams and potentially external partners.</div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section id="incident-response-d4" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section B: Incident Response and Recovery</h2>
                                <p class="mb-8 text-gray-700">This section covers the core lifecycle of managing an active security incident, from initial detection to final lessons learned.</p>
                                <h3 class="text-2xl font-bold text-gray-800 mb-4 text-center">The Incident Management Lifecycle</h3>
                                <p class="text-gray-600 mb-6 text-center">Most incident response frameworks, like the one from NIST, follow a cyclical process. Click on each phase to learn more.</p>
                                <div class="incident-lifecycle-container" data-group="incident-lifecycle">
                                    <div class="incident-lifecycle-node"><span class="card-title">1. Preparation</span><div class="card-description">Establishing the tools, plans, and training needed to respond effectively before an incident occurs. This includes setting up the CIRT and having the IRP ready.</div></div>
                                    <div class="incident-lifecycle-arrow"></div>
                                    <div class="incident-lifecycle-node"><span class="card-title">2. Identification</span><div class="card-description">Detecting a deviation from normal operations and determining if it constitutes a security incident. This involves analyzing logs, alerts, and other data sources.</div></div>
                                    <div class="incident-lifecycle-arrow"></div>
                                    <div class="incident-lifecycle-node"><span class="card-title">3. Containment</span><div class="card-description">Taking immediate steps to limit the scope and impact of the incident. This could involve isolating affected systems or blocking malicious IP addresses.</div></div>
                                    <div class="incident-lifecycle-arrow"></div>
                                    <div class="incident-lifecycle-node"><span class="card-title">4. Eradication</span><div class="card-description">Removing the root cause of the incident and any malicious artifacts from the environment. This ensures the attacker cannot regain access.</div></div>
                                    <div class="incident-lifecycle-arrow"></div>
                                    <div class="incident-lifecycle-node"><span class="card-title">5. Recovery</span><div class="card-description">Restoring systems to normal operation and validating that they are secure. This phase often involves close coordination with IT operations and business units.</div></div>
                                    <div class="incident-lifecycle-arrow"></div>
                                    <div class="incident-lifecycle-node"><span class="card-title">6. Lessons Learned</span><div class="card-description">Conducting a post-incident review to identify what went well, what didn't, and what can be improved. The findings are used to update the IRP and the overall security program.</div></div>
                                </div>
                            </section>

                            <section id="key-terms-d4" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Key Terms</h2>
                                <p class="mb-8 text-gray-700">Click on a card to reveal its definition.</p>
                                <div id="key-terms-grid-d4" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6" data-group="key-terms-d4">
                                    <!-- Key terms populated by JS -->
                                </div>
                            </section>

                            <section id="domain-summary-d4" class="content-section hidden">
                                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Domain Summary</h2>
                                <div class="p-6 bg-white rounded-lg shadow-md">
                                    <p class="text-gray-700 mb-4">Domain 4 addresses the critical capability of managing information security incidents. It recognizes that prevention alone is insufficient and that a mature organization must be prepared to respond to and recover from security events effectively. The foundation of this capability is a well-documented and regularly tested Incident Response Plan (IRP), which defines roles, responsibilities, and procedures.</p>
                                    <p class="text-gray-700">The domain emphasizes the importance of readiness, which includes integrating incident response with business continuity and disaster recovery planning, informed by a Business Impact Analysis (BIA). It also highlights the need for a trained and tested Computer Incident Response Team (CIRT). The core of the domain is the incident management lifecycle: Preparation, Identification, Containment, Eradication, Recovery, and Lessons Learned. This structured approach ensures that incidents are handled consistently, minimizing business impact and facilitating a swift return to normal operations. Finally, the post-incident "Lessons Learned" phase is crucial for driving continuous improvement, feeding insights back into the security program and strengthening the organization's resilience over time.</p>
                                </div>
                            </section>
                        </main>
                    </div>

                    <!-- =============================================================================== -->
                    <!-- == KNOWLEDGE ASSESSMENT ======================================================= -->
                    <!-- =============================================================================== -->
                    <div id="assessment" class="domain-content-section hidden">
                        <header class="text-center py-8 bg-white rounded-lg shadow-md mb-8">
                            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 mb-2">Knowledge Assessment</h1>
                            <p class="text-xl sm:text-2xl text-gray-600">Test Your Understanding of the CISM Domains</p>
                        </header>
                        <main>
                            <div id="quiz-container">
                                <!-- Quiz questions will be injected here -->
                            </div>
                            <div id="quiz-results" class="hidden mt-8">
                                <h2 class="text-3xl font-bold text-gray-800 mb-4">Quiz Complete!</h2>
                                <p id="quiz-score" class="text-2xl text-gray-700 mb-4"></p>
                                <p id="quiz-summary" class="text-lg text-gray-600 mb-6"></p>
                                <button id="retake-quiz-btn" class="px-6 py-3 bg-teal-600 text-white font-bold rounded-lg shadow-md hover:bg-teal-700 transition-colors">Retake Quiz</button>
                            </div>
                        </main>
                    </div>
                </div>
            </main>
        </div>

        <footer class="text-center py-6 mt-8 text-gray-500 text-sm">
            <p>&copy; 2024 CISM Unified Study Guide. All rights reserved. For educational purposes only.</p>
        </footer>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- Master Navigation Handler ---
        const masterNavButtons = document.querySelectorAll('#master-navigation .master-nav-item');
        const domainContentSections = document.querySelectorAll('.domain-content-section');

        masterNavButtons.forEach(button => {
            button.addEventListener('click', () => {
                masterNavButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                const targetDomainId = button.dataset.domainTarget;
                
                domainContentSections.forEach(sec => sec.classList.add('hidden'));

                const targetContainer = document.getElementById(targetDomainId);
                if (targetContainer) {
                    targetContainer.classList.remove('hidden');
                    setupDomain(targetContainer);
                }
            });
        });

        // --- Domain-Specific Setup Function ---
        function setupDomain(domainContainer) {
            if (!domainContainer || domainContainer.dataset.initialized === 'true') {
                return;
            }

            // --- Logic specific to 'about-cism' section ---
            if (domainContainer.id === 'about-cism') {
                const whyCismData = [
                    { title: "Leadership-Focused", description: "Emphasizes the strategic alignment of security initiatives with business goals, moving beyond purely technical skills to focus on governance and management." },
                    { title: "Career-Enhancing", description: "Qualifies you for high-level, influential roles like Information Security Manager, Risk Manager, and Chief Information Security Officer (CISO)." },
                    { title: "Global Recognition", description: "Respected and accepted by organizations and governments worldwide as a standard of excellence for information security leadership." },
                    { title: "Industry Relevance", description: "Designed around current, real-world challenges in governance, risk, program development, and incident management, ensuring your knowledge is up-to-date." }
                ];

                const examDomainsData = [
                    { title: "Domain 1: Governance (17%)", description: "Focuses on establishing and maintaining an information security governance framework and supporting processes to ensure that the information security strategy is aligned with organizational goals and objectives." },
                    { title: "Domain 2: Risk Management (20%)", description: "Covers the management of information risk to an acceptable level based on the organization's risk appetite in order to meet organizational goals and objectives." },
                    { title: "Domain 3: Program Development (33%)", description: "Deals with developing and maintaining an information security program that identifies, manages, and protects the organization's assets while aligning to the information security strategy." },
                    { title: "Domain 4: Incident Management (30%)", description: "Pertains to planning, establishing, and managing the capability to detect, investigate, respond to, and recover from information security incidents to minimize business impact." }
                ];

                const renderWhyCismCards = () => {
                    const container = domainContainer.querySelector('#why-cism-cards-container');
                    if (!container) return;
                    container.innerHTML = ''; 
                    whyCismData.forEach(item => {
                        const cardHtml = `<div class="interactive-card"><h3 class="card-title">${item.title}</h3><div class="card-description"><p>${item.description}</p></div></div>`;
                        container.insertAdjacentHTML('beforeend', cardHtml);
                    });
                };

                const renderExamDomainCards = () => {
                    const container = domainContainer.querySelector('#domain-cards-container');
                    if (!container) return;
                    container.innerHTML = ''; 
                    examDomainsData.forEach(domain => {
                        const cardHtml = `<div class="interactive-card"><h3 class="card-title">${domain.title}</h3><div class="card-description"><p>${domain.description}</p></div></div>`;
                        container.insertAdjacentHTML('beforeend', cardHtml);
                    });
                };

                renderWhyCismCards();
                renderExamDomainCards();
            }

            // --- Logic specific to 'domain-1' ---
            if (domainContainer.id === 'domain-1') {
                // Security Culture Chart
                const secCultureCtx = domainContainer.querySelector('#securityCultureChart')?.getContext('2d');
                if (secCultureCtx) {
                    const securityCultureChartInstance = new Chart(secCultureCtx, { type: 'doughnut', data: { labels: ['Vigilant & Proactive', 'Compliant', 'Indifferent', 'Resistant'], datasets: [{ data: [50, 30, 15, 5], backgroundColor: ['#00A896', '#A1C9CE', '#FFD700', '#FF6384'] }] }, options: { responsive: true, maintainAspectRatio: false } });
                    domainContainer.querySelectorAll('[data-culture-type]').forEach(button => {
                        button.addEventListener('click', e => {
                            const type = e.currentTarget.dataset.cultureType;
                            securityCultureChartInstance.data.datasets[0].data = type === 'strongCulture' ? [50, 30, 15, 5] : [10, 20, 40, 30];
                            securityCultureChartInstance.update();
                        });
                    });
                }

                // Leadership Engagement Slider
                const leadershipSlider = domainContainer.querySelector('#leadershipEngagement');
                if (leadershipSlider) {
                    const engagementValue = domainContainer.querySelector('#engagementValue');
                    const engagementDescription = domainContainer.querySelector('#engagementDescription');
                    const levels = [
                        { value: 0, label: "Minimal Engagement", description: "Security is seen as an IT-only issue, with little to no executive involvement or support. Resistance to security initiatives is high." },
                        { value: 25, label: "Basic Engagement", description: "Leadership provides some support, but it's often reactive and driven by compliance needs. Security is not a strategic priority." },
                        { value: 50, label: "Moderate Engagement", description: "Policies are generally followed, but security may lack strong strategic momentum or innovation. Leadership supports approved initiatives." },
                        { value: 75, label: "Strong Engagement", description: "Leadership actively champions security, integrating it into business strategy and providing consistent resources and support." },
                        { value: 100, label: "Transformative Engagement", description: "Security is a core business value, driven by a highly engaged leadership that fosters a proactive, security-aware culture at all levels." }
                    ];
                    leadershipSlider.addEventListener('input', e => {
                        const value = parseInt(e.target.value);
                        const level = levels.find((l, i) => value >= l.value && (!levels[i+1] || value < levels[i+1].value)) || levels[0];
                        engagementValue.textContent = level.label;
                        engagementDescription.textContent = level.description;
                    });
                }
                
                // Security Initiatives Chart
                const secInitiativesCtx = domainContainer.querySelector('#securityInitiativesChart')?.getContext('2d');
                if(secInitiativesCtx) {
                    const securityInitiativesData = {
                        labels: [['Data Protection', 'Enhancement'], ['Cloud Security', 'Migration'], ['Incident Response', 'Plan'], ['Security Awareness', 'Program'], ['Vendor Risk', 'Management']],
                        complianceDriven: { data: [80, 60, 40, 70, 50] },
                        revenueDriven: { data: [50, 75, 85, 30, 60] }
                    };
                    const securityInitiativesChartInstance = new Chart(secInitiativesCtx, {
                        type: 'bar', data: { labels: securityInitiativesData.labels, datasets: [{ label: 'Priority Score', data: securityInitiativesData.complianceDriven.data, backgroundColor: ['#A1C9CE', '#8FB8A1', '#FFD700', '#FF6384', '#6A5ACD'] }] }, options: { responsive: true, maintainAspectRatio: false }
                    });
                    domainContainer.querySelectorAll('[data-priority-type]').forEach(button => {
                        button.addEventListener('click', e => {
                            const type = e.currentTarget.dataset.priorityType;
                            securityInitiativesChartInstance.data.datasets[0].data = securityInitiativesData[type].data;
                            securityInitiativesChartInstance.update();
                        });
                    });
                }

                // Budget Allocator
                const budgetChartCtx = domainContainer.querySelector('#budgetChart')?.getContext('2d');
                if(budgetChartCtx) {
                    const budgetInputs = ['techToolsPct', 'personnelStaffingPct', 'trainingAwarenessPct', 'complianceAuditPct'];
                    const totalBudgetInput = domainContainer.querySelector('#totalBudget');
                    const budgetChartInstance = new Chart(budgetChartCtx, { type: 'doughnut', data: { labels: ['Technology & Tools', 'Personnel & Staffing', 'Training & Awareness', 'Compliance & Audit'], datasets: [{ data: [40, 35, 15, 10], backgroundColor: ['#A1C9CE', '#FFD700', '#FF6384', '#8FB8A1'] }] }, options: { responsive: true, maintainAspectRatio: false } });
                    const updateBudgetChart = () => {
                        const values = budgetInputs.map(id => parseFloat(domainContainer.querySelector(`#${id}`).value) || 0);
                        budgetChartInstance.data.datasets[0].data = values;
                        budgetChartInstance.update();
                    };
                    budgetInputs.forEach(id => domainContainer.querySelector(`#${id}`)?.addEventListener('input', updateBudgetChart));
                    totalBudgetInput?.addEventListener('input', e => {
                        let value = e.target.value.replace(/,/g, '');
                        if (!isNaN(value) && value.length > 0) {
                            e.target.value = parseFloat(value).toLocaleString('en-US');
                        }
                    });
                }

                // KRI Trend Chart
                const kriTrendCtx = domainContainer.querySelector('#kriTrendChart')?.getContext('2d');
                if(kriTrendCtx) {
                    const kriTrendData = {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                        criticalVulnerabilities: { label: 'Critical Vulnerabilities Detected', data: [25, 22, 18, 15, 12, 10, 8, 7, 6, 5, 4, 3], borderColor: '#DC3545', backgroundColor: 'rgba(220, 53, 69, 0.2)' },
                        phishingAttempts: { label: 'Phishing Attempts Reported', data: [10, 12, 15, 13, 11, 9, 8, 10, 12, 11, 9, 7], borderColor: '#FFD700', backgroundColor: 'rgba(255, 215, 0, 0.2)' },
                        failedAccess: { label: 'Failed Access Attempts', data: [50, 45, 40, 38, 35, 30, 28, 25, 22, 20, 18, 15], borderColor: '#004085', backgroundColor: 'rgba(0, 64, 133, 0.2)' }
                    };
                    const kriTrendChartInstance = new Chart(kriTrendCtx, { type: 'line', data: { labels: kriTrendData.labels, datasets: [{ ...kriTrendData.criticalVulnerabilities, fill: true, tension: 0.3 }] }, options: { responsive: true, maintainAspectRatio: false } });
                    domainContainer.querySelectorAll('[data-kri-type]').forEach(button => {
                        button.addEventListener('click', e => {
                            const data = kriTrendData[e.currentTarget.dataset.kriType];
                            kriTrendChartInstance.data.datasets[0] = { ...data, fill: true, tension: 0.3 };
                            kriTrendChartInstance.update();
                        });
                    });
                }
            }

            // --- Logic specific to 'domain-2' ---
            else if (domainContainer.id === 'domain-2') {
                const threatDistributionData = {
                    threatOrder: ['Ransomware', 'Insider Threats', 'Third-Party Risks', 'Phishing', 'DDoS', 'APT'],
                    threatColors: ['#A1C9CE', '#8FB8A1', '#FFD700', '#FF6384', '#6A5ACD', '#DAA520'],
                    overall: { data: [25, 15, 20, 20, 10, 10], explanation: `This chart shows the overall distribution of common emerging threats...`},
                    ransomwareFocus: { data: [40, 10, 15, 15, 10, 10], explanation: `This view highlights a scenario where Ransomware is a primary concern...` },
                    insiderFocus: { data: [10, 40, 15, 15, 10, 10], explanation: `This view emphasizes Insider Threats...` },
                    thirdPartyFocus: { data: [15, 10, 40, 15, 10, 10], explanation: `This view emphasizes Third-Party Risks...` },
                    phishingFocus: { data: [15, 10, 10, 40, 10, 15], explanation: `This view emphasizes Phishing attacks...` },
                    ddosFocus: { data: [10, 10, 15, 15, 40, 10], explanation: `This view emphasizes DDoS attacks...` },
                    aptFocus: { data: [10, 10, 15, 15, 10, 40], explanation: `This view emphasizes APTs...` }
                };
                const detailedRoleDescriptions = {
                    board: { description: "The Board and Executive Management hold ultimate accountability for information security risk. They are responsible for setting the organization's risk appetite, ensuring adequate resources are allocated, and providing oversight to the entire security program." },
                    ciso: { description: "The CISO (Chief Information Security Officer) or Information Security Manager is responsible for the strategic direction and day-to-day management of the security program. They oversee risk assessments, control implementation, and report the risk posture to the board." },
                    dataOwners: { description: "Data Owners and Business Unit Heads are accountable for the risks associated with the information assets within their purview. They are responsible for classifying data, defining access rights, and accepting risk on behalf of their department." },
                    itOps: { description: "IT Operations and dedicated Security Teams are primarily responsible for the technical implementation, operation, and maintenance of security controls. They are the 'control operators' who manage firewalls, patching, monitoring tools, etc." },
                    endUsers: { description: "Every end user in the organization plays a vital role in information security. They have a responsibility to comply with security policies, report suspicious activity, and act as the first line of defense against threats like phishing." }
                };
                const riskMonitoringKRITrendData = {
                    unpatchedSystems: { label: 'Unpatched Critical Systems (Count)', data: [15, 12, 10, 8, 7, 6, 5, 4, 3, 2, 1, 1], borderColor: '#FF6384', backgroundColor: 'rgba(255, 99, 132, 0.2)' },
                    securityIncidents: { label: 'Security Incidents Reported (Monthly)', data: [5, 7, 6, 8, 9, 7, 6, 5, 4, 3, 2, 2], borderColor: '#A1C9CE', backgroundColor: 'rgba(161, 201, 206, 0.2)' },
                    thirdPartyBreaches: { label: 'Third-Party Breach Incidents (Quarterly)', data: [2, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0], borderColor: '#8FB8A1', backgroundColor: 'rgba(143, 184, 161, 0.2)' }
                };
                const keyTermsData = [
                    { term: "Inherent Risk", definition: "The level of risk that exists before any controls or other mitigating factors are put in place. It's the raw risk." },
                    { term: "Residual Risk", definition: "The level of risk that remains after controls have been implemented and account for their effectiveness. This is the risk that management accepts." },
                    { term: "Risk Appetite", definition: "The amount of risk an organization is willing to take to achieve its objectives. It's a high-level strategic statement." },
                    { term: "Risk Tolerance", definition: "The acceptable deviation from the risk appetite. It sets specific thresholds for different types of risks." },
                    { term: "Qualitative Risk Assessment", definition: "Uses descriptive terms (e.g., high, medium, low) to define likelihood and impact. It's subjective but quick and often used for initial assessments." },
                    { term: "Quantitative Risk Assessment", definition: "Assigns numerical values (e.g., monetary cost, probability percentages) to likelihood and impact. It aims to provide a more objective and measurable view of risk (e.g., ALE, SLE, ARO)." },
                    { term: "Annualized Loss Expectancy (ALE)", definition: "The expected monetary loss for an asset due to a risk over a one-year period. Calculated as Single Loss Expectancy (SLE) multiplied by Annualized Rate of Occurrence (ARO)." },
                    { term: "Single Loss Expectancy (SLE)", definition: "The monetary loss expected each time a risk event occurs. Calculated as Asset Value (AV) multiplied by Exposure Factor (EF)." },
                    { term: "Annualized Rate of Occurrence (ARO)", definition: "The estimated frequency at which a threat event is expected to occur within a one-year period." },
                    { term: "Risk Mitigation", definition: "Reducing the likelihood or impact of a risk through the implementation of security controls." },
                    { term: "Risk Transfer", definition: "Shifting the financial or operational burden of a risk to a third party, often through insurance or contractual agreements." },
                    { term: "Risk Avoidance", definition: "Eliminating the risk entirely by choosing not to engage in or ceasing an activity that gives rise to the risk." },
                    { term: "Risk Acceptance", definition: "Acknowledging the existence of a risk and deciding to take no further action to mitigate it, usually with formal management approval." },
                    { term: "Key Risk Indicator (KRI)", definition: "Metrics that provide an early warning signal of increasing risk exposure, helping in proactive risk management." },
                    { term: "Risk Register", definition: "A central repository for all identified risks, including their description, ownership, assessment, and treatment status." }
                ];

                let threatDistributionChartInstance, riskMonitoringKRIChartInstance;

                const calculateQuantitativeRisk = () => {
                    const assetValueInput = domainContainer.querySelector('#assetValue');
                    if (!assetValueInput) return;
                    const rawAssetValue = assetValueInput.value.replace(/,/g, '');
                    let assetValue = parseFloat(rawAssetValue);
                    const exposureFactor = parseFloat(domainContainer.querySelector('#exposureFactor').value);
                    const aro = parseFloat(domainContainer.querySelector('#aro').value);
                    let sle = 0, ale = 0;
                    if (!isNaN(assetValue)) assetValueInput.value = assetValue.toLocaleString('en-US');
                    else assetValue = 0;
                    if (!isNaN(assetValue) && !isNaN(exposureFactor)) sle = assetValue * exposureFactor;
                    if (!isNaN(sle) && !isNaN(aro)) ale = sle * aro;
                    domainContainer.querySelector('#sleResult').textContent = sle.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    domainContainer.querySelector('#aleResult').textContent = ale.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                };

                const renderKeyTerms = () => {
                    const container = domainContainer.querySelector('#key-terms-grid-d2');
                    if (!container) return;
                    container.innerHTML = '';
                    keyTermsData.forEach((item, index) => {
                        const cardHtml = `<div class="key-term-card" data-term-key="${index}"><h3 class="card-title">${item.term}</h3><div class="card-description"><p>${item.definition}</p></div></div>`;
                        container.insertAdjacentHTML('beforeend', cardHtml);
                    });
                };
                
                renderKeyTerms();
                calculateQuantitativeRisk();

                const threatCtx = domainContainer.querySelector('#threatDistributionChart')?.getContext('2d');
                if (threatCtx && !Chart.getChart(threatCtx)) {
                    threatDistributionChartInstance = new Chart(threatCtx, { type: 'doughnut', data: { labels: threatDistributionData.threatOrder, datasets: [{ data: threatDistributionData.overall.data, backgroundColor: threatDistributionData.threatColors }] }, options: { responsive: true, maintainAspectRatio: false } });
                }

                const kriCtx = domainContainer.querySelector('#riskMonitoringKRIChart')?.getContext('2d');
                if (kriCtx && !Chart.getChart(kriCtx)) {
                    riskMonitoringKRIChartInstance = new Chart(kriCtx, { type: 'line', data: { labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'], datasets: [{ ...riskMonitoringKRITrendData.unpatchedSystems, fill: true, tension: 0.3 }] }, options: { responsive: true, maintainAspectRatio: false } });
                }

                domainContainer.querySelectorAll('.toggle-chart-data').forEach(button => {
                    button.addEventListener('click', () => {
                        const dataSetKey = button.dataset.dataSet;
                        const data = threatDistributionData[dataSetKey];
                        if (threatDistributionChartInstance && data) {
                            threatDistributionChartInstance.data.datasets[0].data = data.data;
                            threatDistributionChartInstance.update();
                            domainContainer.querySelector('#threat-explanation').textContent = data.explanation;
                        }
                    });
                });

                domainContainer.querySelector('#riskMonitoringKRISelect')?.addEventListener('change', (e) => {
                    const selectedKRI = e.target.value;
                    const data = riskMonitoringKRITrendData[selectedKRI];
                    if (riskMonitoringKRIChartInstance && data) {
                        riskMonitoringKRIChartInstance.data.datasets[0] = { ...data, fill: true, tension: 0.3 };
                        riskMonitoringKRIChartInstance.update();
                    }
                });

                domainContainer.querySelectorAll('#assetValue, #exposureFactor, #aro').forEach(input => {
                    input.addEventListener('input', calculateQuantitativeRisk);
                });

                domainContainer.querySelectorAll('.role-node').forEach(node => {
                    node.addEventListener('click', () => {
                        const roleKey = node.dataset.role;
                        const desc = detailedRoleDescriptions[roleKey]?.description || '';
                        node.querySelector('.role-description').innerHTML = `<p>${desc}</p>`;
                    });
                });
                
                domainContainer.querySelectorAll('.flow-node[data-node-type="vulnerability"]').forEach(vulnerabilityNode => {
                    vulnerabilityNode.addEventListener('click', () => {
                        const scenarioContainer = vulnerabilityNode.closest('.flow-scenario');
                        const currentlyActive = vulnerabilityNode.classList.contains('active');
                        
                        domainContainer.querySelectorAll('.flow-scenario').forEach(sc => {
                            sc.querySelectorAll('.flow-node').forEach(n => n.classList.remove('active'));
                            sc.querySelectorAll('.flow-arrow, .flow-node[data-node-type=\'threat\'], .flow-node[data-node-type=\'impact\']').forEach(el => el.classList.add('hidden'));
                        });

                        if (!currentlyActive) {
                            vulnerabilityNode.classList.add('active');
                            scenarioContainer.querySelector('.flow-arrow[data-arrow-id="0-1"]')?.classList.remove('hidden');
                            scenarioContainer.querySelector('.flow-node[data-node-type="threat"]')?.classList.remove('hidden');
                        }
                    });
                });

                domainContainer.querySelectorAll('.flow-node[data-node-type="threat"]').forEach(threatNode => {
                    threatNode.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const scenarioContainer = threatNode.closest('.flow-scenario');
                        const currentlyActive = threatNode.classList.contains('active');

                        if (currentlyActive) {
                             threatNode.classList.remove('active');
                             scenarioContainer.querySelector('.flow-arrow[data-arrow-id="1-2"]')?.classList.add('hidden');
                             const impactNode = scenarioContainer.querySelector('.flow-node[data-node-type="impact"]');
                             impactNode?.classList.add('hidden');
                             impactNode?.classList.remove('active');
                        } else {
                            threatNode.classList.add('active');
                            scenarioContainer.querySelector('.flow-arrow[data-arrow-id="1-2"]')?.classList.remove('hidden');
                            scenarioContainer.querySelector('.flow-node[data-node-type="impact"]')?.classList.remove('hidden');
                        }
                    });
                });
                 domainContainer.querySelectorAll('.flow-node[data-node-type="impact"]').forEach(impactNode => {
                    impactNode.addEventListener('click', (e) => {
                        e.stopPropagation();
                        impactNode.classList.toggle('active');
                    });
                });
            }

            // --- Logic specific to 'domain-3' ---
            else if (domainContainer.id === 'domain-3') {
                const keyTerms = [
                    { term: "Security Architecture", definition: "The design of security controls within an organization's IT infrastructure to protect its assets. It defines how controls are positioned and how they relate to each other." },
                    { term: "Defense-in-Depth", definition: "A security strategy that uses multiple layers of security controls to protect an asset. If one layer fails, another is in place to stop an attack." },
                    { term: "Security Policy", definition: "A high-level document, approved by senior management, that defines an organization's overall stance on information security." },
                    { term: "Security Standard", definition: "A mandatory rule that specifies the use of certain technologies or configurations to support a policy." },
                    { term: "Business Impact Analysis (BIA)", definition: "A process to identify critical business functions and determine the potential impact of a disruption to those functions." },
                    { term: "Security Awareness Training", definition: "A formal program to educate employees about security threats and their responsibilities in protecting the organization's assets." },
                    { term: "Key Performance Indicator (KPI)", definition: "A metric that measures the performance and effectiveness of a security control or process (e.g., percentage of systems patched within 30 days)." },
                    { term: "Identity and Access Management (IAM)", definition: "The framework of policies and technologies for ensuring that the right users have the appropriate access to technology resources." }
                ];
                const container = domainContainer.querySelector('#key-terms-grid-d3');
                if (container && container.children.length === 0) {
                    container.innerHTML = keyTerms.map(item => 
                        `<div class="key-term-card"><h3 class="card-title">${item.term}</h3><div class="card-description"><p>${item.definition}</p></div></div>`
                    ).join('');
                }

                // D3 Budget Allocator Logic
                const totalBudgetInputD3 = domainContainer.querySelector('#totalBudgetD3');
                const peoplePctInput = domainContainer.querySelector('#peoplePct');
                const toolsPctInput = domainContainer.querySelector('#toolsPct');
                const trainingPctInput = domainContainer.querySelector('#trainingPct');
                const compliancePctInput = domainContainer.querySelector('#compliancePct');
                const budgetInputsD3 = [peoplePctInput, toolsPctInput, trainingPctInput, compliancePctInput];
                
                const d3BudgetCtx = domainContainer.querySelector('#d3BudgetChart')?.getContext('2d');
                let d3BudgetChartInstance;

                if (d3BudgetCtx && !Chart.getChart(d3BudgetCtx)) {
                    d3BudgetChartInstance = new Chart(d3BudgetCtx, {
                        type: 'bar',
                        data: {
                            labels: ['People (Staffing)', 'Tools & Software', 'Training & Awareness', 'Compliance & Audit'],
                            datasets: [{
                                label: 'Percentage of Budget',
                                data: [40, 30, 15, 15],
                                backgroundColor: ['#A1C9CE', '#8FB8A1', '#FFD700', '#FF6384'],
                                borderColor: ['#A1C9CE', '#8FB8A1', '#FFD700', '#FF6384'],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    beginAtZero: true,
                                    max: 100,
                                    title: {
                                        display: true,
                                        text: 'Percentage of Budget'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                }

                const updateD3Budget = () => {
                    if (!totalBudgetInputD3 || budgetInputsD3.some(input => !input)) return;

                    let totalBudget = parseFloat(totalBudgetInputD3.value.replace(/,/g, '')) || 0;
                    const percentages = {
                        people: parseFloat(peoplePctInput.value) || 0,
                        tools: parseFloat(toolsPctInput.value) || 0,
                        training: parseFloat(trainingPctInput.value) || 0,
                        compliance: parseFloat(compliancePctInput.value) || 0,
                    };

                    const totalPct = percentages.people + percentages.tools + percentages.training + percentages.compliance;
                    const feedbackEl = domainContainer.querySelector('#allocation-feedback');

                    if (feedbackEl) {
                        if (totalPct === 100) {
                            feedbackEl.textContent = 'Allocation valid!';
                            feedbackEl.style.color = 'green';
                        } else {
                            feedbackEl.textContent = `Total percentage is ${totalPct}%. It must be 100%.`;
                            feedbackEl.style.color = 'red';
                        }
                    }

                    domainContainer.querySelector('#peopleValue').textContent = '$' + (totalBudget * (percentages.people / 100)).toLocaleString('en-US');
                    domainContainer.querySelector('#toolsValue').textContent = '$' + (totalBudget * (percentages.tools / 100)).toLocaleString('en-US');
                    domainContainer.querySelector('#trainingValue').textContent = '$' + (totalBudget * (percentages.training / 100)).toLocaleString('en-US');
                    domainContainer.querySelector('#complianceValue').textContent = '$' + (totalBudget * (percentages.compliance / 100)).toLocaleString('en-US');
                    
                    if (d3BudgetChartInstance) {
                        d3BudgetChartInstance.data.datasets[0].data = [percentages.people, percentages.tools, percentages.training, percentages.compliance];
                        d3BudgetChartInstance.update();
                    }
                };

                totalBudgetInputD3?.addEventListener('input', (e) => {
                    let value = e.target.value.replace(/,/g, '');
                    if (!isNaN(value) && value.length > 0) {
                        e.target.value = parseFloat(value).toLocaleString('en-US');
                    }
                    updateD3Budget();
                });

                budgetInputsD3.forEach(input => {
                    input?.addEventListener('input', updateD3Budget);
                });

                // Initial call if the elements exist
                if (domainContainer.querySelector('#totalBudgetD3')) {
                    updateD3Budget();
                }
            }

            // --- Logic specific to 'domain-4' ---
            else if (domainContainer.id === 'domain-4') {
                const keyTerms = [
                    { term: "Incident Response Plan (IRP)", definition: "A documented plan that outlines the procedures and responsibilities for responding to a security incident." },
                    { term: "CIRT / CSIRT", definition: "Computer Incident Response Team / Computer Security Incident Response Team. A dedicated group responsible for responding to security incidents." },
                    { term: "Containment", definition: "The phase of incident response focused on limiting the scope and impact of an incident to prevent further damage." },
                    { term: "Eradication", definition: "The phase of incident response where the root cause of the incident and all malicious artifacts are removed from the environment." },
                    { term: "Recovery", definition: "The phase of incident response where systems are restored to normal operation after an incident has been contained and eradicated." },
                    { term: "Recovery Time Objective (RTO)", definition: "The maximum acceptable amount of time that a system or business process can be down after a disaster or failure." },
                    { term: "Recovery Point Objective (RPO)", definition: "The maximum acceptable amount of data loss, measured in time. It defines the point in time to which data must be restored." },
                    { term: "Chain of Custody", definition: "A documented record of the handling and storage of evidence from the time it is collected until it is presented in court, ensuring its integrity." }
                ];
                const container = domainContainer.querySelector('#key-terms-grid-d4');
                if (container && container.children.length === 0) {
                    container.innerHTML = keyTerms.map(item => 
                        `<div class="key-term-card"><h3 class="card-title">${item.term}</h3><div class="card-description"><p>${item.definition}</p></div></div>`
                    ).join('');
                }
            }

            // --- Logic specific to 'assessment' ---
            else if (domainContainer.id === 'assessment') {
                const quizQuestions = [
                    // Domain 1
                    { domain: 1, question: "What is the PRIMARY objective of information security governance?", options: ["To implement security controls", "To ensure security aligns with business objectives", "To perform risk assessments", "To achieve compliance with all regulations"], answer: 1, explanation: "The primary goal of governance is strategic alignment. While implementing controls, performing assessments, and achieving compliance are all important activities, they are all done in service of ensuring the security program supports the overall business goals." },
                    { domain: 1, question: "Which of the following BEST describes the concept of 'due care'?", options: ["Conducting an investigation before a transaction", "Implementing controls to a reasonable standard", "Purchasing cyber insurance", "Following a specific security framework"], answer: 1, explanation: "'Due care' is about taking the reasonable steps and actions to protect assets, which translates to implementing and maintaining controls. 'Due diligence' is the investigation process (A)." },
                    // Domain 2
                    { domain: 2, question: "An organization decides not to launch a new mobile application in a high-risk region due to overwhelming security concerns. This is an example of which risk response strategy?", options: ["Mitigation", "Transfer", "Acceptance", "Avoidance"], answer: 3, explanation: "Risk avoidance is the strategy of choosing not to engage in an activity that would introduce unacceptable risk. By not launching the app, the organization is avoiding the associated risks entirely." },
                    { domain: 2, question: "Calculating the Annualized Loss Expectancy (ALE) is a key component of which type of risk assessment?", options: ["Qualitative", "Hybrid", "Quantitative", "Ad-hoc"], answer: 2, explanation: "Quantitative risk assessment focuses on assigning monetary values to risk. The ALE, which calculates the expected financial loss per year, is a hallmark of this approach." },
                    // Domain 3
                    { domain: 3, question: "Which document in the security documentation hierarchy provides step-by-step instructions on how to perform a specific task?", options: ["Policy", "Standard", "Guideline", "Procedure"], answer: 3, explanation: "Procedures provide the detailed, step-by-step instructions for implementing policies and standards. Policies are high-level 'what', standards are mandatory 'how', and guidelines are recommended best practices." },
                    { domain: 3, question: "A metric that provides an early warning of a potential security problem, such as a sudden spike in failed login attempts, is known as a:", options: ["Key Performance Indicator (KPI)", "Key Goal Indicator (KGI)", "Key Risk Indicator (KRI)", "Return on Investment (ROI)"], answer: 2, explanation: "Key Risk Indicators (KRIs) are forward-looking metrics designed to provide early warnings of increasing risk exposure, allowing for proactive intervention." },
                    // Domain 4
                    { domain: 4, question: "What is the PRIMARY goal of the 'Containment' phase in the incident response lifecycle?", options: ["To remove the attacker from the network", "To restore systems from backup", "To limit the scope and impact of the incident", "To perform a post-incident review"], answer: 2, explanation: "The immediate goal of containment is to stop the bleedingâ€”to prevent the incident from spreading further and causing more damage. Eradication (A) and Recovery (B) come after containment." },
                    { domain: 4, question: "A discussion-based exercise where team members walk through their roles and responsibilities in a simulated incident scenario is BEST described as a:", options: ["Full-scale simulation", "Functional drill", "Walkthrough", "Tabletop exercise"], answer: 3, explanation: "A tabletop exercise is specifically designed as a discussion-based activity to test decision-making processes and communication flows without involving actual technical systems." },
                ];
                let userAnswers = {};

                const renderQuiz = () => {
                    const quizContainer = domainContainer.querySelector('#quiz-container');
                    const quizResults = domainContainer.querySelector('#quiz-results');
                    if (!quizContainer || !quizResults) return;

                    quizContainer.innerHTML = '';
                    quizResults.classList.add('hidden');
                    userAnswers = {};

                    quizQuestions.forEach((q, index) => {
                        const optionsHtml = q.options.map((opt, i) => 
                            `<button class="quiz-option" data-question="${index}" data-option="${i}">${String.fromCharCode(65 + i)}. ${opt}</button>`
                        ).join('');

                        const questionHtml = `
                            <div class="quiz-question-container" id="question-${index}">
                                <p class="text-lg font-semibold mb-4"><strong>Question ${index + 1} (Domain ${q.domain}):</strong> ${q.question}</p>
                                <div class="space-y-2">${optionsHtml}</div>
                                <div class="quiz-feedback hidden mt-4"></div>
                            </div>
                        `;
                        quizContainer.insertAdjacentHTML('beforeend', questionHtml);
                    });

                    quizContainer.addEventListener('click', handleOptionSelect);
                };

                const handleOptionSelect = (e) => {
                    if (!e.target.matches('.quiz-option')) return;
                    
                    const questionIndex = parseInt(e.target.dataset.question);
                    const optionIndex = parseInt(e.target.dataset.option);
                    const questionData = quizQuestions[questionIndex];
                    const questionContainer = domainContainer.querySelector(`#question-${questionIndex}`);

                    // Store answer
                    userAnswers[questionIndex] = optionIndex;

                    // Update UI
                    questionContainer.querySelectorAll('.quiz-option').forEach(btn => btn.classList.remove('selected'));
                    e.target.classList.add('selected');

                    // Check if all questions are answered
                    if (Object.keys(userAnswers).length === quizQuestions.length) {
                        showResults();
                    }
                };
                
                const showResults = () => {
                    let score = 0;
                    quizQuestions.forEach((q, index) => {
                        const questionContainer = domainContainer.querySelector(`#question-${index}`);
                        const feedbackContainer = questionContainer.querySelector('.quiz-feedback');
                        const userAnswer = userAnswers[index];
                        const isCorrect = userAnswer === q.answer;

                        feedbackContainer.classList.remove('hidden', 'correct', 'incorrect');
                        if (isCorrect) {
                            score++;
                            feedbackContainer.classList.add('correct');
                            feedbackContainer.innerHTML = `<strong>Correct!</strong>`;
                        } else {
                            feedbackContainer.classList.add('incorrect');
                            feedbackContainer.innerHTML = `
                                <strong>Incorrect.</strong> The correct answer is ${String.fromCharCode(65 + q.answer)}.
                                <p class="quiz-explanation">${q.explanation}</p>
                            `;
                        }
                    });
                    
                    const quizResultsContainer = domainContainer.querySelector('#quiz-results');
                    quizResultsContainer.querySelector('#quiz-score').textContent = `Your Score: ${score} out of ${quizQuestions.length}`;
                    quizResultsContainer.querySelector('#quiz-summary').textContent = `You have completed the assessment. Review the explanations for any incorrect answers.`;
                    quizResultsContainer.classList.remove('hidden');
                    quizResultsContainer.scrollIntoView({ behavior: 'smooth' });

                    domainContainer.querySelector('#quiz-container').removeEventListener('click', handleOptionSelect);
                };

                renderQuiz();
                domainContainer.querySelector('#retake-quiz-btn')?.addEventListener('click', renderQuiz);
            }

            // --- Generic Handlers for the current domain ---
            const navButtons = domainContainer.querySelectorAll('.domain-nav-item');
            const sections = domainContainer.querySelectorAll('.content-section');
            
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    const targetId = button.dataset.target;
                    sections.forEach(section => {
                        section.classList.toggle('hidden', section.id !== targetId);
                        section.classList.toggle('fade-in', section.id === targetId);
                    });
                });
            });
            const introButton = domainContainer.querySelector('.domain-nav-item[data-target^="introduction"]');
            if (introButton) introButton.click();

            domainContainer.querySelectorAll('.accordion-button').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('.accordion-icon');
                    content.classList.toggle('hidden');
                    if (icon) icon.textContent = content.classList.contains('hidden') ? '+' : 'â€“';
                });
            });

            domainContainer.querySelectorAll('[data-group]').forEach(groupContainer => {
                groupContainer.addEventListener('click', (e) => {
                    const card = e.target.closest('.interactive-card, .concept-card, .key-term-card, .change-management-card, .legal-type-card, .contract-type-card, .governance-structure-card, .risk-appetite-card, .business-driver-card, .framework-step-node, .maturity-level-card, .risk-framework-card, .risk-response-card, .risk-method-card, .vulnerability-scenario-card, .role-node, .incident-lifecycle-node');
                    if (!card) return;

                    const wasActive = card.classList.contains('active');
                    
                    // Deactivate all cards in the same group
                    groupContainer.querySelectorAll('.interactive-card, .concept-card, .key-term-card, .change-management-card, .legal-type-card, .contract-type-card, .governance-structure-card, .risk-appetite-card, .business-driver-card, .framework-step-node, .maturity-level-card, .risk-framework-card, .risk-response-card, .risk-method-card, .vulnerability-scenario-card, .role-node, .incident-lifecycle-node').forEach(c => {
                        c.classList.remove('active');
                    });

                    if (!wasActive) {
                        card.classList.add('active');
                    }
                });
            });
            
            domainContainer.dataset.initialized = 'true';
        }

        // --- Initial Setup ---
        const initialDomain = document.getElementById('about-cism');
        if (initialDomain) {
            setupDomain(initialDomain);
        }
    });
    </script>
</body>
</html>
