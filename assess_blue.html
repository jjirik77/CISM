<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CISM 2024: Assessment Interactive - Designer Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Global Styles & Font Import */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

        :root {
            --dark-navy-bg: #0a101f;
            --surface-color: #10192b;
            --accent-glow: #00bfff; /* Deep Sky Blue */
            --accent-hover: #ffffff;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --border-color: #2d3748;
            --shadow-color: rgba(0, 191, 255, 0.1);
            --success-bg: rgba(40, 167, 69, 0.1);
            --success-border: #28a745;
            --danger-bg: rgba(220, 53, 69, 0.1);
            --danger-border: #dc3545;
            --transition-fast: all 0.3s ease-in-out;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--dark-navy-bg);
            color: var(--text-primary);
            line-height: 1.6;
        }
        
        /* Main container */
        .container {
            max-width: 1400px;
        }

        /* Header */
        header {
            background: linear-gradient(180deg, var(--surface-color), var(--dark-navy-bg));
            border-bottom: 1px solid var(--border-color);
        }
        
        /* Main Content Area */
        #assessment-container {
            background-color: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        /* Tabs for Domain Selection */
        .assessment-tab {
            border: 2px solid transparent;
            border-radius: 0.5rem;
            transition: var(--transition-fast);
            position: relative;
            overflow: hidden;
        }
        .assessment-tab:not(.active):hover {
            border-color: var(--accent-glow);
            background-color: rgba(0, 191, 255, 0.05);
        }
        .assessment-tab.active {
            background-color: var(--accent-glow);
            color: var(--dark-navy-bg);
            font-weight: 700;
            box-shadow: 0 0 20px var(--shadow-color);
        }

        /* Fade-in Animation */
        .fade-in {
            animation: fadeIn 0.6s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards for Quiz Options */
        .assessment-card {
            background: rgba(10, 16, 31, 0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            transition: var(--transition-fast);
        }
        .assessment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            border-color: var(--accent-glow);
        }

        /* Buttons */
        .btn {
            display: inline-block;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: var(--transition-fast);
            cursor: pointer;
            text-decoration: none;
            border: none;
        }
        .btn-primary {
            background-color: var(--accent-glow);
            color: var(--dark-navy-bg);
            box-shadow: 0 0 15px var(--shadow-color);
        }
        .btn-primary:hover {
            background-color: var(--accent-hover);
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.3);
        }
        .btn-secondary {
            background-color: var(--border-color);
            color: var(--text-primary);
        }
        .btn-secondary:hover {
            background-color: #4a5568;
        }
        .btn-danger {
            background-color: var(--danger-border);
            color: white;
        }
        .btn-danger:hover {
            background-color: #c82333;
        }

        /* Answer Options in Quiz */
        .answer-option {
            border: 2px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            cursor: pointer;
            transition: var(--transition-fast);
        }
        .answer-option:hover {
            border-color: var(--accent-glow);
            background-color: rgba(0, 191, 255, 0.1);
        }
        .answer-option.selected {
            background-color: rgba(0, 191, 255, 0.2);
            border-color: var(--accent-glow);
            color: var(--accent-glow);
        }
        .answer-option.correct {
            background-color: var(--success-bg);
            border-color: var(--success-border);
            color: #81c784;
        }
        .answer-option.incorrect {
            background-color: var(--danger-bg);
            border-color: var(--danger-border);
            color: #e57373;
        }

        /* Progress Bar */
        .progress-bar-container {
            background-color: var(--dark-navy-bg);
            border-radius: 9999px;
            height: 12px;
            width: 100%;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        .progress-bar {
            background: linear-gradient(90deg, #00bfff, #1e90ff);
            height: 100%;
            transition: width 0.4s ease-in-out;
            box-shadow: 0 0 10px var(--accent-glow);
        }

        /* Modal styling */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: var(--surface-color);
            padding: 2.5rem;
            border-radius: 0.75rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 35px rgba(0, 0, 0, 0.5);
            text-align: center;
            max-width: 450px;
            width: 90%;
        }

        /* Custom Number Input */
        .custom-number-input {
            width: 80px;
            padding: 0.5rem;
            border-radius: 0.375rem;
            background-color: var(--dark-navy-bg);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            text-align: center;
            font-size: 1.25rem;
            font-weight: bold;
        }
        .custom-number-input:focus {
            outline: none;
            border-color: var(--accent-glow);
            box-shadow: 0 0 10px var(--shadow-color);
        }
        
        /* Results Breakdown Styling */
        #results-breakdown .breakdown-item {
            background-color: var(--dark-navy-bg);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
    </style>
</head>
<body class="leading-relaxed">
    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center py-10 mb-8">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-white mb-2 tracking-tighter">CISM Assessment Center</h1>
            <p class="text-xl sm:text-2xl text-gray-400">Test Your Knowledge and Prepare for the Exam</p>
        </header>

        <main id="assessment-container" class="p-4 sm:p-6 lg:p-8">
            <!-- Assessment Setup View -->
            <div id="assessment-setup">
                <nav class="p-2 rounded-lg mb-8 flex flex-wrap justify-center sticky top-0 z-10 gap-2 sm:gap-4 bg-black/20 backdrop-blur-sm border border-gray-700/50">
                    <button class="assessment-tab px-4 py-2 text-lg font-medium text-gray-300 active" data-target="domain-1">Domain 1</button>
                    <button class="assessment-tab px-4 py-2 text-lg font-medium text-gray-300" data-target="domain-2">Domain 2</button>
                    <button class="assessment-tab px-4 py-2 text-lg font-medium text-gray-300" data-target="domain-3">Domain 3</button>
                    <button class="assessment-tab px-4 py-2 text-lg font-medium text-gray-300" data-target="domain-4">Domain 4</button>
                    <button class="assessment-tab px-4 py-2 text-lg font-medium text-gray-300" data-target="simulated-exam">Simulated Exam</button>
                </nav>
                <div id="assessment-options-area" class="fade-in"></div>
            </div>

            <!-- Assessment In-Progress View -->
            <div id="assessment-in-progress" class="hidden">
                <div class="p-6 sm:p-8 rounded-lg">
                    <div class="flex justify-between items-center mb-6">
                        <h2 id="question-counter" class="text-xl font-bold text-gray-200"></h2>
                        <div id="timer-display" class="text-xl font-bold text-accent-glow hidden">4:00:00</div>
                        <button id="quit-assessment-btn" class="btn btn-secondary text-sm px-3 py-1">Quit</button>
                    </div>
                    <div class="progress-bar-container mb-8">
                        <div id="progress-bar" class="progress-bar" style="width: 0%;"></div>
                    </div>
                    <p id="question-text" class="text-xl text-gray-300 mb-8 leading-relaxed"></p>
                    <div id="answer-options" class="space-y-4"></div>
                    <div class="flex justify-between mt-10">
                        <button id="prev-question-btn" class="btn btn-secondary">Previous</button>
                        <button id="next-question-btn" class="btn btn-primary">Next</button>
                        <button id="submit-assessment-btn" class="btn btn-primary hidden">Submit Assessment</button>
                    </div>
                </div>
            </div>

            <!-- Assessment Results View -->
            <div id="assessment-results" class="hidden">
                <div class="p-6 sm:p-8 rounded-lg text-center">
                    <h2 class="text-4xl font-bold text-white mb-4 inline-block">Assessment Complete!</h2>
                    <p class="text-xl text-gray-400 mb-4">Here's how you did:</p>
                    <p id="final-score" class="text-7xl font-extrabold text-accent-glow my-6"></p>
                    <p id="score-details" class="text-lg text-gray-300 mb-8"></p>
                    <div id="results-breakdown" class="mb-10 text-left max-w-lg mx-auto space-y-3"></div>
                    <div class="flex justify-center gap-4">
                        <button id="review-answers-btn" class="btn btn-secondary">Review Answers</button>
                        <button id="restart-assessment-btn" class="btn btn-primary">Try Again</button>
                    </div>
                </div>
            </div>
            
            <!-- Assessment Review View -->
            <div id="assessment-review" class="hidden"></div>
        </main>

        <footer class="text-center py-6 mt-8 text-gray-500 text-sm">
            <p>&copy; 2024 CISM Study Guide. All rights reserved. For educational purposes only.</p>
        </footer>
    </div>

    <!-- Modals -->
    <div id="quit-modal" class="modal-overlay hidden">
        <div class="modal-content fade-in">
            <h3 class="text-2xl font-bold mb-4 text-white">Are you sure?</h3>
            <p class="text-gray-400 mb-8">Your progress on this assessment will be lost.</p>
            <div class="flex justify-center gap-4">
                <button id="cancel-quit-btn" class="btn btn-secondary">Cancel</button>
                <button id="confirm-quit-btn" class="btn btn-danger">Yes, Quit</button>
            </div>
        </div>
    </div>
    <div id="alert-modal" class="modal-overlay hidden">
        <div class="modal-content fade-in">
            <h3 class="text-2xl font-bold mb-4 text-white">Invalid Input</h3>
            <p id="alert-message" class="text-gray-400 mb-8"></p>
            <div class="flex justify-center">
                <button id="confirm-alert-btn" class="btn btn-primary">OK</button>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- DATA ---
        const questionBank = {
            'domain-1': [
                { question: "What is the primary goal of information security governance?", answers: ["To reduce the cost of security controls", "To ensure that security strategies are aligned with business objectives", "To implement the latest security technologies", "To achieve 100% compliance with all regulations"], correct: 1, explanation: "The primary goal of information security governance is to align security efforts with the strategic goals of the business, ensuring that security is an enabler, not a hindrance." },
                { question: "Which of the following is a key outcome of a mature security governance framework?", answers: ["Increased IT budget", "Risk optimization", "Elimination of all security incidents", "Shorter product development cycles"], correct: 1, explanation: "A mature governance framework enables the organization to make informed decisions to optimize risk, balancing the cost of controls with the potential impact of threats to achieve business objectives." },
                { question: "Who is ultimately responsible for information security within an organization?", answers: ["The CISO", "The IT department", "The Board of Directors / Senior Management", "All employees"], correct: 2, explanation: "While the CISO manages the program and employees have a role, the ultimate responsibility and accountability for information security lie with the highest levels of leadership, such as the Board of Directors and senior management." },
                { question: "A strategic alignment of security with business objectives is BEST achieved through:", answers: ["Implementing a SIEM", "Developing a comprehensive information security governance framework", "Hiring more security analysts", "Conducting annual penetration tests"], correct: 1, explanation: "A governance framework provides the structure, policies, and processes to ensure that security activities directly support and align with the broader goals of the business." },
                { question: "What is the MOST important objective of creating a business case for a security investment?", answers: ["To guarantee the project gets approved", "To demonstrate the ROI and value to the business", "To list all technical features of a proposed solution", "To satisfy an audit requirement"], correct: 1, explanation: "The primary purpose of a business case is to articulate the value proposition in business terms, often by showing a positive Return on Investment (ROI) or other quantifiable benefits, to secure funding and support from management." },
                { question: "Which of the following is an example of a detective control?", answers: ["Firewall", "Encryption", "Security awareness training", "Log file monitoring"], correct: 3, explanation: "Detective controls are designed to identify and report that an incident has occurred. Log file monitoring actively searches for signs of intrusion or policy violations after they have happened." },
                { question: "The process of identifying, classifying, and prioritizing information assets is a foundational step for:", answers: ["Network segmentation", "Effective risk management", "Choosing an antivirus vendor", "Writing a press release"], correct: 1, explanation: "An organization cannot effectively protect what it does not know it has. Identifying and understanding the value of its information assets is the first step in applying appropriate risk management and protection." },
                { question: "An organization's risk appetite is BEST defined as:", answers: ["The amount of loss experienced in a year", "The budget allocated for security controls", "The amount of risk the organization is willing to accept to achieve its objectives", "The number of open vulnerabilities on a scan report"], correct: 2, explanation: "Risk appetite is a high-level, strategic statement from senior management that defines the level of risk the organization is willing to pursue or tolerate in its activities." },
                { question: "Which role is responsible for classifying data and determining appropriate access controls?", answers: ["Data custodian", "Data user", "Data owner", "Data processor"], correct: 2, explanation: "The data owner, typically a senior business manager, is accountable for the data and is responsible for making key decisions about its classification and protection, including who is authorized to access it." },
                { question: "The PRIMARY benefit of a well-defined information security architecture is:", answers: ["It allows for faster software development", "It reduces the need for user training", "It ensures consistent and cost-effective implementation of security controls", "It guarantees compliance with all international laws"], correct: 2, explanation: "A security architecture provides a blueprint for how controls are designed and integrated, which leads to consistency, avoids redundant or conflicting controls, and ensures that security is implemented in a cost-effective manner that aligns with the overall strategy." },
                { question: "What is the purpose of an information security steering committee?", answers: ["To perform daily security operations", "To provide senior management oversight and guidance for the security program", "To develop and test new security software", "To conduct forensic investigations after a breach"], correct: 1, explanation: "The steering committee, composed of senior leaders from across the business, ensures the security program has resources, authority, and is aligned with business goals." },
                { question: "Which of the following BEST describes the concept of 'due care'?", answers: ["Following laws and regulations", "Taking the reasonable steps to protect assets that a prudent person would", "Purchasing cybersecurity insurance", "Implementing the most expensive security controls"], correct: 1, explanation: "Due care is the operational aspect of due diligence. It's about taking the necessary, reasonable actions to protect the organization's assets." },
                { question: "An information security policy is an example of which type of control?", answers: ["Physical", "Technical", "Administrative", "Corrective"], correct: 2, explanation: "Policies, standards, procedures, and guidelines are all forms of administrative (or managerial) controls that direct human behavior." },
                { question: "Which of the following is the MOST important factor for the success of an information security program?", answers: ["The size of the security budget", "The number of security certifications held by staff", "The visible support of senior management", "The complexity of the implemented technology"], correct: 2, explanation: "Without clear and visible support from the top, a security program will struggle to get the funding, resources, and organizational buy-in needed to be effective." },
                { question: "The primary output of the security governance process should be:", answers: ["A list of approved software", "A set of detailed technical configurations", "A security strategy that supports business objectives", "A daily report of security alerts"], correct: 2, explanation: "Governance is about strategy. Its main output is a high-level security strategy that is integrated with the business's overall strategy." },
                { question: "What is the BEST way to ensure a new business acquisition is integrated securely?", answers: ["Isolate the new company's network permanently", "Force the new company to adopt all existing security policies immediately", "Perform a security due diligence review as part of the acquisition process", "Wait until after the acquisition is complete to assess security risks"], correct: 2, explanation: "Security due diligence should be part of the M&A process to identify risks early, understand the security posture of the acquired entity, and plan for integration." },
                { question: "A set of specific, mandatory rules for technology use is known as a:", answers: ["Policy", "Guideline", "Standard", "Procedure"], correct: 2, explanation: "Standards are compulsory and provide specific details on what is required to support a policy. For example, a policy might require encryption, while a standard specifies AES-256 as the required algorithm." },
                { question: "Which of the following metrics would be MOST useful for a Board of Directors?", answers: ["Number of firewall rules updated last week", "Percentage of systems patched within 30 days", "Trend of key risk indicators (KRIs) over time", "CPU utilization on the SIEM server"], correct: 2, explanation: "The Board is concerned with high-level risk. KRIs that are tied to business impact and show trends over time provide the strategic insight they need, unlike operational or technical metrics." },
                { question: "The main reason for data classification is to:", answers: ["Determine the level of security controls required to protect the data", "Make data easier to find for employees", "Comply with data storage size limits", "Track the age of data"], correct: 0, explanation: "Data classification is the process of categorizing data based on its sensitivity and criticality to determine the appropriate level of protection it needs." },
                { question: "Which of the following is a governance function?", answers: ["Configuring a firewall", "Resetting a user's password", "Prioritizing security investments", "Analyzing malware"], correct: 2, explanation: "Governance deals with strategic decisions, such as allocating resources and prioritizing investments, to ensure alignment with business goals. The other options are operational tasks." },
                { question: "What is 'due diligence' in the context of information security?", answers: ["The act of investigating and understanding risks before committing to a course of action", "The day-to-day maintenance of security controls", "A type of security audit", "A legal requirement to report all breaches within 24 hours"], correct: 0, explanation: "Due diligence is the research and investigation part of risk management, ensuring that decisions are informed and prudent. Due care is the implementation of those decisions." },
                { question: "The purpose of a security charter is to:", answers: ["List all security controls in the organization", "Grant authority and state the mission and scope of the information security program", "Define the steps for responding to a security incident", "Provide a tutorial on how to use security software"], correct: 1, explanation: "A security charter is a high-level document from senior management that formally establishes the security program and gives the CISO the authority to run it." },
                { question: "Which of the following provides the BEST framework for enterprise IT governance?", answers: ["ISO 27001", "NIST Cybersecurity Framework", "COBIT", "ITIL"], correct: 2, explanation: "While the others are excellent security frameworks, COBIT is specifically designed as a comprehensive framework for the governance and management of enterprise IT." },
                { question: "A key principle of information security governance is:", answers: ["Technology-driven decision making", "Accountability", "Decentralized control", "Profit maximization"], correct: 1, explanation: "A core tenet of any governance system is establishing clear accountability, ensuring that someone is ultimately answerable for the outcomes of the security program." },
                { question: "When developing security policies, it is MOST important that they are:", answers: ["As technically detailed as possible", "Enforceable", "Written by the legal department", "Published on the company's external website"], correct: 1, explanation: "A policy that cannot be enforced is useless. Policies must be practical, and the organization must have the will and the means to ensure compliance." },
                { question: "What is the primary risk of not having an effective security governance structure?", answers: ["The security budget will be too high", "Security efforts may be misaligned with business objectives", "The company will not be able to hire qualified security staff", "Too many security audits will be required"], correct: 1, explanation: "Without governance, the security program can become a purely technical function, disconnected from business needs, leading to wasted resources and inadequate protection of key assets." },
                { question: "Which of the following is the BEST example of a preventive administrative control?", answers: ["An intrusion detection system (IDS)", "A firewall", "Security awareness training", "A data backup"], correct: 2, explanation: "Security awareness training is administrative (people-focused) and preventive because it aims to stop security incidents from happening by teaching good behavior." },
                { question: "The relationship between a policy, a standard, and a guideline is:", answers: ["They are all mandatory", "A standard and guideline implement a policy", "A policy implements a standard", "A guideline is mandatory, but a standard is optional"], correct: 1, explanation: "Policies are high-level statements. Standards are mandatory rules that support policies. Guidelines are recommended, non-mandatory best practices." },
                { question: "Who should be the primary audience for a set of security metrics on program effectiveness?", answers: ["External auditors", "End users", "Senior management", "The incident response team"], correct: 2, explanation: "Metrics on program effectiveness are used to justify the program's existence and value, making senior management the most important audience for this information." },
                { question: "An organization's culture is a key factor in the success of its security program. This is PRIMARILY because:", answers: ["A strong security culture can reduce the need for technical controls", "The culture influences employee behavior and compliance with policies", "A weak culture makes it hard to get budget for security tools", "Auditors give higher scores to companies with good security cultures"], correct: 1, explanation: "Culture shapes how people act when no one is watching. A strong security culture means employees are more likely to make secure choices naturally, reinforcing the entire program." }
            ],
            'domain-2': [
                { question: "What is the formula for calculating Annualized Loss Expectancy (ALE)?", answers: ["SLE / ARO", "AV * EF", "SLE * ARO", "AV - SLE"], correct: 2, explanation: "ALE is calculated by multiplying the Single Loss Expectancy (SLE) by the Annualized Rate of Occurrence (ARO). It represents the expected monetary loss for an asset over a one-year period." },
                { question: "Which risk response strategy involves purchasing cybersecurity insurance?", answers: ["Mitigation", "Avoidance", "Acceptance", "Transfer"], correct: 3, explanation: "Purchasing insurance is a form of risk transfer, where the financial impact of a potential security incident is shifted to a third party (the insurance company)." },
                { question: "A risk assessment identifies a vulnerability with a high impact but a very low likelihood. What is this an example of?", answers: ["Inherent risk", "Residual risk", "A risk that should always be avoided", "A candidate for risk acceptance"], correct: 0, explanation: "Inherent risk is the risk level before any controls are applied. The initial assessment of impact and likelihood defines the inherent risk." },
                { question: "The main purpose of a threat assessment is to:", answers: ["Identify all vulnerabilities in a system", "Determine the effectiveness of existing controls", "Identify and evaluate potential adversaries and their methods", "Calculate the Annualized Loss Expectancy (ALE)"], correct: 2, explanation: "A threat assessment focuses specifically on identifying the sources of threats (e.g., hackers, insiders, nature) and the methods they might use to cause harm to the organization's assets." },
                { question: "In a quantitative risk analysis, what does the Exposure Factor (EF) represent?", answers: ["The number of times an event is expected to occur in a year", "The total value of the asset", "The percentage of loss a realized threat would have on an asset", "The cost of the security control to be implemented"], correct: 2, explanation: "The Exposure Factor (EF) is a measure of the potential damage from a specific threat, expressed as a percentage of the asset's value. For example, if a fire would destroy 50% of a data center, the EF is 50%." },
                { question: "What is residual risk?", answers: ["The risk before any controls are applied", "The risk that is transferred to another party", "The risk that remains after management has implemented controls", "The risk that has been identified but not yet assessed"], correct: 2, explanation: "Residual risk is the level of risk that is left over after security controls and other mitigation strategies have been applied. It's the risk that the organization accepts as a cost of doing business." },
                { question: "Which of the following is the BEST reason for a company to formally accept a risk?", answers: ["The security team does not know how to fix it", "The cost of mitigating the risk is greater than the potential impact", "The risk was identified by a junior analyst", "Management is not concerned about security"], correct: 1, explanation: "Risk acceptance is a valid business decision when the cost of the countermeasure (the control) is more expensive than the potential loss from the risk itself. It must be a formal, documented decision by management." },
                { question: "A key benefit of using a standardized risk management framework like NIST SP 800-30 is that it:", answers: ["Guarantees the organization will not have a security breach", "Provides a structured and repeatable process for assessing risk", "Eliminates the need for security expertise", "Is the only framework accepted by auditors"], correct: 1, explanation: "Standardized frameworks provide a consistent methodology and vocabulary for risk management, which makes the process structured, repeatable, and easier to communicate across the organization." },
                { question: "The difference between a vulnerability and a threat is that:", answers: ["A threat is a weakness, and a vulnerability is the actor that exploits it", "A vulnerability is a weakness, and a threat is the actor or event that could exploit it", "They are the same thing", "A vulnerability is caused by a threat"], correct: 1, explanation: "A vulnerability is an internal weakness or flaw in a system or process. A threat is an external entity or event (like a hacker or a natural disaster) that has the potential to exploit that vulnerability." },
                { question: "When developing risk scenarios, the MOST important factor to consider is:", answers: ["The technical complexity of the attack", "The likelihood of a zero-day exploit being used", "The potential business impact", "The cost of the asset being targeted"], correct: 2, explanation: "While all factors are relevant, risk management is primarily concerned with protecting the business. Therefore, understanding the potential business impact of a risk scenario is the most critical factor for prioritization and decision-making." },
                { question: "A qualitative risk assessment uses:", answers: ["Monetary values", "Descriptive scales like High, Medium, and Low", "Complex mathematical formulas", "Historical incident data only"], correct: 1, explanation: "Qualitative risk assessment relies on subjective judgment and descriptive scales to rate the likelihood and impact of risks, making it faster but less precise than quantitative analysis." },
                { question: "The value of a control is BEST determined by:", answers: ["How much it cost to purchase", "How much it reduces risk", "How popular the control is in the industry", "How easy it is to implement"], correct: 1, explanation: "The purpose of a control is to mitigate risk. Therefore, its value is measured by how effectively it reduces the likelihood or impact of a risk, bringing the residual risk to an acceptable level." },
                { question: "Which of the following is an example of risk avoidance?", answers: ["Implementing a firewall to block malicious traffic", "Buying insurance to cover losses from a data breach", "Deciding not to launch a new online service in a high-risk country", "Accepting the findings of a penetration test without taking action"], correct: 2, explanation: "Risk avoidance means ceasing or deciding not to start an activity that would introduce the risk. In this case, the organization avoids the risk by not conducting business in that environment." },
                { question: "A risk register is BEST described as:", answers: ["A list of all organizational assets", "A document detailing the company's insurance policies", "A centralized document for tracking and monitoring identified risks", "A log of all security incidents"], correct: 2, explanation: "The risk register is a key tool in risk management used to document details about each identified risk, including its description, impact, likelihood, owner, and current status." },
                { question: "The Single Loss Expectancy (SLE) for a server valued at $50,000, where a power surge would destroy 25% of its components, is:", answers: ["$50,000", "$12,500", "$25,000", "$1,250"], correct: 1, explanation: "SLE is calculated as Asset Value (AV) * Exposure Factor (EF). In this case, $50,000 * 0.25 = $12,500." },
                { question: "What is the primary purpose of a control gap analysis?", answers: ["To identify missing or inadequately implemented security controls", "To calculate the ROI of the security program", "To choose a new security vendor", "To satisfy all legal requirements"], correct: 0, explanation: "A control gap analysis compares the existing set of controls against a desired state (e.g., a security framework like ISO 27001) to identify where gaps in protection exist." },
                { question: "Threat modeling is typically performed during which phase of a system's life cycle?", answers: ["Retirement", "Operations and Maintenance", "Design and Development", "Disposal"], correct: 2, explanation: "Threat modeling is most effective and cost-efficient when performed early in the SDLC, during the design phase, so that security can be built in, not bolted on." },
                { question: "An organization decides to continue using an old legacy system because the cost to replace it is too high. This is an example of:", answers: ["Risk transfer", "Risk mitigation", "Risk avoidance", "Risk acceptance"], correct: 3, explanation: "By acknowledging the risks associated with the legacy system but choosing not to replace it (the control), management is formally or informally accepting those risks." },
                { question: "Which of the following is a primary input to the risk management process?", answers: ["The results of the latest security audit", "The organization's business objectives", "The number of active security incidents", "The security team's budget"], correct: 1, explanation: "Risk management cannot be done in a vacuum. It must be informed by the organization's strategic goals and objectives to ensure that it protects what is most important to the business." },
                { "question": "The Annualized Rate of Occurrence (ARO) is defined as:", "answers": ["The total financial loss from a single event", "The time it takes to recover from an event", "The estimated frequency at which a threat is expected to occur in a year", "The percentage of an asset's value lost in an event"], "correct": 2, "explanation": "ARO is a key component of quantitative risk analysis that estimates how many times a specific threat event is likely to happen over a one-year period." },
                { "question": "Which of the following is the MOST significant challenge in quantitative risk analysis?", "answers": ["It is too fast to be thorough", "It requires complex software", "Assigning credible monetary values to assets and impacts can be difficult", "It does not consider the likelihood of a threat"], "correct": 2, "explanation": "The primary difficulty in quantitative risk analysis is the subjectivity and challenge involved in accurately assigning dollar values to intangible assets (like reputation) and potential impacts." },
                { "question": "A countermeasure is another term for a:", "answers": ["Threat", "Vulnerability", "Risk", "Control"], "correct": 3, "explanation": "A countermeasure, safeguard, or control are all terms for the actions, devices, or procedures used to reduce risk by mitigating threats and vulnerabilities." },
                { "question": "The process of identifying the assets, threats, and vulnerabilities that make up an organization's IT environment is known as:", "answers": ["Risk identification", "Risk calculation", "Risk transfer", "Risk monitoring"], "correct": 0, "explanation": "Risk identification is the first phase of the risk management lifecycle and involves creating an inventory of risks that could affect the organization." },
                { "question": "A supply chain risk assessment would be MOST concerned with:", "answers": ["The security posture of third-party vendors and suppliers", "The physical security of the organization's main office", "The patching level of internal employee workstations", "The company's social media policy"], "correct": 0, "explanation": "Supply chain risk management focuses on identifying and mitigating risks that arise from dependencies on external entities, such as suppliers, vendors, and partners." },
                { "question": "What is the primary goal of risk treatment?", "answers": ["To identify all possible risks", "To modify risk to a level that is acceptable to management", "To create a complete list of all organizational assets", "To purchase insurance for all identified risks"], "correct": 1, "explanation": "Risk treatment (or risk response) is the process of selecting and implementing controls to modify the identified risks to align with the organization's risk appetite." },
                { "question": "A vulnerability scan report shows 500 open vulnerabilities. What is the BEST next step for the information security manager?", "answers": ["Immediately patch all 500 vulnerabilities", "Accept all the risks identified in the report", "Prioritize the vulnerabilities based on business impact and exploitability", "Purchase a new vulnerability scanner"], "correct": 2, "explanation": "It is rarely feasible to fix everything at once. The most effective approach is to prioritize remediation efforts based on the actual risk each vulnerability poses to the business." },
                { "question": "The term 'threat actor' refers to:", "answers": ["A type of security software", "A weakness in a computer system", "The person or entity that initiates a threat", "A security control"], "correct": 2, "explanation": "A threat actor (or threat agent) is the character who carries out the threat, such as a disgruntled employee, a cybercriminal group, or a nation-state." },
                { "question": "Which of the following is an example of a qualitative risk impact?", "answers": ["A loss of $1 million in sales", "A 20% reduction in stock price", "Damage to the organization's reputation", "A fine of $500,000 from a regulator"], "correct": 2, "explanation": "Reputational damage is an intangible impact that is difficult to measure in precise monetary terms, making it a qualitative assessment. The other options are quantitative." },
                { "question": "Risk aggregation is the process of:", "answers": ["Combining multiple smaller risks into a consolidated view to understand the overall risk posture", "Assigning a single risk to each business unit", "Ignoring small risks to focus on larger ones", "Transferring all risks to a single third party"], "correct": 0, "explanation": "Risk aggregation provides a 'big picture' view by rolling up individual risks to understand the organization's cumulative risk exposure, which might be greater than the sum of its parts." },
                { "question": "A control's effectiveness is a measure of:", "answers": ["How much the control cost", "How well the control reduces risk", "How many people are needed to manage the control", "The age of the control"], "correct": 1, "explanation": "The effectiveness of a control is determined by its ability to perform its intended functionâ€”reducing the likelihood and/or impact of a specific risk." }
            ],
            'domain-3': [
                { question: "What is the primary purpose of a Security Operations Center (SOC)?", answers: ["To develop security policies", "To conduct security awareness training", "To monitor, detect, analyze, and respond to cybersecurity incidents", "To manage the security budget"], correct: 2, explanation: "A SOC is a centralized unit that deals with security issues on an organizational and technical level, focusing on the real-time monitoring and handling of security incidents." },
                { question: "Which of the following is a key component of an Incident Response Plan (IRP)?", answers: ["A list of all company assets", "The marketing department's contact list", "Communication protocols for stakeholders", "The company's mission statement"], correct: 2, explanation: "A critical part of any IRP is defining clear communication protocols to ensure that all relevant stakeholders (internal and external) are informed appropriately during an incident." },
                { question: "The main goal of a security awareness program is to:", answers: ["Ensure everyone in IT is a security expert", "Fulfill a compliance requirement", "Influence user behavior to reduce security risk", "Teach users how to write secure code"], correct: 2, explanation: "While compliance is a benefit, the primary goal is to change how users think about and act on security, making them a strong first line of defense and reducing human-related risks like falling for phishing scams." },
                { question: "Which of the following is the BEST metric to measure the effectiveness of a security awareness program?", answers: ["The number of people who completed the training", "The cost of the training program", "A reduction in successful phishing attacks or increase in reporting", "Positive feedback from employees about the training"], correct: 2, explanation: "The ultimate goal is behavior change that reduces risk. A decrease in successful phishing attacks or an increase in users correctly reporting suspicious emails is a direct measure of the program's impact on reducing risk." },
                { question: "What is the primary purpose of patch management?", answers: ["To add new features to software", "To reduce the attack surface by remediating known vulnerabilities", "To ensure all software is from the same vendor", "To monitor system performance"], correct: 1, explanation: "Patch management is a critical security process focused on identifying, testing, and deploying software updates (patches) to fix vulnerabilities that could otherwise be exploited by attackers." },
                { question: "In the context of identity and access management, the principle of 'least privilege' means:", answers: ["All users should have administrator rights", "Users should only be granted the minimum level of access necessary to perform their job functions", "Access should be granted based on seniority", "Users can choose their own access rights"], correct: 1, explanation: "Least privilege is a foundational security principle that limits user access rights to the bare minimum permissions they need to do their job. This minimizes the damage that can be done if an account is compromised." },
                { question: "What is the function of a Security Information and Event Management (SIEM) system?", answers: ["To automatically block all incoming network traffic", "To manage user passwords and access credentials", "To aggregate and analyze log data from multiple sources to identify security threats", "To encrypt all data on the network"], correct: 2, explanation: "A SIEM system is a powerful tool that collects security-related data from across the IT environment (e.g., firewalls, servers, applications) and uses correlation and analysis to detect potential threats and facilitate incident response." },
                { question: "When an organization outsources a service to a third-party vendor, who is ultimately accountable for the security of the data?", answers: ["The third-party vendor", "The organization", "The cloud provider", "The end users"], correct: 1, explanation: "An organization can delegate responsibility for security tasks, but it cannot outsource accountability. The organization that owns the data is always ultimately accountable for its protection, regardless of where it is stored or processed." },
                { question: "The purpose of performing a gap analysis against a security framework like ISO 27001 is to:", answers: ["Identify all potential threats to the organization", "Determine the difference between the current state of security controls and the framework's requirements", "Calculate the ROI of the security program", "Choose which vendor to purchase security tools from"], correct: 1, explanation: "A gap analysis is a formal review that compares an organization's existing security posture and controls against the requirements of a specific framework or standard to identify areas that are missing or need improvement." },
                { question: "Which of the following is the MOST secure method for multi-factor authentication (MFA)?", answers: ["Email-based one-time password", "SMS-based one-time password", "A push notification to a mobile app", "A FIDO2-compliant hardware security key"], correct: 3, explanation: "Hardware security keys (like a YubiKey) are considered the gold standard for MFA because they are resistant to phishing and man-in-the-middle attacks, unlike SMS or email, which can be intercepted." },
                { question: "A security architecture provides a 'blueprint' for:", answers: ["The physical layout of the data center", "The reporting structure of the security team", "The consistent and coordinated deployment of security controls", "The company's annual financial report"], correct: 2, explanation: "A security architecture is a conceptual design that defines how security controls are positioned and related to each other to protect the organization's assets in a coherent way." },
                { question: "The process of periodically reviewing user access rights to ensure they are still appropriate is called:", answers: ["Access logging", "Identity proofing", "Access recertification or review", "Password rotation"], correct: 2, explanation: "Access recertification is a critical administrative control where a user's manager or data owner periodically reviews and re-approves their access rights, preventing 'privilege creep'." },
                { question: "Which of the following is the BEST way to manage the security of a new cloud-based application?", answers: ["Trust the cloud provider to handle all security", "Apply the same security controls used for on-premise applications without modification", "Perform a risk assessment and tailor controls to the cloud environment", "Block all access to the application until it can be moved on-premise"], correct: 2, explanation: "Cloud environments have a shared responsibility model and unique risks. A risk assessment is necessary to understand these risks and implement appropriate controls, rather than simply lifting and shifting on-premise security measures." },
                { question: "The main purpose of a change management process is to:", answers: ["Ensure all changes are made as quickly as possible", "Prevent any changes from being made to production systems", "Ensure that changes are properly authorized, tested, and documented to reduce risk", "Allow developers to deploy code whenever they want"], correct: 2, explanation: "Change management provides a structured process to control changes to the IT environment, preventing unauthorized or untested changes from causing outages or security vulnerabilities." },
                { question: "What is the primary goal of vulnerability management?", answers: ["To identify and remediate weaknesses before they can be exploited", "To respond to active security incidents", "To create security policies for the organization", "To purchase cybersecurity insurance"], correct: 0, explanation: "Vulnerability management is a proactive, cyclical process of identifying, classifying, remediating, and mitigating vulnerabilities in systems." },
                { question: "Which of the following is a key activity in vendor risk management?", answers: ["Paying vendor invoices on time", "Conducting due diligence and ongoing monitoring of a vendor's security posture", "Negotiating the lowest possible price for a service", "Inviting vendor representatives to company parties"], correct: 1, explanation: "Vendor risk management involves assessing the security of third parties both before signing a contract (due diligence) and throughout the relationship (ongoing monitoring)." },
                { question: "An Intrusion Prevention System (IPS) is what type of control?", answers: ["Detective", "Corrective", "Preventive", "Administrative"], correct: 2, explanation: "An IPS is a preventive technical control because it actively blocks suspicious network traffic in real-time to stop an attack from succeeding." },
                { question: "The concept of 'defense in depth' refers to:", answers: ["Using only the strongest single security control available", "Focusing all security efforts on protecting the network perimeter", "Implementing multiple layers of different security controls", "Encrypting all data twice"], correct: 2, explanation: "Defense in depth is a security strategy that uses multiple, layered security controls (e.g., firewall, IPS, anti-malware, user training) so that if one layer fails, another may stop the attack." },
                { question: "What is the MOST important consideration when creating a data retention policy?", answers: ["The cost of data storage", "The desire of employees to keep all data forever", "Legal, regulatory, and business requirements", "The speed of the backup system"], correct: 2, explanation: "Data retention schedules are primarily driven by legal and regulatory compliance obligations, as well as specific business needs. Retaining data too long can increase risk and cost." },
                { question: "Which of the following is the BEST way to secure data in a development and test environment?", answers: ["Use live production data to ensure realism", "Anonymize or mask production data before using it in test environments", "Do not perform any testing to avoid data exposure", "Allow developers to use their own personal data for testing"], correct: 1, explanation: "Using live production data in lower environments is extremely risky. The best practice is to use realistic but non-sensitive test data, often created by anonymizing or masking a copy of production data." },
                { question: "The 'separation of duties' principle is designed to:", answers: ["Ensure that all IT staff are cross-trained in different roles", "Prevent a single individual from being able to carry out a fraudulent or malicious act alone", "Reduce the number of employees required to run the IT department", "Encourage collaboration between the development and operations teams"], correct: 1, explanation: "Separation of duties is a classic internal control that requires more than one person to complete a critical task, making it much more difficult to commit fraud." },
                { question: "Which security model focuses on preventing conflicts of interest?", answers: ["Bell-LaPadula", "Biba", "Clark-Wilson", "Brewer and Nash (Chinese Wall)"], correct: 3, explanation: "The Brewer and Nash model, also known as the Chinese Wall model, is specifically designed to prevent conflicts of interest by dynamically controlling access based on a user's previous actions." },
                { question: "A configuration management database (CMDB) is a key enabler for:", answers: ["Effective change and incident management", "Writing marketing copy", "Processing payroll", "Negotiating office lease agreements"], correct: 0, explanation: "A CMDB tracks all the hardware, software, and their relationships (configuration items). This information is vital for understanding the impact of a change or the scope of an incident." },
                { question: "The primary benefit of implementing an Identity and Access Management (IAM) solution is:", answers: ["Increased security and operational efficiency", "It allows the company to eliminate all passwords", "It satisfies all requirements for all security audits", "It makes the network run faster"], correct: 0, explanation: "IAM solutions improve security by enforcing policies like least privilege and MFA, and they improve efficiency by automating processes like user onboarding and offboarding." },
                { question: "Which of the following is the MOST important reason to have a formal security program?", answers: ["To provide a structured and coordinated approach to managing security risk", "To give the CISO something to do", "To be able to blame someone when a breach occurs", "To ensure the company buys the latest security gadgets"], correct: 0, explanation: "A formal program moves an organization from a reactive, ad-hoc approach to a proactive, strategic, and coordinated method for managing information security risk across the enterprise." },
                { question: "What is the 'principle of non-repudiation'?", answers: ["The principle that a user cannot deny having performed an action", "The principle that all data must be kept secret", "The principle that data must be available when needed", "The principle that systems must be easy to use"], correct: 0, explanation: "Non-repudiation provides proof of the origin and integrity of data. It ensures that a party to a transaction cannot later deny having received a transaction or that they were the one who sent it, often through the use of digital signatures." },
                { question: "Hardening a system involves:", answers: ["Increasing its physical durability", "Reducing its attack surface by disabling unnecessary services and accounts", "Backing up its data", "Moving it to a more secure physical location"], correct: 1, explanation: "System hardening is the process of securing a system by minimizing its surface of vulnerability. This includes removing unneeded software, disabling default accounts, and configuring security settings." },
                { question: "The Biba integrity model is primarily concerned with preventing:", answers: ["Unauthorized disclosure of information", "Unauthorized modification of information", "Denial of service attacks", "Conflicts of interest"], correct: 1, explanation: "Biba is an integrity model summarized as 'no read down, no write up.' It is focused on preventing data from being corrupted by users with a lower integrity level." },
                { question: "What is the BEST way to evaluate the security of a potential software-as-a-service (SaaS) provider?", answers: ["Read their marketing brochure", "Ask them if they are secure", "Review their third-party audit reports (e.g., SOC 2) and conduct a risk assessment", "Assume they are secure if they are a large, well-known company"], correct: 2, explanation: "Trust but verify. The most prudent approach is to perform due diligence by reviewing independent audit reports and conducting your own risk assessment based on the data you intend to entrust to them." },
                { question: "A key performance indicator (KPI) for a patch management program would be:", answers: ["The number of patches released by Microsoft each month", "The average time taken to deploy critical security patches", "The total cost of the vulnerability scanning tool", "The number of people on the patch management team"], correct: 1, explanation: "A good KPI measures performance and effectiveness. The time-to-patch metric directly measures how well the program is performing its core function of remediating vulnerabilities in a timely manner." }
            ],
            'domain-4': [
                { question: "In the context of Business Continuity Planning (BCP), what does Recovery Time Objective (RTO) define?", answers: ["The amount of data that can be lost", "The time it takes to write the BCP plan", "The target time within which a business process must be restored after a disaster", "The time it takes to detect an incident"], correct: 2, explanation: "RTO is a critical metric in BCP that defines the maximum acceptable downtime for a business process before significant negative impacts occur." },
                { question: "What is the main difference between a Business Continuity Plan (BCP) and a Disaster Recovery (DR) Plan?", answers: ["BCP is for natural disasters only, DR is for cyber attacks", "BCP focuses on keeping business processes running, while DR focuses on restoring IT infrastructure", "There is no difference", "BCP is managed by the business, DR is managed by the government"], correct: 1, explanation: "BCP has a broader scope, focusing on the continuity of critical business functions. DR is a subset of BCP, specifically focused on the technical recovery of IT systems and infrastructure." },
                { question: "What is the FIRST step in the incident response process?", answers: ["Eradication", "Containment", "Preparation", "Recovery"], correct: 2, explanation: "The incident response lifecycle begins with Preparation. This phase involves creating plans, training the team, and having the necessary tools in place before an incident ever occurs." },
                { question: "The Recovery Point Objective (RPO) is concerned with:", answers: ["The time it takes to recover a system", "The acceptable amount of data loss", "The number of people on the recovery team", "The location of the alternate site"], correct: 1, explanation: "RPO defines the maximum tolerable amount of data that can be lost from an IT service due to a major incident. It essentially determines the frequency of backups (e.g., an RPO of 1 hour requires hourly backups)." },
                { question: "During which phase of incident response would an analyst take an infected server offline?", answers: ["Detection and Analysis", "Containment", "Post-Incident Activity", "Preparation"], correct: 1, explanation: "Containment is the phase focused on stopping the spread of an incident and preventing further damage. Taking an infected server offline is a key containment strategy to isolate the threat." },
                { question: "The primary purpose of a Business Impact Analysis (BIA) is to:", answers: ["Identify and prioritize critical business functions and their dependencies", "Select a vendor for an alternate recovery site", "Document the steps to recover a specific server", "Test the incident response plan"], correct: 0, explanation: "The BIA is the foundation of business continuity planning. Its purpose is to identify the organization's most critical processes and the resources they depend on, which allows for the prioritization of recovery efforts." },
                { question: "What is a 'hot site' in the context of disaster recovery?", answers: ["A recovery site that is still under construction", "A fully equipped and configured data center that can be operational in minutes or hours", "An empty data center with power and cooling but no hardware", "A temporary office space for employees with no IT equipment"], correct: 1, explanation: "A hot site is the most expensive but fastest type of recovery site. It is a near-duplicate of the primary site with all necessary hardware, software, and network connectivity, ready to take over at a moment's notice." },
                { question: "After a security incident has been resolved, what is the MOST important activity to perform?", answers: ["Blame the responsible party", "Delete all logs related to the incident", "Conduct a lessons-learned review", "Immediately purchase a new security tool"], correct: 2, explanation: "The post-incident activity, or lessons-learned phase, is crucial for continuous improvement. It involves analyzing what happened, what worked, what didn't, and how the incident response process can be improved for the future." },
                { question: "Which of the following is the BEST way to test the effectiveness of a Disaster Recovery Plan?", answers: ["A tabletop exercise where the team discusses the plan", "A full-scale simulation that includes a failover to the alternate site", "A checklist review of the plan's contents", "Sending the plan to an auditor for review"], correct: 1, explanation: "While all are valid testing methods, a full-scale simulation provides the most realistic and comprehensive test of the DR plan's effectiveness, as it actually performs the recovery procedures and validates the capabilities of the alternate site." },
                { question: "The concept of 'chain of custody' is most critical when dealing with:", answers: ["Employee training records", "Financial reports", "Evidence handling during a forensic investigation", "Vendor contracts"], correct: 2, explanation: "Chain of custody is a formal, documented process that shows the chronological history of how evidence was collected, handled, transferred, and stored. Maintaining this chain is essential to ensure the integrity of the evidence and its admissibility in legal proceedings." },
                { question: "Which of the following is an example of a 'cold site'?", answers: ["A fully mirrored data center ready for immediate failover", "An office space with desks and phones but no IT equipment", "A data center with power, cooling, and network circuits, but no servers", "A mobile recovery trailer"], correct: 2, explanation: "A cold site is the least expensive option. It provides the basic infrastructure (space, power, cooling), but the organization must bring in its own hardware and software, leading to a long recovery time." },
                { question: "The 'eradication' phase of incident response involves:", answers: ["Removing the root cause of the incident and any malicious artifacts", "Notifying law enforcement about the incident", "Restoring systems from clean backups", "Isolating the affected systems from the network"], correct: 0, explanation: "Eradication is the step where the threat is actively removed from the environment, for example, by deleting malware, disabling breached user accounts, and patching vulnerabilities." },
                { question: "A 'checklist review' is a type of BCP/DR test where:", answers: ["A full failover to the alternate site is performed", "Team members verbally walk through their roles and responsibilities in a simulated scenario", "The plan documents are distributed to team members for their review and feedback", "A specific system is restored from a backup"], correct: 2, explanation: "A checklist review is the simplest type of test, where team members read through the plan to ensure it is up-to-date and accurate without any active simulation." },
                { question: "What is the primary goal of the 'containment' phase in incident response?", answers: ["To remove the attacker from the network", "To prevent the incident from causing further damage", "To understand the root cause of the incident", "To restore normal business operations"], correct: 1, explanation: "The immediate goal of containment is to stop the bleeding. It's about limiting the scope and magnitude of the incident, often by isolating affected systems." },
                { question: "The Maximum Tolerable Downtime (MTD) is identified during which process?", answers: ["Incident Response", "Business Impact Analysis (BIA)", "Vulnerability Assessment", "Threat Modeling"], correct: 1, explanation: "The MTD, which is a key input for setting the RTO, is determined during the BIA when the business evaluates how long it can survive without a specific process." },
                { question: "A 'warm site' provides which of the following?", answers: ["Only basic power and cooling", "A fully operational and staffed data center", "Hardware and network connectivity, but software and data need to be restored", "A subscription service for hardware on demand"], correct: 2, explanation: "A warm site is a compromise between hot and cold sites. It has the hardware ready to go, but the most recent data and potentially some software configurations need to be loaded, resulting in more recovery time than a hot site." },
                { question: "Which of the following is the MOST important component of an incident response team (IRT)?", answers: ["Having the latest forensic software", "Clear roles, responsibilities, and authority", "A dedicated budget for buying new tools", "A direct reporting line to the CEO"], correct: 1, explanation: "During the chaos of an incident, a clear command structure is paramount. Everyone on the team needs to know their role and have the authority to execute it without confusion or delay." },
                { question: "The process of returning a system and business operations to a normal state after an incident is known as:", answers: ["Detection", "Analysis", "Eradication", "Recovery"], correct: 3, explanation: "The recovery phase involves carefully bringing the restored systems back online, monitoring for any residual issues, and formally closing the incident." },
                { question: "Why is it critical to document all actions taken during an incident response?", answers: ["To create a report for the marketing team", "To support post-incident reviews and potential legal action", "To justify the salaries of the incident response team", "To ensure the incident is never discussed again"], correct: 1, explanation: "Thorough documentation is vital for the 'lessons learned' review to improve future responses. It also creates an evidentiary trail that may be required for legal or regulatory proceedings." },
                { question: "A tabletop exercise is a good way to test:", answers: ["The technical functionality of backup systems", "The decision-making and communication processes of the response team", "The speed of network failover to a hot site", "The effectiveness of an anti-malware solution"], correct: 1, explanation: "Tabletop exercises are discussion-based sessions where the team talks through a simulated scenario. They are excellent for testing the 'human' elements of a plan, such as communication, coordination, and decision-making, without the cost and risk of a full technical test." },
                { question: "The 'declaration of disaster' is a critical step because it:", answers: ["Formally activates the disaster recovery plan and authorizes the use of resources", "Notifies the public that the company has been breached", "Automatically restores all systems from backup", "Is required before the company can contact law enforcement"], correct: 0, explanation: "The declaration is a formal trigger point, usually made by senior management, that officially moves the organization from normal operations into a disaster recovery mode, freeing up the necessary funds and personnel." },
                { question: "What is the primary purpose of having an alternate processing site?", answers: ["To have a place for extra employees to work", "To ensure business can continue if the primary site is unavailable", "To get a discount on business insurance", "To store old paper records"], correct: 1, explanation: "The entire purpose of a DR site (hot, warm, or cold) is to provide a location where critical business and IT operations can be resumed if the main facility is destroyed or inaccessible." },
                { question: "In digital forensics, what is 'data volatility'?", answers: ["The likelihood of data being encrypted", "The tendency of data to change or be lost when a system is powered down", "The physical size of the data storage medium", "The monetary value of the data"], correct: 1, explanation: "Data volatility refers to how long-lasting data is. Data in RAM is highly volatile (it disappears on shutdown), while data on a hard drive is non-volatile. Forensics investigators must collect evidence in order from most to least volatile." },
                { question: "Which of the following should be a key goal of the post-incident review meeting?", answers: ["To assign blame for the incident", "To identify opportunities for improvement in a blame-free manner", "To calculate the exact financial cost of the incident", "To finalize the press release about the incident"], correct: 1, "explanation": "A successful lessons-learned session requires an environment of trust where people can speak openly about what went wrong without fear of punishment. The goal is process improvement, not assigning blame." },
                { question: "A reciprocal agreement for disaster recovery is generally considered risky PRIMARILY because:", answers: ["The other company might be a competitor", "It is difficult to enforce and the other company may not have resources available in a real disaster", "It is the most expensive type of alternate site", "It requires a full-time staff to maintain the agreement"], correct: 1, explanation: "Reciprocal agreements are often informal and hard to enforce. When a disaster strikes, the partner organization will be focused on its own survival and may not have the capacity or willingness to help, making it an unreliable option." },
                { question: "The first action an incident responder should take upon discovering a compromised system is to:", answers: ["Wipe the system and reinstall the OS", "Follow the procedures in the incident response plan", "Unplug the system from the network immediately", "Call the CEO"], correct: 1, explanation: "While unplugging the system might seem right, it could destroy volatile evidence. The correct first step is always to follow the pre-approved, documented procedures in the IRP, which will guide the responder on the proper steps for containment and evidence preservation." },
                { question: "The main output of a Business Impact Analysis (BIA) is a list of:", answers: ["All company employees and their contact information", "All potential security vulnerabilities", "Prioritized critical business processes and their recovery requirements (RTO/RPO)", "Approved hardware and software vendors"], correct: 2, explanation: "The BIA's core purpose is to identify what is most important to the business and how quickly it needs to be recovered after a disruption. This information is the foundation for the entire BCP/DR strategy." },
                { question: "What is the primary risk of not testing a disaster recovery plan?", answers: ["The plan will not receive approval from auditors", "The plan is likely to fail during a real disaster", "The company will not be able to get cybersecurity insurance", "Employees will not know the plan exists"], correct: 1, explanation: "A plan that has not been tested is just a collection of untested assumptions. Testing is the only way to find flaws in the plan and ensure the technology and people can perform as expected under pressure." },
                { question: "Which of the following is an example of an out-of-band communication method for an incident response team?", answers: ["The company's primary email system", "A conference call using the corporate VoIP phone system", "A group chat on a public social media platform", "A pre-established phone bridge hosted by a third-party provider"], correct: 3, explanation: "Out-of-band communication uses a channel that is separate from the company's primary, potentially compromised network. This ensures the team can communicate securely even if corporate email or phones are down." },
                { question: "The final step in a digital forensics process is typically:", answers: ["Evidence collection", "Analysis", "Presentation and reporting", "Containment"], correct: 2, explanation: "After evidence has been collected, preserved, and analyzed, the findings must be documented and presented in a clear, concise report that can be understood by management, legal teams, or a court." }
            ],
        };

        const domainWeights = { 'domain-1': 0.17, 'domain-2': 0.20, 'domain-3': 0.33, 'domain-4': 0.30 };
        const domainDetails = {
            'domain-1': { title: "Domain 1: Information Security Governance", weight: 17 },
            'domain-2': { title: "Domain 2: Information Security Risk Management", weight: 20 },
            'domain-3': { title: "Domain 3: Information Security Program", weight: 33 },
            'domain-4': { title: "Domain 4: Incident Management", weight: 30 },
            'simulated-exam': { title: "Simulated Exam", totalQuestions: 150 }
        };

        let currentAssessment = { questions: [], userAnswers: [], currentQuestionIndex: 0, startTime: null, assessmentType: null, timerInterval: null };

        // --- DOM Element References ---
        const setupView = document.getElementById('assessment-setup');
        const inProgressView = document.getElementById('assessment-in-progress');
        const resultsView = document.getElementById('assessment-results');
        const reviewView = document.getElementById('assessment-review');
        const optionsArea = document.getElementById('assessment-options-area');
        const tabs = document.querySelectorAll('.assessment-tab');
        const questionCounter = document.getElementById('question-counter');
        const progressBar = document.getElementById('progress-bar');
        const questionText = document.getElementById('question-text');
        const answerOptionsContainer = document.getElementById('answer-options');
        const prevBtn = document.getElementById('prev-question-btn');
        const nextBtn = document.getElementById('next-question-btn');
        const submitBtn = document.getElementById('submit-assessment-btn');
        const quitBtn = document.getElementById('quit-assessment-btn');
        const timerDisplay = document.getElementById('timer-display');
        const finalScoreEl = document.getElementById('final-score');
        const scoreDetailsEl = document.getElementById('score-details');
        const resultsBreakdownEl = document.getElementById('results-breakdown');
        const reviewAnswersBtn = document.getElementById('review-answers-btn');
        const restartAssessmentBtn = document.getElementById('restart-assessment-btn');
        const quitModal = document.getElementById('quit-modal');
        const confirmQuitBtn = document.getElementById('confirm-quit-btn');
        const cancelQuitBtn = document.getElementById('cancel-quit-btn');
        const alertModal = document.getElementById('alert-modal');
        const alertMessage = document.getElementById('alert-message');
        const confirmAlertBtn = document.getElementById('confirm-alert-btn');
        
        function showCustomAlert(message) {
            alertMessage.textContent = message;
            alertModal.classList.remove('hidden');
        }

        function showView(viewToShow) {
            [setupView, inProgressView, resultsView, reviewView].forEach(v => v.classList.add('hidden'));
            viewToShow.classList.remove('hidden');
            viewToShow.classList.add('fade-in');
        }

        function renderOptions(target) {
            const details = domainDetails[target];
            const maxQuestions = questionBank[target]?.length || 0;
            let content = '';

            if (target === 'simulated-exam') {
                const d1q = Math.round(details.totalQuestions * domainWeights['domain-1']);
                const d2q = Math.round(details.totalQuestions * domainWeights['domain-2']);
                const d3q = Math.round(details.totalQuestions * domainWeights['domain-3']);
                const d4q = details.totalQuestions - d1q - d2q - d3q; // Ensure total is 150

                content = `
                    <div class="assessment-card p-6 sm:p-8 text-center">
                        <h3 class="text-2xl font-bold text-white mb-2">${details.title}</h3>
                        <p class="text-gray-400 mb-6">This is a full-length simulated exam with ${details.totalQuestions} questions, weighted according to the official CISM exam outline.</p>
                        <ul class="text-left max-w-sm mx-auto list-disc list-inside mb-8 text-gray-400">
                            <li>Domain 1: ${d1q} questions</li>
                            <li>Domain 2: ${d2q} questions</li>
                            <li>Domain 3: ${d3q} questions</li>
                            <li>Domain 4: ${d4q} questions</li>
                        </ul>
                        <button class="btn btn-primary start-assessment-btn" data-type="simulated">Start Simulated Exam</button>
                    </div>`;
            } else {
                const weightedQuestions = Math.round(150 * domainWeights[target]);
                content = `
                    <div class="assessment-card p-6 sm:p-8 text-center">
                        <h3 class="text-2xl font-bold text-white mb-2">${details.title}</h3>
                        <p class="text-gray-400 mb-8">Choose how you want to test your knowledge for this domain.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="p-6 bg-black/20 rounded-lg flex flex-col justify-between border border-gray-700">
                                <div>
                                    <h4 class="text-xl font-semibold mb-3 text-gray-200">Practice Quiz</h4>
                                    <p class="text-sm text-gray-400 mb-4">Enter the number of questions you want to practice (max ${maxQuestions}).</p>
                                    <input type="number" id="custom-question-count" class="custom-number-input mb-4" value="30" min="1" max="${maxQuestions}">
                                </div>
                                <button class="btn btn-primary start-assessment-btn mt-4" data-type="custom" data-domain="${target}">Start Practice</button>
                            </div>
                            <div class="p-6 bg-black/20 rounded-lg flex flex-col justify-between border border-gray-700">
                                <div>
                                    <h4 class="text-xl font-semibold mb-3 text-gray-200">Weighted Quiz</h4>
                                    <p class="text-sm text-gray-400 mb-4">Take a quiz weighted like the real exam (${details.weight}% of 150 questions).</p>
                                    <p class="text-4xl font-bold text-accent-glow mb-4">${weightedQuestions} Questions</p>
                                </div>
                                <button class="btn btn-primary start-assessment-btn" data-type="weighted" data-domain="${target}" data-count="${weightedQuestions}">Start Weighted Quiz</button>
                            </div>
                        </div>
                    </div>`;
            }
            optionsArea.innerHTML = content;
        }

        function handleTabClick(e) {
            tabs.forEach(tab => tab.classList.remove('active'));
            e.target.classList.add('active');
            renderOptions(e.target.dataset.target);
        }

        function stopTimer() {
            if (currentAssessment.timerInterval) clearInterval(currentAssessment.timerInterval);
            currentAssessment.timerInterval = null;
            timerDisplay.classList.add('hidden');
        }

        function startTimer() {
            stopTimer();
            const duration = 4 * 60 * 60 * 1000;
            const endTime = new Date().getTime() + duration;
            timerDisplay.classList.remove('hidden');
            currentAssessment.timerInterval = setInterval(() => {
                const now = new Date().getTime();
                const distance = endTime - now;
                if (distance < 0) {
                    stopTimer();
                    timerDisplay.textContent = "0:00:00";
                    submitAssessment();
                    return;
                }
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                timerDisplay.textContent = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function startAssessment(questions, type) {
            currentAssessment = { ...currentAssessment, questions, userAnswers: new Array(questions.length).fill(null), currentQuestionIndex: 0, startTime: new Date(), assessmentType: type };
            if (type === 'simulated') startTimer(); else stopTimer();
            displayQuestion();
            showView(inProgressView);
        }

        function displayQuestion() {
            const q = currentAssessment.questions[currentAssessment.currentQuestionIndex];
            const qNum = currentAssessment.currentQuestionIndex + 1;
            const total = currentAssessment.questions.length;
            questionCounter.textContent = `Question ${qNum} of ${total}`;
            progressBar.style.width = `${(qNum / total) * 100}%`;
            questionText.textContent = q.question;
            answerOptionsContainer.innerHTML = q.answers.map((answer, index) => {
                const isSelected = currentAssessment.userAnswers[currentAssessment.currentQuestionIndex] === index;
                return `<div class="answer-option ${isSelected ? 'selected' : ''}" data-index="${index}">${answer}</div>`;
            }).join('');
            answerOptionsContainer.querySelectorAll('.answer-option').forEach(opt => opt.addEventListener('click', () => selectAnswer(parseInt(opt.dataset.index))));
            prevBtn.classList.toggle('hidden', currentAssessment.currentQuestionIndex === 0);
            nextBtn.classList.toggle('hidden', qNum === total);
            submitBtn.classList.toggle('hidden', qNum !== total);
        }

        function selectAnswer(index) {
            currentAssessment.userAnswers[currentAssessment.currentQuestionIndex] = index;
            displayQuestion();
        }

        function changeQuestion(direction) {
            currentAssessment.currentQuestionIndex += direction;
            displayQuestion();
        }

        function submitAssessment() {
            stopTimer();
            let correctCount = 0;
            let breakdown = {};
            currentAssessment.questions.forEach((q, index) => {
                const domain = q.domain || 'domain';
                if (!breakdown[domain]) breakdown[domain] = { correct: 0, total: 0 };
                breakdown[domain].total++;
                if (currentAssessment.userAnswers[index] === q.correct) {
                    correctCount++;
                    breakdown[domain].correct++;
                }
            });
            const totalQuestions = currentAssessment.questions.length;
            const score = totalQuestions > 0 ? Math.round((correctCount / totalQuestions) * 100) : 0;
            finalScoreEl.textContent = `${score}%`;
            scoreDetailsEl.textContent = `You answered ${correctCount} out of ${totalQuestions} questions correctly.`;
            resultsBreakdownEl.innerHTML = Object.keys(breakdown).map(domainKey => {
                const domainData = breakdown[domainKey];
                const domainScore = domainData.total > 0 ? Math.round((domainData.correct / domainData.total) * 100) : 0;
                const title = domainDetails[domainKey]?.title || 'Overall';
                return `<div class="flex justify-between items-center breakdown-item">
                    <span class="text-gray-300">${title}</span>
                    <span class="font-bold text-white">${domainScore}% (${domainData.correct}/${domainData.total})</span>
                </div>`;
            }).join('');
            showView(resultsView);
        }
        
        function reviewAnswers() {
            reviewView.innerHTML = `<div class="p-6 sm:p-8 rounded-lg">
                <h2 class="text-3xl font-bold text-white mb-8">Review Answers</h2>
                ${currentAssessment.questions.map((q, index) => {
                    const userAnswer = currentAssessment.userAnswers[index];
                    const isCorrect = userAnswer === q.correct;
                    return `<div class="mb-8 pb-6 border-b border-gray-700">
                        <p class="font-bold text-gray-200 mb-4">Question ${index + 1}: ${q.question}</p>
                        <div class="space-y-3">${q.answers.map((answer, ansIndex) => {
                            let classes = 'answer-option p-3';
                            if (ansIndex === q.correct) classes += ' correct';
                            else if (ansIndex === userAnswer) classes += ' incorrect';
                            return `<div class="${classes}">${answer}</div>`;
                        }).join('')}</div>
                        <div class="mt-4 p-3 rounded-md bg-black/20 border border-gray-700">
                            <strong class="text-accent-glow">Explanation:</strong>
                            <p class="text-gray-400 mt-1">${q.explanation}</p>
                        </div>
                    </div>`;
                }).join('')}
                <div class="text-center mt-8"><button id="back-to-results-btn" class="btn btn-primary">Back to Results</button></div>
            </div>`;
            showView(reviewView);
            document.getElementById('back-to-results-btn').addEventListener('click', () => showView(resultsView));
        }

        function getQuestionsForAssessment(type, domain, count) {
            if (type === 'simulated') {
                const d1q = Math.round(150 * domainWeights['domain-1']);
                const d2q = Math.round(150 * domainWeights['domain-2']);
                const d3q = Math.round(150 * domainWeights['domain-3']);
                const d4q = 150 - d1q - d2q - d3q;
                
                const questionCounts = {'domain-1': d1q, 'domain-2': d2q, 'domain-3': d3q, 'domain-4': d4q};

                return Object.keys(domainWeights).flatMap(dKey => {
                    const num = questionCounts[dKey];
                    const domainQs = [...questionBank[dKey]].map(q => ({...q, domain: dKey}));
                    return domainQs.sort(() => 0.5 - Math.random()).slice(0, num);
                });
            } else {
                const domainQs = [...questionBank[domain]].map(q => ({...q, domain}));
                return domainQs.sort(() => 0.5 - Math.random()).slice(0, count);
            }
        }

        // --- Event Listeners ---
        tabs.forEach(tab => tab.addEventListener('click', handleTabClick));
        
        optionsArea.addEventListener('click', (e) => {
            const button = e.target.closest('.start-assessment-btn');
            if (!button) return;
            const { type, domain } = button.dataset;
            let count = parseInt(button.dataset.count);
            if (type === 'custom') {
                const countInput = document.getElementById('custom-question-count');
                const max = parseInt(countInput.max);
                const val = parseInt(countInput.value);
                if (val > 0 && val <= max) {
                    count = val;
                } else {
                    showCustomAlert(`Please enter a number between 1 and ${max}.`);
                    return;
                }
            }
            const questions = getQuestionsForAssessment(type, domain, count);
            if (questions.length > 0) startAssessment(questions, type);
            else showCustomAlert('Not enough questions in the bank for this selection.');
        });

        nextBtn.addEventListener('click', () => changeQuestion(1));
        prevBtn.addEventListener('click', () => changeQuestion(-1));
        submitBtn.addEventListener('click', submitAssessment);
        quitBtn.addEventListener('click', () => quitModal.classList.remove('hidden'));
        cancelQuitBtn.addEventListener('click', () => quitModal.classList.add('hidden'));
        confirmQuitBtn.addEventListener('click', () => {
            stopTimer();
            quitModal.classList.add('hidden');
            showView(setupView);
        });
        reviewAnswersBtn.addEventListener('click', reviewAnswers);
        restartAssessmentBtn.addEventListener('click', () => startAssessment(currentAssessment.questions, currentAssessment.assessmentType));
        confirmAlertBtn.addEventListener('click', () => alertModal.classList.add('hidden'));

        // --- Initial Load ---
        renderOptions('domain-1');
    });
    </script>
</body>
</html>
