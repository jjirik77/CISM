<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CISM 2024: Assessment Interactive Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Scoped Styles for Embeddable Assessment Module */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        
        #assessment-module-container {
            font-family: 'Inter', sans-serif;
            background-color: #F8F5EF; /* Warm Neutral Background */
            color: #333333;
            padding: 1rem;
            border-radius: 0.75rem;
            border: 1px solid #D5D2C8;
        }

        #assessment-module-container .section-header {
            border-left: 6px solid #00A896; /* Vibrant Teal Accent */
            padding-left: 1.25rem;
            font-size: 2.5rem;
            color: #222222;
        }

        #assessment-module-container .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #assessment-module-container .assessment-tab {
            transition: background-color 0.2s, color 0.2s;
        }

        #assessment-module-container .assessment-tab.active {
            background-color: #00A896;
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #assessment-module-container .assessment-card {
            background-color: #FFFFFF;
            border-radius: 0.75rem;
            border: 1px solid #E0E0E0; /* Added a light border */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08); /* Increased shadow */
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }

        #assessment-module-container .assessment-card:hover {
            transform: translateY(-4px); /* Increased lift */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12); /* Increased shadow on hover */
        }

        #assessment-module-container .btn-primary {
            background-color: #00A896;
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
        }

        #assessment-module-container .btn-primary:hover {
            background-color: #008778;
        }

        #assessment-module-container .btn-danger {
            background-color: #DC3545;
            color: white;
        }

        #assessment-module-container .btn-danger:hover {
            background-color: #c82333;
        }

        #assessment-module-container .btn-secondary {
            background-color: #EDEAE0;
            color: #333333;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
        }

        #assessment-module-container .btn-secondary:hover {
            background-color: #D5D2C8;
        }

        #assessment-module-container .answer-option {
            border: 2px solid #EDEAE0;
            border-radius: 0.5rem;
            padding: 1rem;
            cursor: pointer;
            transition: border-color 0.2s, background-color 0.2s;
        }

        #assessment-module-container .answer-option:hover {
            border-color: #00A896;
        }

        #assessment-module-container .answer-option.selected {
            background-color: #E0F7F5;
            border-color: #00A896;
        }

        #assessment-module-container .answer-option.correct {
            background-color: #D4EDDA;
            border-color: #155724;
        }

        #assessment-module-container .answer-option.incorrect {
            background-color: #F8D7DA;
            border-color: #721C24;
        }

        #assessment-module-container .progress-bar-container {
            background-color: #EDEAE0;
            border-radius: 9999px;
            height: 10px;
            width: 100%;
            overflow: hidden;
        }

        #assessment-module-container .progress-bar {
            background-color: #00A896;
            height: 100%;
            transition: width 0.3s ease-in-out;
        }

        /* Custom Modal Styles */
        #assessment-module-container .modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #assessment-module-container .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        
        /* Hide number input arrows */
        #assessment-module-container input[type="number"]::-webkit-inner-spin-button,
        #assessment-module-container input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        #assessment-module-container input[type="number"] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body>

    <!-- Start of Embeddable Module -->
    <div id="assessment-module-container">
        <header class="text-center py-8 bg-white rounded-lg shadow-md mb-8">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 mb-2">CISM Assessment Center</h1>
            <p class="text-xl sm:text-2xl text-gray-600">Test Your Knowledge and Prepare for the Exam</p>
        </header>

        <main id="assessment-main-content">
            <!-- Assessment Setup View -->
            <div id="assessment-setup">
                <nav class="bg-white p-4 rounded-lg shadow-md mb-8 flex flex-wrap justify-center sticky top-0 z-10">
                    <button class="assessment-tab px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200 active" data-target="domain-1">Domain 1</button>
                    <button class="assessment-tab px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="domain-2">Domain 2</button>
                    <button class="assessment-tab px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="domain-3">Domain 3</button>
                    <button class="assessment-tab px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="domain-4">Domain 4</button>
                    <button class="assessment-tab px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="simulated-exam">Simulated Exam</button>
                </nav>

                <div id="assessment-options-area" class="fade-in">
                    <!-- Domain-specific options will be injected here -->
                </div>
            </div>

            <!-- Assessment In-Progress View -->
            <div id="assessment-in-progress" class="hidden">
                <div class="bg-white p-6 sm:p-8 rounded-lg shadow-md">
                    <div class="flex justify-between items-center mb-4">
                        <h2 id="question-counter" class="text-xl font-bold text-gray-800">Question 1 of 10</h2>
                        <div id="timer-display" class="text-xl font-bold text-gray-800 hidden">4:00:00</div>
                        <button id="quit-assessment-btn" class="btn-secondary text-sm px-3 py-1">Quit</button>
                    </div>
                    <div class="progress-bar-container mb-6">
                        <div id="progress-bar" class="progress-bar" style="width: 10%;"></div>
                    </div>
                    <p id="question-text" class="text-lg text-gray-700 mb-6">This is where the question text will appear.</p>
                    <div id="answer-options" class="space-y-4">
                        <!-- Answer options will be injected here -->
                    </div>
                    <div class="flex justify-between mt-8">
                        <button id="prev-question-btn" class="btn-secondary">Previous</button>
                        <button id="next-question-btn" class="btn-primary">Next</button>
                        <button id="submit-assessment-btn" class="btn-primary hidden">Submit</button>
                    </div>
                </div>
            </div>

            <!-- Assessment Results View -->
            <div id="assessment-results" class="hidden">
                <div class="bg-white p-6 sm:p-8 rounded-lg shadow-md text-center">
                    <h2 class="text-3xl font-bold section-header text-gray-800 mb-4 inline-block">Assessment Complete!</h2>
                    <p class="text-xl text-gray-600 mb-2">Here's how you did:</p>
                    <p id="final-score" class="text-6xl font-extrabold text-gray-800 my-4">85%</p>
                    <p id="score-details" class="text-lg text-gray-700 mb-6">You answered 17 out of 20 questions correctly.</p>
                    <div id="results-breakdown" class="mb-8 text-left max-w-md mx-auto">
                        <!-- Results breakdown will be injected here -->
                    </div>
                    <div class="flex justify-center gap-4">
                        <button id="review-answers-btn" class="btn-secondary">Review Answers</button>
                        <button id="restart-assessment-btn" class="btn-primary">Try Again</button>
                    </div>
                </div>
            </div>
            
            <!-- Assessment Review View -->
            <div id="assessment-review" class="hidden">
                 <!-- Review content will be dynamically generated here -->
            </div>
        </main>

        <footer class="text-center py-6 mt-8 text-gray-500 text-sm">
            <p>&copy; 2024 CISM Study Guide. All rights reserved. For educational purposes only.</p>
        </footer>

        <!-- Quit Confirmation Modal -->
        <div id="quit-modal" class="modal-overlay hidden">
            <div class="modal-content fade-in">
                <h3 class="text-xl font-bold mb-4">Are you sure?</h3>
                <p class="text-gray-600 mb-6">Your progress on this assessment will be lost.</p>
                <div class="flex justify-center gap-4">
                    <button id="cancel-quit-btn" class="btn-secondary">Cancel</button>
                    <button id="confirm-quit-btn" class="btn-primary btn-danger">Yes, Quit</button>
                </div>
            </div>
        </div>
    </div>
    <!-- End of Embeddable Module -->

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const moduleContainer = document.getElementById('assessment-module-container');
        if (!moduleContainer) return; // Stop if the container is not found

        // --- DATA ---
        const questionBank = {
            'domain-1': [
                { question: "What is the primary goal of information security governance?", answers: ["To reduce the cost of security controls", "To ensure that security strategies are aligned with business objectives", "To implement the latest security technologies", "To achieve 100% compliance with all regulations"], correct: 1, explanation: "The primary goal of information security governance is to align security efforts with the strategic goals of the business, ensuring that security is an enabler, not a hindrance." },
                { question: "Which of the following is a key outcome of a mature security governance framework?", answers: ["Increased IT budget", "Risk optimization", "Elimination of all security incidents", "Shorter product development cycles"], correct: 1, explanation: "A mature governance framework enables the organization to make informed decisions to optimize risk, balancing the cost of controls with the potential impact of threats to achieve business objectives." },
                { question: "Who is ultimately responsible for information security within an organization?", answers: ["The CISO", "The IT department", "The Board of Directors / Senior Management", "All employees"], correct: 2, explanation: "While the CISO manages the program and employees have a role, the ultimate responsibility and accountability for information security lie with the highest levels of leadership, such as the Board of Directors and senior management." },
                { question: "A strategic alignment of security with business objectives is BEST achieved through:", answers: ["Implementing a SIEM", "Developing a comprehensive information security governance framework", "Hiring more security analysts", "Conducting annual penetration tests"], correct: 1, explanation: "A governance framework provides the structure, policies, and processes to ensure that security activities directly support and align with the broader goals of the business." },
                { question: "What is the MOST important objective of creating a business case for a security investment?", answers: ["To guarantee the project gets approved", "To demonstrate the ROI and value to the business", "To list all technical features of a proposed solution", "To satisfy an audit requirement"], correct: 1, explanation: "The primary purpose of a business case is to articulate the value proposition in business terms, often by showing a positive Return on Investment (ROI) or other quantifiable benefits, to secure funding and support from management." },
                { question: "Which of the following is an example of a detective control?", answers: ["Firewall", "Encryption", "Security awareness training", "Log file monitoring"], correct: 3, explanation: "Detective controls are designed to identify and report that an incident has occurred. Log file monitoring actively searches for signs of intrusion or policy violations after they have happened." },
                { question: "The process of identifying, classifying, and prioritizing information assets is a foundational step for:", answers: ["Network segmentation", "Effective risk management", "Choosing an antivirus vendor", "Writing a press release"], correct: 1, explanation: "An organization cannot effectively protect what it does not know it has. Identifying and understanding the value of its information assets is the first step in applying appropriate risk management and protection." },
                { question: "An organization's risk appetite is BEST defined as:", answers: ["The amount of loss experienced in a year", "The budget allocated for security controls", "The amount of risk the organization is willing to accept to achieve its objectives", "The number of open vulnerabilities on a scan report"], correct: 2, explanation: "Risk appetite is a high-level, strategic statement from senior management that defines the level of risk the organization is willing to pursue or tolerate in its activities." },
                { question: "Which role is responsible for classifying data and determining appropriate access controls?", answers: ["Data custodian", "Data user", "Data owner", "Data processor"], correct: 2, explanation: "The data owner, typically a senior business manager, is accountable for the data and is responsible for making key decisions about its classification and protection, including who is authorized to access it." },
                { question: "The PRIMARY benefit of a well-defined information security architecture is:", answers: ["It allows for faster software development", "It reduces the need for user training", "It ensures consistent and cost-effective implementation of security controls", "It guarantees compliance with all international laws"], correct: 2, explanation: "A security architecture provides a blueprint for how controls are designed and integrated, which leads to consistency, avoids redundant or conflicting controls, and ensures that security is implemented in a cost-effective manner that aligns with the overall strategy." },
                { question: "Which of the following BEST describes the role of a steering committee for information security?", answers: ["To perform daily security operations", "To provide high-level direction and oversight for the security program", "To conduct penetration tests", "To respond to security incidents"], correct: 1, explanation: "A steering committee, composed of senior business leaders, provides strategic guidance, ensures alignment with business goals, and oversees the information security program, rather than managing its day-to-day operations." },
                { question: "A key purpose of information security metrics is to:", answers: ["Justify the purchase of new security tools", "Communicate the effectiveness of the security program to stakeholders", "Identify individuals who violate security policy", "Replace the need for security audits"], correct: 1, explanation: "Metrics provide quantifiable data that demonstrates the performance and value of the security program, enabling informed decision-making and clear communication with management and other stakeholders." },
                { question: "Which of the following is a primary driver for developing an information security strategy?", answers: ["A recent security breach at a competitor", "The personal preferences of the CISO", "The organization's business objectives and risk tolerance", "The availability of a new security technology"], correct: 2, explanation: "An effective security strategy must be driven by the needs of the business. It should be designed to support business objectives while managing risks to an acceptable level as defined by the organization's risk tolerance." },
                { question: "What is the main advantage of using a top-down approach to information security governance?", answers: ["It is faster to implement than a bottom-up approach", "It ensures that security initiatives have support from senior leadership", "It focuses on technical controls first", "It is less expensive"], correct: 1, explanation: "The top-down approach starts with senior management defining policies and strategy, which ensures that the security program has the necessary authority, resources, and alignment with business goals from the outset." },
                { question: "A company's security policy states that all sensitive data must be encrypted. This is an example of what type of control?", answers: ["Corrective", "Detective", "Preventive", "Compensating"], correct: 2, explanation: "A preventive control is designed to stop an undesirable event from occurring. Requiring encryption is a preventive measure intended to prevent unauthorized access to sensitive data." },
                { question: "Due care and due diligence are legal concepts related to liability. What is the difference between them?", answers: ["There is no difference", "Due care is implementing controls; due diligence is verifying those controls are effective", "Due diligence is for managers; due care is for technical staff", "Due care is about policies; due diligence is about procedures"], correct: 1, explanation: "Due care refers to the act of behaving as a reasonable person would (e.g., implementing a firewall). Due diligence is the follow-up action to ensure that this reasonable level of care is maintained (e.g., regularly reviewing firewall rules and logs)." },
                { question: "Which of the following is the MOST important component of an effective security awareness program?", answers: ["Using highly technical jargon", "Making the training as long as possible", "Regular reinforcement and relevance to users' roles", "A difficult final exam"], correct: 2, explanation: "For a security awareness program to be effective, it must be ongoing and provide information that is directly relevant to an employee's daily tasks. One-time training is quickly forgotten." },
                { question: "The purpose of a security policy is to:", answers: ["Provide a detailed step-by-step guide for a technical task", "Communicate management's intent and high-level requirements for security", "List all approved software for the organization", "Document the results of a risk assessment"], correct: 1, explanation: "A policy is a high-level document that sets the tone and direction for security. It is a formal statement from management that defines the organization's security goals and requirements." },
                { question: "Which of the following would be considered a 'standard' in a security documentation hierarchy?", answers: ["A document stating that all employees must protect company data", "A document specifying that all servers must run a specific version of an operating system", "A document outlining the steps to report a phishing email", "A document defining the company's overall risk appetite"], correct: 1, explanation: "Standards provide mandatory, specific requirements for technologies, configurations, and processes to ensure consistency and enforce the rules set in policies. Specifying an OS version is a classic example of a standard." },
                { question: "The concept of 'tone at the top' refers to:", answers: ["The volume of the security alarm system", "The encryption algorithm used for communications", "The ethical climate and security commitment demonstrated by senior leadership", "The font size used in security policies"], correct: 2, explanation: "'Tone at the top' is a critical governance concept. It means that senior leadership must visibly and consistently demonstrate their commitment to security and ethical behavior, which sets the cultural expectation for the rest of the organization." },
                { question: "An information security program should be based on:", answers: ["The latest technology trends", "A framework that aligns with the organization's goals", "The CISO's previous experience", "The number of security incidents"], correct: 1, explanation: "An effective security program is not arbitrary; it's built upon a structured framework (like ISO 27001 or NIST CSF) that is chosen and adapted to align with the specific goals, risks, and culture of the organization." },
                { question: "What is the purpose of a RACI chart in security governance?", answers: ["To calculate risk scores", "To define the roles and responsibilities of individuals for tasks and decisions", "To track the budget for security projects", "To list the approved software vendors"], correct: 1, explanation: "A RACI (Responsible, Accountable, Consulted, Informed) chart is a matrix used to clarify and define the roles and responsibilities of different people in completing tasks and making decisions, which is crucial for clear governance." },
                { question: "Which of the following is the BEST example of a compensating control?", answers: ["A firewall blocking malicious traffic", "Regular review of system logs on a server that cannot have antivirus installed", "Encrypting a hard drive", "A strong password policy"], correct: 1, explanation: "A compensating control is a substitute control used when a primary control cannot be implemented. If antivirus (a primary control) cannot be installed, enhanced log review compensates for that gap by providing a detective capability." },
                { question: "The MOST important reason to classify data is to:", answers: ["Determine the appropriate level of protection required", "Know how much storage space is needed", "Make it easier to share with third parties", "Comply with a single, specific regulation"], correct: 0, explanation: "Data classification is the foundation for data protection. By understanding the sensitivity and criticality of data, an organization can apply the necessary and cost-effective level of security controls." },
                { question: "A security champion program is designed to:", answers: ["Replace the need for a dedicated security team", "Identify the best security professional in the company", "Embed security awareness and expertise within business units", "Manage the security budget"], correct: 2, explanation: "A security champion program trains and empowers individuals within different business departments to act as local security advocates and points of contact, helping to improve the security culture and practices throughout the organization." },
                { question: "Which of the following is a key element of a security policy?", answers: ["A list of all IP addresses on the network", "The brand names of all security tools", "A statement of management's intent and support for security", "The CISO's home phone number"], correct: 2, explanation: "A security policy is a high-level document that must clearly state management's intent, goals, and commitment to information security, giving it the authority it needs to be effective." },
                { question: "The PRIMARY goal of continuous monitoring is to:", answers: ["Generate daily reports for auditors", "Maintain ongoing awareness of the organization's security posture", "Catch employees who are misusing company assets", "Justify an increase in the security budget"], correct: 1, explanation: "Continuous monitoring provides real-time or near-real-time visibility into the security state of systems and the effectiveness of controls, allowing for a proactive approach to risk management rather than relying on point-in-time assessments." },
                { question: "An organization's culture is a critical factor for the success of a security program because:", answers: ["It is not a critical factor", "A strong security culture encourages employees to make security-conscious decisions", "It determines which firewall to buy", "It is the only thing auditors look at"], correct: 1, explanation: "Technology and policies can fail, but a strong security culture, where employees instinctively consider security in their daily actions, provides a powerful and resilient layer of defense." },
                { question: "What is the purpose of a baseline in security management?", answers: ["To provide a minimum level of security for all systems", "To describe the most advanced security configuration possible", "To list all security incidents that have occurred", "To act as a guide for physical security only"], correct: 0, explanation: "A security baseline establishes a standard, minimum level of security that all systems of a certain type must adhere to, ensuring a consistent and manageable security posture across the enterprise." },
                { question: "The MOST effective way to gain senior management support for a security initiative is to:", answers: ["Use highly technical language to demonstrate expertise", "Present the initiative in terms of business benefits and risk reduction", "Compare the budget to that of a competitor", "Threaten to resign if the initiative is not approved"], correct: 1, explanation: "Senior management is focused on business objectives. To gain their support, security managers must articulate how a security initiative will help the business succeed, for example, by reducing the risk of financial loss, protecting brand reputation, or enabling new business opportunities." },
            ],
            'domain-2': [
                { question: "What is the formula for calculating Annualized Loss Expectancy (ALE)?", answers: ["SLE / ARO", "AV * EF", "SLE * ARO", "AV - SLE"], correct: 2, explanation: "ALE is calculated by multiplying the Single Loss Expectancy (SLE) by the Annualized Rate of Occurrence (ARO). It represents the expected monetary loss for an asset over a one-year period." },
                { question: "Which risk response strategy involves purchasing cybersecurity insurance?", answers: ["Mitigation", "Avoidance", "Acceptance", "Transfer"], correct: 3, explanation: "Purchasing insurance is a form of risk transfer, where the financial impact of a potential security incident is shifted to a third party (the insurance company)." },
                { question: "A risk assessment identifies a vulnerability with a high impact but a very low likelihood. What is this an example of?", answers: ["Inherent risk", "Residual risk", "A risk that should always be avoided", "A candidate for risk acceptance"], correct: 0, explanation: "Inherent risk is the risk level before any controls are applied. The initial assessment of impact and likelihood defines the inherent risk." },
                { question: "The main purpose of a threat assessment is to:", answers: ["Identify all vulnerabilities in a system", "Determine the effectiveness of existing controls", "Identify and evaluate potential adversaries and their methods", "Calculate the Annualized Loss Expectancy (ALE)"], correct: 2, explanation: "A threat assessment focuses specifically on identifying the sources of threats (e.g., hackers, insiders, nature) and the methods they might use to cause harm to the organization's assets." },
                { question: "In a quantitative risk analysis, what does the Exposure Factor (EF) represent?", answers: ["The number of times an event is expected to occur in a year", "The total value of the asset", "The percentage of loss a realized threat would have on an asset", "The cost of the security control to be implemented"], correct: 2, explanation: "The Exposure Factor (EF) is a measure of the potential damage from a specific threat, expressed as a percentage of the asset's value. For example, if a fire would destroy 50% of a data center, the EF is 50%." },
                { question: "What is residual risk?", answers: ["The risk before any controls are applied", "The risk that is transferred to another party", "The risk that remains after management has implemented controls", "The risk that has been identified but not yet assessed"], correct: 2, explanation: "Residual risk is the level of risk that is left over after security controls and other mitigation strategies have been applied. It's the risk that the organization accepts as a cost of doing business." },
                { question: "Which of the following is the BEST reason for a company to formally accept a risk?", answers: ["The security team does not know how to fix it", "The cost of mitigating the risk is greater than the potential impact", "The risk was identified by a junior analyst", "Management is not concerned about security"], correct: 1, explanation: "Risk acceptance is a valid business decision when the cost of the countermeasure (the control) is more expensive than the potential loss from the risk itself. It must be a formal, documented decision by management." },
                { question: "A key benefit of using a standardized risk management framework like NIST SP 800-30 is that it:", answers: ["Guarantees the organization will not have a security breach", "Provides a structured and repeatable process for assessing risk", "Eliminates the need for security expertise", "Is the only framework accepted by auditors"], correct: 1, explanation: "Standardized frameworks provide a consistent methodology and vocabulary for risk management, which makes the process structured, repeatable, and easier to communicate across the organization." },
                { question: "The difference between a vulnerability and a threat is that:", answers: ["A threat is a weakness, and a vulnerability is the actor that exploits it", "A vulnerability is a weakness, and a threat is the actor or event that could exploit it", "They are the same thing", "A vulnerability is caused by a threat"], correct: 1, explanation: "A vulnerability is an internal weakness or flaw in a system or process. A threat is an external entity or event (like a hacker or a natural disaster) that has the potential to exploit that vulnerability." },
                { question: "When developing risk scenarios, the MOST important factor to consider is:", answers: ["The technical complexity of the attack", "The likelihood of a zero-day exploit being used", "The potential business impact", "The cost of the asset being targeted"], correct: 2, explanation: "While all factors are relevant, risk management is primarily concerned with protecting the business. Therefore, understanding the potential business impact of a risk scenario is the most critical factor for prioritization and decision-making." },
                { question: "A qualitative risk assessment is generally more ______ than a quantitative assessment.", answers: ["Subjective", "Expensive", "Time-consuming", "Accurate"], correct: 0, explanation: "Qualitative risk assessment relies on descriptive terms (high, medium, low) and expert judgment, making it inherently subjective compared to the numerical calculations of a quantitative assessment." },
                { question: "What is the primary purpose of a risk register?", answers: ["To track the security budget", "To list all of the organization's assets", "To serve as a central repository for all identified risks and their statuses", "To document the incident response plan"], correct: 2, explanation: "A risk register is a fundamental tool in risk management used to document and track risks, including their description, impact, likelihood, owner, and treatment plan, throughout their lifecycle." },
                { question: "The risk of a key supplier going out of business is an example of what kind of risk?", answers: ["Technical risk", "Operational risk", "Strategic risk", "Third-party risk"], correct: 3, explanation: "This is a classic example of third-party risk (or supply chain risk), where the actions or failures of an external entity can directly impact the organization." },
                { question: "Implementing a new firewall is an example of which risk response strategy?", answers: ["Avoidance", "Transfer", "Mitigation", "Acceptance"], correct: 2, explanation: "Risk mitigation involves taking action to reduce the likelihood or impact of a risk. A firewall is a security control implemented to mitigate the risk of unauthorized network access." },
                { question: "A risk assessment should be performed:", answers: ["Only once when a system is first deployed", "Only when an auditor requires it", "On a regular, periodic basis and when significant changes occur", "Only after a major security incident"], correct: 2, explanation: "Risk management is a continuous process. Assessments need to be done periodically (e.g., annually) and must also be triggered by significant changes to the environment, such as new technology, new business processes, or an evolving threat landscape." },
                { question: "If the Asset Value (AV) is $100,000 and the Exposure Factor (EF) is 25%, what is the Single Loss Expectancy (SLE)?", answers: ["$400,000", "$2,500", "$25,000", "$75,000"], correct: 2, explanation: "The formula for SLE is AV * EF. In this case, $100,000 * 0.25 = $25,000." },
                { question: "What is the primary goal of control monitoring?", answers: ["To ensure that security controls are operating as intended and remain effective over time", "To replace manual controls with automated ones", "To punish employees who bypass controls", "To reduce the number of controls in place"], correct: 0, explanation: "Control monitoring is the ongoing process of assessing the effectiveness of security controls to ensure they are working correctly and continue to be appropriate as the risk landscape changes." },
                { question: "A company decides not to launch a new mobile application because the security risks associated with customer data are too high. This is an example of risk:", answers: ["Mitigation", "Avoidance", "Transfer", "Acceptance"], correct: 1, explanation: "Risk avoidance is the strategy of eliminating the risk by deciding not to engage in the activity that creates the risk. In this case, the company avoids the risk by not launching the app." },
                { question: "A Key Risk Indicator (KRI) is a metric that:", answers: ["Measures the financial loss from a past incident", "Provides an early warning of a potential increase in risk", "Counts the number of security policies in place", "Tracks the completion of security awareness training"], correct: 1, explanation: "KRIs are predictive metrics designed to provide early signals that a risk may be emerging or increasing, allowing management to take proactive action before a loss event occurs. An example is a sudden spike in login failures." },
                { question: "The output of the risk assessment process is a critical input for the ______ process.", answers: ["Risk treatment", "Software development", "Hiring", "Marketing"], correct: 0, explanation: "Once risks have been identified and analyzed in the assessment phase, the results are used to inform the risk treatment (or risk response) process, where decisions are made on how to address each identified risk." },
                { question: "Threat modeling is typically performed during which phase of a system's lifecycle?", answers: ["Decommissioning", "Operation", "Design and Development", "Testing"], correct: 2, explanation: "Threat modeling is most effective when performed early in the lifecycle, during the design and development phase. This allows security considerations to be built into the system from the beginning, which is more effective and less costly than adding them later." },
                { question: "What is the primary difference between a risk assessment and a vulnerability assessment?", answers: ["A vulnerability assessment focuses only on external threats", "A risk assessment considers threats, vulnerabilities, and business impact, while a vulnerability assessment focuses only on identifying weaknesses", "They are the same thing", "A risk assessment is performed by auditors, while a vulnerability assessment is performed by developers"], correct: 1, explanation: "A vulnerability assessment is a component of a risk assessment. It is the technical process of finding weaknesses. A risk assessment is a broader management process that takes those vulnerabilities, considers the threats that could exploit them, and evaluates the potential business impact." },
                { question: "If the SLE for a server failure is $50,000 and it is expected to happen once every five years, what is the ALE?", answers: ["$250,000", "$50,000", "$10,000", "$5,000"], correct: 2, explanation: "The Annualized Rate of Occurrence (ARO) is 1/5, or 0.2. The formula for ALE is SLE * ARO. Therefore, $50,000 * 0.2 = $10,000." },
                { question: "The process of identifying and documenting the security controls of a third-party vendor is known as:", answers: ["Vendor risk management", "Contract negotiation", "Service level agreement", "Onboarding"], correct: 0, explanation: "Vendor risk management (or third-party risk management) is the comprehensive process of identifying, assessing, and mitigating the risks associated with outsourcing services or sharing data with external partners." },
                { question: "A risk matrix is used in qualitative risk assessment to:", answers: ["Calculate the exact financial cost of a risk", "Prioritize risks based on their likelihood and impact levels", "List all of the company's assets", "Track the progress of risk mitigation efforts"], correct: 1, explanation: "A risk matrix (or heat map) is a visual tool that plots the likelihood of a risk against its potential impact, allowing risks to be categorized (e.g., as low, medium, high) and prioritized for treatment." },
                { question: "Which of the following is the BEST source of information for identifying new and emerging threats?", answers: ["The company's internal help desk tickets", "Threat intelligence feeds and industry reports", "The marketing department's customer surveys", "The minutes from the last board meeting"], correct: 1, explanation: "Threat intelligence feeds (from government agencies, security vendors, and information sharing groups) are specifically designed to provide timely and actionable information about the latest threats, attack techniques, and threat actors." },
                { question: "The primary purpose of a cost-benefit analysis for a security control is to:", answers: ["Ensure the control is the most technically advanced option available", "Determine if the cost of the control is justified by the amount of risk it reduces", "Prove that the control will stop all possible attacks", "Satisfy a request from the sales team"], correct: 1, explanation: "A cost-benefit analysis is a fundamental step in risk treatment. It compares the cost of implementing a control (the 'cost') with the reduction in the ALE (the 'benefit') to ensure that security investments are financially sound." },
                { question: "What is the term for a threat that is initiated by an employee or other trusted insider?", answers: ["An advanced persistent threat (APT)", "A zero-day threat", "An insider threat", "A supply chain threat"], correct: 2, explanation: "An insider threat is a security risk that originates from within the organization, such as from a current or former employee, contractor, or business partner who has or had authorized access to the organization's network, systems, or data." },
                { question: "A company decides to continue using an old, unsupported operating system for a critical application because the cost of upgrading is prohibitive. This is an example of:", answers: ["Risk mitigation", "Risk avoidance", "Risk acceptance", "Risk transfer"], correct: 2, explanation: "This is a classic example of risk acceptance. The company is aware of the risks associated with the unsupported OS but has made a conscious, formal decision (based on cost) to accept that risk rather than mitigate it." },
                { question: "The likelihood of a threat exploiting a vulnerability is a key component in determining:", answers: ["The asset value", "The overall risk", "The cost of the control", "The recovery time objective"], correct: 1, explanation: "Risk is often defined as the intersection of a threat, a vulnerability, and the potential impact. The likelihood (or probability) of the threat successfully exploiting the vulnerability is a critical factor in calculating the level of risk." },
            ],
            'domain-3': [
                { question: "What is the primary purpose of a Security Operations Center (SOC)?", answers: ["To develop security policies", "To conduct security awareness training", "To monitor, detect, analyze, and respond to cybersecurity incidents", "To manage the security budget"], correct: 2, explanation: "A SOC is a centralized unit that deals with security issues on an organizational and technical level, focusing on the real-time monitoring and handling of security incidents." },
                { question: "Which of the following is a key component of an Incident Response Plan (IRP)?", answers: ["A list of all company assets", "The marketing department's contact list", "Communication protocols for stakeholders", "The company's mission statement"], correct: 2, explanation: "A critical part of any IRP is defining clear communication protocols to ensure that all relevant stakeholders (internal and external) are informed appropriately during an incident." },
                { question: "The main goal of a security awareness program is to:", answers: ["Ensure everyone in IT is a security expert", "Fulfill a compliance requirement", "Influence user behavior to reduce security risk", "Teach users how to write secure code"], correct: 2, explanation: "While compliance is a benefit, the primary goal is to change how users think about and act on security, making them a strong first line of defense and reducing human-related risks like falling for phishing scams." },
                { question: "Which of the following is the BEST metric to measure the effectiveness of a security awareness program?", answers: ["The number of people who completed the training", "The cost of the training program", "A reduction in the number of user-reported security incidents", "Positive feedback from employees about the training"], correct: 2, explanation: "The ultimate goal is behavior change that reduces risk. A decrease in successful phishing attacks or an increase in users correctly reporting suspicious emails is a direct measure of the program's impact on reducing risk." },
                { question: "What is the primary purpose of patch management?", answers: ["To add new features to software", "To reduce the attack surface by remediating known vulnerabilities", "To ensure all software is from the same vendor", "To monitor system performance"], correct: 1, explanation: "Patch management is a critical security process focused on identifying, testing, and deploying software updates (patches) to fix vulnerabilities that could otherwise be exploited by attackers." },
                { question: "In the context of identity and access management, the principle of 'least privilege' means:", answers: ["All users should have administrator rights", "Users should only be granted the minimum level of access necessary to perform their job functions", "Access should be granted based on seniority", "Users can choose their own access rights"], correct: 1, explanation: "Least privilege is a foundational security principle that limits user access rights to the bare minimum permissions they need to do their job. This minimizes the damage that can be done if an account is compromised." },
                { question: "What is the function of a Security Information and Event Management (SIEM) system?", answers: ["To automatically block all incoming network traffic", "To manage user passwords and access credentials", "To aggregate and analyze log data from multiple sources to identify security threats", "To encrypt all data on the network"], correct: 2, explanation: "A SIEM system is a powerful tool that collects security-related data from across the IT environment (e.g., firewalls, servers, applications) and uses correlation and analysis to detect potential threats and facilitate incident response." },
                { question: "When an organization outsources a service to a third-party vendor, who is ultimately accountable for the security of the data?", answers: ["The third-party vendor", "The organization", "The cloud provider", "The end users"], correct: 1, explanation: "An organization can delegate responsibility for security tasks, but it cannot outsource accountability. The organization that owns the data is always ultimately accountable for its protection, regardless of where it is stored or processed." },
                { question: "The purpose of performing a gap analysis against a security framework like ISO 27001 is to:", answers: ["Identify all potential threats to the organization", "Determine the difference between the current state of security controls and the framework's requirements", "Calculate the ROI of the security program", "Choose which vendor to purchase security tools from"], correct: 1, explanation: "A gap analysis is a formal review that compares an organization's existing security posture and controls against the requirements of a specific framework or standard to identify areas that are missing or need improvement." },
                { question: "Which of the following is the MOST secure method for multi-factor authentication (MFA)?", answers: ["Email-based one-time password", "SMS-based one-time password", "A push notification to a mobile app", "A FIDO2-compliant hardware security key"], correct: 3, explanation: "Hardware security keys (like a YubiKey) are considered the gold standard for MFA because they are resistant to phishing and man-in-the-middle attacks, unlike SMS or email, which can be intercepted." },
                { question: "What is the primary objective of change management in an IT environment?", answers: ["To ensure all changes are implemented as quickly as possible", "To prevent all changes to production systems", "To ensure that changes are authorized, tested, and documented to minimize risk", "To track the cost of all IT changes"], correct: 2, explanation: "Change management is a formal process designed to manage the risk associated with changes to IT systems. It ensures that every change is properly reviewed, approved, tested, and documented to prevent unintended outages or security vulnerabilities." },
                { question: "A penetration test is BEST described as a:", answers: ["Tool that automatically finds all vulnerabilities", "Method for testing the incident response plan", "Simulated cyber attack intended to identify and exploit vulnerabilities", "Review of security policies and procedures"], correct: 2, explanation: "A penetration test is an authorized, simulated attack on a computer system, performed to evaluate the security of the system by actively exploiting its weaknesses." },
                { question: "The main reason for segregating duties is to:", answers: ["Make processes more efficient", "Reduce the opportunity for a single individual to commit fraud or a malicious act", "Ensure that everyone knows how to do every job", "Lower the cost of training"], correct: 1, explanation: "Segregation of duties is a key internal control that prevents a single person from having the ability to both perpetrate and conceal fraud or an error. For example, the person who approves payments should not also be the person who issues them." },
                { question: "Which of the following is a primary benefit of data classification?", answers: ["It makes all data available to all employees", "It allows for the application of appropriate, cost-effective security controls", "It eliminates the need for backups", "It guarantees compliance with all regulations"], correct: 1, explanation: "By classifying data based on its sensitivity and criticality, an organization can apply the right level of security controls, avoiding the cost of over-protecting non-sensitive data and ensuring that the most valuable data gets the strongest protection." },
                { question: "In a public key infrastructure (PKI), what is the purpose of a Certificate Authority (CA)?", answers: ["To create the public and private keys for users", "To encrypt and decrypt messages", "To digitally sign and issue certificates, vouching for the identity of the certificate holder", "To store all the private keys in a secure location"], correct: 2, explanation: "The Certificate Authority is the trusted third party in a PKI system. Its primary role is to verify the identity of an entity (like a user or a website) and issue a digital certificate that binds that identity to a public key." },
                { question: "A vulnerability scan report shows a critical vulnerability on a server. What should be the security manager's FIRST step?", answers: ["Immediately shut down the server", "Purchase a new security tool", "Validate the finding and assess its business impact", "Ignore the finding if it is the first time it has appeared"], correct: 2, explanation: "Not all findings from automated scanners are true positives or represent a real risk in a specific environment. The first step is always to validate the vulnerability and then assess its potential impact on the business to determine the appropriate priority and response." },
                { question: "What is the purpose of an exit interview from a security perspective?", answers: ["To convince the employee to stay", "To ensure the return of all company assets and the termination of access rights", "To gather feedback on the company's cafeteria", "To offer the employee a severance package"], correct: 1, explanation: "From a security standpoint, the offboarding process is critical. An exit interview helps ensure that all assets (laptops, badges) are returned and, most importantly, that all of the employee's logical access to systems and data is revoked in a timely manner." },
                { question: "Which of the following is the MOST important factor for the success of an information security program?", answers: ["The size of the security budget", "The number of security certifications held by the staff", "The visible support and commitment of senior management", "The brand of the firewall being used"], correct: 2, explanation: "Without the clear and visible support of senior leadership (the 'tone at the top'), a security program will struggle to get the necessary resources, authority, and cultural adoption to be truly effective." },
                { question: "The process of hardening a server involves:", answers: ["Placing it in a physically secure data center", "Reducing its attack surface by disabling unnecessary services and accounts", "Installing antivirus software", "Backing up its data"], correct: 1, explanation: "Hardening is the process of securing a system by minimizing its surface of vulnerability. This typically involves removing non-essential software, disabling unused services, and configuring security settings to be as restrictive as possible." },
                { question: "What is the primary security concern with 'shadow IT'?", answers: ["It is always more expensive than approved IT solutions", "It introduces systems and services that are not managed or secured by the IT department", "It is difficult for users to learn", "It is usually against the law"], correct: 1, explanation: "Shadow IT refers to technology used within an organization without the knowledge or approval of the IT department. This creates significant risk because these systems are not subject to the organization's security policies, monitoring, or controls." },
                { question: "Which of the following BEST describes a defense-in-depth strategy?", answers: ["Using only one very strong security control", "Implementing security controls only at the network perimeter", "Layering multiple, different security controls to protect an asset", "Focusing exclusively on physical security"], correct: 2, explanation: "Defense-in-depth is the concept of protecting a system with a series of different defensive mechanisms. If one layer fails, another layer is already in place to thwart an attack." },
                { question: "The process of periodically reviewing user access rights to ensure they are still appropriate is known as:", answers: ["Access control", "Onboarding", "Access recertification", "Authentication"], correct: 2, explanation: "Access recertification (or attestation) is a crucial process where a user's manager or the data owner periodically reviews and re-approves their access rights to ensure they are still necessary for their job role, enforcing the principle of least privilege over time." },
                { question: "What is the primary purpose of network segmentation?", answers: ["To make the network faster", "To limit the impact of a security breach by isolating parts of the network", "To make it easier to assign IP addresses", "To reduce the cost of network hardware"], correct: 1, explanation: "Network segmentation involves dividing a network into smaller, isolated sub-networks. This contains threats, so if one segment is compromised, the attacker cannot easily move to other parts of the network." },
                { question: "Which of the following is a key activity in managing third-party security?", answers: ["Ignoring the vendor's security practices", "Conducting due diligence and regular security assessments of the vendor", "Assuming the vendor is secure because they are a large company", "Only signing one-year contracts"], correct: 1, explanation: "Effective third-party risk management requires performing initial due diligence to assess a vendor's security posture before signing a contract, and then conducting ongoing monitoring and assessments to ensure they remain secure throughout the relationship." },
                { question: "The 'AAA' in security stands for:", answers: ["Access, Authorization, and Administration", "Authentication, Authorization, and Accounting", "Audit, Assessment, and Analysis", "Asset, Attack, and Attacker"], correct: 1, explanation: "AAA is a fundamental framework for controlling access to resources. Authentication verifies who a user is, Authorization determines what they are allowed to do, and Accounting logs what they did." },
                { question: "What is the main purpose of a data loss prevention (DLP) system?", answers: ["To back up data in case of a disaster", "To encrypt all data on the network", "To identify, monitor, and protect sensitive data from being exfiltrated", "To detect malware on endpoints"], correct: 2, explanation: "DLP solutions are designed to enforce policies and prevent sensitive information (like credit card numbers or intellectual property) from leaving the organization's control, whether accidentally or maliciously." },
                { question: "A security architecture principle that advocates for simple and easy-to-understand designs is known as:", answers: ["Open design", "Economy of mechanism", "Fail-safe defaults", "Complete mediation"], correct: 1, explanation: "The principle of 'economy of mechanism' states that security mechanisms should be kept as simple and small as possible. Complex designs are harder to test, maintain, and prove secure." },
                { question: "Which of the following is the BEST way to handle sensitive data on a laptop that is being disposed of?", answers: ["Deleting the files", "Reformatting the hard drive", "Physically destroying the hard drive", "Donating the laptop to a charity"], correct: 2, explanation: "For highly sensitive data, physical destruction (e.g., shredding, degaussing) is the only method that provides 100% assurance that the data cannot be recovered. Deleting files and reformatting can often be reversed with forensic tools." },
                { question: "The purpose of a service level agreement (SLA) in the context of security is to:", answers: ["Define the specific, measurable security commitments of a service provider", "List all the employees at the service provider", "Guarantee 100% uptime", "Provide a discount on services"], correct: 0, explanation: "An SLA is a contractual commitment that defines the level of service a provider will deliver. From a security perspective, it should include specific, measurable metrics for things like uptime, incident response times, and patching timelines." },
                { question: "What is the MOST important reason for an organization to have a formal software development lifecycle (SDLC)?", answers: ["To ensure that all projects are completed on time", "To integrate security into every phase of development", "To allow developers to choose their own programming languages", "To reduce the amount of code that needs to be written"], correct: 1, explanation: "A secure SDLC involves building security into the entire development process, from requirements gathering and design to testing and deployment. This 'shift-left' approach is far more effective and less costly than trying to add security on at the end." },
            ],
            'domain-4': [
                { question: "In the context of Business Continuity Planning (BCP), what does Recovery Time Objective (RTO) define?", answers: ["The amount of data that can be lost", "The time it takes to write the BCP plan", "The target time within which a business process must be restored after a disaster", "The time it takes to detect an incident"], correct: 2, explanation: "RTO is a critical metric in BCP that defines the maximum acceptable downtime for a business process before significant negative impacts occur." },
                { question: "What is the main difference between a Business Continuity Plan (BCP) and a Disaster Recovery (DR) Plan?", answers: ["BCP is for natural disasters only, DR is for cyber attacks", "BCP focuses on keeping business processes running, while DR focuses on restoring IT infrastructure", "There is no difference", "BCP is managed by the business, DR is managed by the government"], correct: 1, explanation: "BCP has a broader scope, focusing on the continuity of critical business functions. DR is a subset of BCP, specifically focused on the technical recovery of IT systems and infrastructure." },
                { question: "What is the FIRST step in the incident response process?", answers: ["Eradication", "Containment", "Preparation", "Recovery"], correct: 2, explanation: "The incident response lifecycle begins with Preparation. This phase involves creating plans, training the team, and having the necessary tools in place before an incident ever occurs." },
                { question: "The Recovery Point Objective (RPO) is concerned with:", answers: ["The time it takes to recover a system", "The acceptable amount of data loss", "The number of people on the recovery team", "The location of the alternate site"], correct: 1, explanation: "RPO defines the maximum tolerable amount of data that can be lost from an IT service due to a major incident. It essentially determines the frequency of backups (e.g., an RPO of 1 hour requires hourly backups)." },
                { question: "During which phase of incident response would an analyst take an infected server offline?", answers: ["Detection and Analysis", "Containment", "Post-Incident Activity", "Preparation"], correct: 1, explanation: "Containment is the phase focused on stopping the spread of an incident and preventing further damage. Taking an infected server offline is a key containment strategy to isolate the threat." },
                { question: "The primary purpose of a Business Impact Analysis (BIA) is to:", answers: ["Identify and prioritize critical business functions and their dependencies", "Select a vendor for an alternate recovery site", "Document the steps to recover a specific server", "Test the incident response plan"], correct: 0, explanation: "The BIA is the foundation of business continuity planning. Its purpose is to identify the organization's most critical processes and the resources they depend on, which allows for the prioritization of recovery efforts." },
                { question: "What is a 'hot site' in the context of disaster recovery?", answers: ["A recovery site that is still under construction", "A fully equipped and configured data center that can be operational in minutes or hours", "An empty data center with power and cooling but no hardware", "A temporary office space for employees with no IT equipment"], correct: 1, explanation: "A hot site is the most expensive but fastest type of recovery site. It is a near-duplicate of the primary site with all necessary hardware, software, and network connectivity, ready to take over at a moment's notice." },
                { question: "After a security incident has been resolved, what is the MOST important activity to perform?", answers: ["Blame the responsible party", "Delete all logs related to the incident", "Conduct a lessons-learned review", "Immediately purchase a new security tool"], correct: 2, explanation: "The post-incident activity, or lessons-learned phase, is crucial for continuous improvement. It involves analyzing what happened, what worked, what didn't, and how the incident response process can be improved for the future." },
                { question: "Which of the following is the BEST way to test the effectiveness of a Disaster Recovery Plan?", answers: ["A tabletop exercise where the team discusses the plan", "A full-scale simulation that includes a failover to the alternate site", "A checklist review of the plan's contents", "Sending the plan to an auditor for review"], correct: 1, explanation: "While all are valid testing methods, a full-scale simulation provides the most realistic and comprehensive test of the DR plan's effectiveness, as it actually performs the recovery procedures and validates the capabilities of the alternate site." },
                { question: "The concept of 'chain of custody' is most critical when dealing with:", answers: ["Employee training records", "Financial reports", "Evidence handling during a forensic investigation", "Vendor contracts"], correct: 2, explanation: "Chain of custody is a formal, documented process that shows the chronological history of how evidence was collected, handled, transferred, and stored. Maintaining this chain is essential to ensure the integrity of the evidence and its admissibility in legal proceedings." },
                { question: "What is the primary goal of the 'Containment' phase in incident response?", answers: ["To determine the root cause of the incident", "To completely remove the threat from the environment", "To prevent the incident from causing further damage", "To restore normal operations"], correct: 2, explanation: "The immediate goal of containment is to stop the bleeding. It focuses on isolating the affected systems and preventing the incident from spreading and causing more harm to the organization." },
                { question: "A 'warm site' for disaster recovery is a location that has:", answers: ["Only basic office space", "All necessary hardware and data, ready for immediate failover", "Network connectivity and hardware, but requires software and data to be restored", "No equipment at all"], correct: 2, explanation: "A warm site is a compromise between a hot site and a cold site. It has the infrastructure (power, cooling, network) and hardware in place, but the most recent data and software must be loaded from backups, resulting in a longer recovery time than a hot site." },
                { question: "During a security incident, what should be the incident response team's highest priority?", answers: ["Preserving evidence for law enforcement", "Restoring services as quickly as possible", "Protecting human life and safety", "Communicating with the media"], correct: 2, explanation: "While all other items are important, the absolute, non-negotiable top priority during any incident or disaster is the safety and well-being of people." },
                { question: "Which of the following is an example of a 'tabletop' exercise?", answers: ["Failing over the entire data center to the DR site", "Restoring a single server from backup", "A discussion-based session where the team walks through the steps of a simulated incident", "A training course on how to use a fire extinguisher"], correct: 2, explanation: "A tabletop exercise is a meeting-based activity where team members review and discuss their roles and responsibilities in a particular emergency scenario without performing any actual technical actions. It's a great way to identify gaps in the plan." },
                { question: "The main purpose of forensic analysis after an incident is to:", answers: ["Determine who to fire", "Understand the root cause, scope, and methodology of the attack", "Quickly delete all malicious files", "Calculate the financial cost of the incident"], correct: 1, explanation: "Digital forensics is the process of investigating the incident to determine exactly what happened, how the attacker got in, what they did, and what data was affected. This information is crucial for proper remediation and future prevention." },
                { question: "What is the primary difference between an 'event' and an 'incident'?", answers: ["An event is malicious, while an incident is accidental", "An event is any observable occurrence in a system; an incident is an event that negatively impacts the business", "There is no difference", "An incident is a type of event that only affects servers"], correct: 1, explanation: "Systems generate thousands of 'events' every day (e.g., a user logging in). An 'incident' is a specific type of event, or a series of events, that has been identified as a security violation or a threat to business operations." },
                { question: "An organization's ability to withstand a disruptive event is known as:", answers: ["Risk appetite", "Resilience", "Forensics", "Vulnerability"], correct: 1, explanation: "Resilience is the capacity of an organization to endure and recover from deliberate attacks, accidents, or naturally occurring threats or incidents. It encompasses both business continuity and disaster recovery." },
                { question: "What is the MOST critical element for a successful Business Continuity Plan?", answers: ["The latest backup technology", "A detailed technical recovery guide for every system", "Support and approval from senior management", "A dedicated disaster recovery data center"], correct: 2, explanation: "Like any major strategic initiative, a BCP will fail without the buy-in, support, and resources that only senior management can provide. Their commitment is essential for the plan to be developed, tested, and maintained effectively." },
                { question: "During a disaster recovery test, the team discovers that a critical application cannot be restored within its RTO. What is the BEST course of action?", answers: ["Ignore the finding and hope it doesn't happen in a real disaster", "Modify the RTO to match what was achieved in the test", "Document the finding and develop a remediation plan to address the gap", "Blame the application vendor"], correct: 2, explanation: "The purpose of testing is to find and fix problems. The correct response is to formally document the gap between the required RTO and the tested capability, and then create a plan to fix the underlying issues so the RTO can be met in the future." },
                { question: "Why is it important to have a formal communications plan as part of incident management?", answers: ["To ensure that accurate and consistent information is shared with the correct stakeholders at the right time", "To prevent employees from using social media", "To write a press release before the incident is understood", "To satisfy a single audit requirement"], correct: 0, explanation: "During a crisis, misinformation can spread quickly. A communications plan ensures that all stakeholders (employees, customers, regulators, media) receive timely, accurate, and consistent updates, which helps to manage panic and maintain trust." },
                { question: "In incident response, what is the primary goal of the 'Eradication' phase?", answers: ["To remove the root cause of the incident and all malicious artifacts from the environment", "To isolate the affected systems from the network", "To notify law enforcement about the breach", "To conduct a lessons-learned meeting"], correct: 0, explanation: "Eradication is the phase where the incident response team actively removes the attacker's presence from the environment. This includes deleting malware, disabling breached user accounts, and fixing the exploited vulnerabilities." },
                { question: "A 'cold site' is a disaster recovery location that provides:", answers: ["A fully functional data center ready for immediate use", "Basic infrastructure like power, cooling, and space, but no IT hardware", "A mobile trailer with some networking equipment", "An exact replica of the primary site, including real-time data synchronization"], correct: 1, explanation: "A cold site is the most basic and least expensive type of recovery site. It offers the physical space and environmental controls, but the organization must bring in and configure its own hardware and restore its own data, resulting in the longest recovery time." },
                { question: "Which of the following determines the order in which systems should be recovered after a disaster?", answers: ["The Business Impact Analysis (BIA)", "The threat assessment", "The vulnerability scan report", "The IT department's budget"], correct: 0, explanation: "The BIA is the foundational document that identifies and prioritizes critical business processes. The recovery order of IT systems should directly support the recovery order of the business processes they enable, as determined by the BIA." },
                { question: "The process of securely preserving information from electronic devices in a way that is admissible in court is known as:", answers: ["Data backup", "E-discovery", "Data archiving", "System imaging"], correct: 1, explanation: "E-discovery (electronic discovery) is the process of identifying, collecting, and producing electronically stored information (ESI) in response to a legal request or investigation. It requires a formal, defensible process to ensure evidence integrity." },
                { question: "What is the primary purpose of an emergency operations center (EOC)?", answers: ["To store backup tapes", "To serve as a central command and control facility during an emergency", "To house the primary data center", "To provide temporary office space for all employees"], correct: 1, explanation: "An EOC is a physical or virtual location where leaders and response teams can gather during a crisis to coordinate response and recovery efforts, manage communications, and make strategic decisions." },
                { question: "Which of the following is the BEST description of a 'full interruption' test for a DR plan?", answers: ["A discussion about the plan in a conference room", "Restoring a few non-critical files from backup", "Shutting down the primary data center and failing over all operations to the recovery site", "A review of the plan's documentation for errors"], correct: 2, explanation: "A full interruption test is the most comprehensive and highest-fidelity type of DR test. It involves a real-world shutdown of primary systems and a complete failover to the disaster recovery site to validate the plan's effectiveness under realistic conditions." },
                { question: "In the context of incident response, what is a 'playbook'?", answers: ["The main incident response plan document", "A detailed, step-by-step guide for responding to a specific type of incident", "The contact list for the incident response team", "The report created after an incident is over"], correct: 1, explanation: "An incident response playbook provides a checklist-style, step-by-step set of instructions tailored to a specific type of incident, such as a ransomware attack or a data breach. It allows the team to respond more quickly and consistently." },
                { question: "The 'Recovery' phase of the incident response lifecycle focuses on:", answers: ["Identifying the attacker", "Isolating the affected systems", "Carefully restoring systems to normal operation and monitoring for re-infection", "Writing the final incident report"], correct: 2, explanation: "The recovery phase involves the methodical process of bringing affected systems back online, ensuring they are clean and secure, and then monitoring them closely to confirm that the threat has been fully eradicated and the systems are stable." },
                { question: "What is the primary security risk associated with a 'bring your own device' (BYOD) policy?", answers: ["Employees will be less productive", "The organization loses control over the security of the device and the data on it", "The cost of mobile data plans will increase", "Employees will install unapproved games"], correct: 1, explanation: "The main challenge with BYOD is that the organization does not own the device, making it difficult to enforce security policies, install security software, and protect corporate data that is stored on or accessed by the personal device." },
                { question: "A post-incident review should be conducted in a way that is:", answers: ["Focused on assigning blame to the responsible individual", "Blameless and focused on process and technology improvement", "Kept secret from everyone except senior management", "As short as possible"], correct: 1, explanation: "For a lessons-learned review to be effective, it must be conducted in a blameless environment where team members feel safe to discuss what went wrong without fear of punishment. The goal is to identify and fix weaknesses in processes and technology, not to blame individuals." },
            ],
        };

        const domainWeights = { 'domain-1': 0.17, 'domain-2': 0.20, 'domain-3': 0.33, 'domain-4': 0.30 };
        const domainDetails = {
            'domain-1': { title: "Domain 1: Information Security Governance", weight: 17 },
            'domain-2': { title: "Domain 2: Information Security Risk Management", weight: 20 },
            'domain-3': { title: "Domain 3: Information Security Program", weight: 33 },
            'domain-4': { title: "Domain 4: Incident Management", weight: 30 },
            'simulated-exam': { title: "Simulated Exam", totalQuestions: 150 }
        };
        let currentAssessment = { timerInterval: null };

        // --- DOM ELEMENTS (Scoped to the module) ---
        const setupView = moduleContainer.querySelector('#assessment-setup');
        const inProgressView = moduleContainer.querySelector('#assessment-in-progress');
        const resultsView = moduleContainer.querySelector('#assessment-results');
        const reviewView = moduleContainer.querySelector('#assessment-review');
        const optionsArea = moduleContainer.querySelector('#assessment-options-area');
        const tabs = moduleContainer.querySelectorAll('.assessment-tab');
        const questionCounter = moduleContainer.querySelector('#question-counter');
        const progressBar = moduleContainer.querySelector('#progress-bar');
        const questionText = moduleContainer.querySelector('#question-text');
        const answerOptionsContainer = moduleContainer.querySelector('#answer-options');
        const prevBtn = moduleContainer.querySelector('#prev-question-btn');
        const nextBtn = moduleContainer.querySelector('#next-question-btn');
        const submitBtn = moduleContainer.querySelector('#submit-assessment-btn');
        const quitBtn = moduleContainer.querySelector('#quit-assessment-btn');
        const timerDisplay = moduleContainer.querySelector('#timer-display');
        const finalScoreEl = moduleContainer.querySelector('#final-score');
        const scoreDetailsEl = moduleContainer.querySelector('#score-details');
        const resultsBreakdownEl = moduleContainer.querySelector('#results-breakdown');
        const reviewAnswersBtn = moduleContainer.querySelector('#review-answers-btn');
        const restartAssessmentBtn = moduleContainer.querySelector('#restart-assessment-btn');
        const quitModal = moduleContainer.querySelector('#quit-modal');
        const confirmQuitBtn = moduleContainer.querySelector('#confirm-quit-btn');
        const cancelQuitBtn = moduleContainer.querySelector('#cancel-quit-btn');

        // --- FUNCTIONS ---
        function showView(viewToShow) {
            [setupView, inProgressView, resultsView, reviewView].forEach(v => v.classList.add('hidden'));
            viewToShow.classList.remove('hidden');
            viewToShow.classList.add('fade-in');
        }

        function renderOptions(target) {
            const details = domainDetails[target];
            let content = '';
            if (target === 'simulated-exam') {
                content = `<div class="assessment-card p-6 sm:p-8 text-center"><h3 class="text-2xl font-bold text-gray-800 mb-2">${details.title}</h3><p class="text-gray-600 mb-4">This is a full-length simulated exam with ${details.totalQuestions} questions, weighted according to the official CISM exam outline.</p><ul class="text-left max-w-sm mx-auto list-disc list-inside mb-6"><li>Domain 1: ${Math.round(details.totalQuestions * domainWeights['domain-1'])} questions</li><li>Domain 2: ${Math.round(details.totalQuestions * domainWeights['domain-2'])} questions</li><li>Domain 3: ${Math.round(details.totalQuestions * domainWeights['domain-3'])} questions</li><li>Domain 4: ${Math.round(details.totalQuestions * domainWeights['domain-4'])} questions</li></ul><button class="btn-primary start-assessment-btn" data-type="simulated">Start Simulated Exam</button></div>`;
            } else {
                const maxQuestions = 30; // Set max to 30 as requested
                const weightedQuestions = Math.round(150 * domainWeights[target]);
                content = `<div class="assessment-card p-6 sm:p-8 text-center"><h3 class="text-2xl font-bold text-gray-800 mb-2">${details.title}</h3><p class="text-gray-600 mb-6">Choose how you want to test your knowledge for this domain.</p><div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div class="p-6 bg-gray-50 rounded-lg"><h4 class="text-xl font-semibold mb-3">Practice Quiz</h4><p class="text-sm text-gray-600 mb-4">Enter the number of questions you want to answer.</p><input type="number" id="question-count-input" class="w-full p-2 border border-gray-300 rounded-md mb-4 text-center" min="1" max="${maxQuestions}" value="10" placeholder="e.g., 10"><button class="btn-primary start-assessment-btn" data-type="custom" data-domain="${target}">Start Practice Quiz</button></div><div class="p-6 bg-gray-50 rounded-lg flex flex-col justify-between"><div><h4 class="text-xl font-semibold mb-3">Weighted Quiz</h4><p class="text-sm text-gray-600 mb-4">Take a quiz weighted like the real exam (${details.weight}% of 150 questions).</p><p class="text-2xl font-bold text-gray-800 mb-4">${weightedQuestions} Questions</p></div><button class="btn-primary start-assessment-btn" data-type="weighted" data-domain="${target}" data-count="${weightedQuestions}">Start Weighted Quiz</button></div></div></div>`;
            }
            optionsArea.innerHTML = content;
        }

        function stopTimer() {
            if (currentAssessment.timerInterval) {
                clearInterval(currentAssessment.timerInterval);
                currentAssessment.timerInterval = null;
            }
            timerDisplay.classList.add('hidden');
        }

        function startTimer() {
            stopTimer();
            const duration = 4 * 60 * 60 * 1000;
            const endTime = new Date().getTime() + duration;
            timerDisplay.classList.remove('hidden');
            currentAssessment.timerInterval = setInterval(() => {
                const distance = endTime - new Date().getTime();
                if (distance < 0) {
                    stopTimer();
                    timerDisplay.textContent = "0:00:00";
                    alert("Time's up! The exam will now be submitted.");
                    submitAssessment();
                    return;
                }
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                timerDisplay.textContent = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function startAssessment(questions, type) {
            currentAssessment = {
                questions: questions,
                userAnswers: new Array(questions.length).fill(null),
                currentQuestionIndex: 0,
                startTime: new Date(),
                assessmentType: type,
                timerInterval: currentAssessment.timerInterval
            };
            if (type === 'simulated') startTimer(); else stopTimer();
            displayQuestion();
            showView(inProgressView);
        }

        function displayQuestion() {
            const qData = currentAssessment.questions[currentAssessment.currentQuestionIndex];
            const qNum = currentAssessment.currentQuestionIndex + 1;
            const total = currentAssessment.questions.length;
            questionCounter.textContent = `Question ${qNum} of ${total}`;
            progressBar.style.width = `${(qNum / total) * 100}%`;
            questionText.textContent = qData.question;
            answerOptionsContainer.innerHTML = '';
            qData.answers.forEach((answer, index) => {
                const option = document.createElement('div');
                option.className = 'answer-option';
                option.textContent = answer;
                option.dataset.index = index;
                if (currentAssessment.userAnswers[currentAssessment.currentQuestionIndex] === index) {
                    option.classList.add('selected');
                }
                option.addEventListener('click', () => selectAnswer(index));
                answerOptionsContainer.appendChild(option);
            });
            prevBtn.classList.toggle('hidden', currentAssessment.currentQuestionIndex === 0);
            nextBtn.classList.toggle('hidden', qNum === total);
            submitBtn.classList.toggle('hidden', qNum !== total);
        }

        function selectAnswer(index) {
            currentAssessment.userAnswers[currentAssessment.currentQuestionIndex] = index;
            moduleContainer.querySelectorAll('.answer-option').forEach(opt => opt.classList.remove('selected'));
            moduleContainer.querySelector(`.answer-option[data-index='${index}']`).classList.add('selected');
        }

        function submitAssessment() {
            stopTimer();
            let correctCount = 0;
            let breakdown = {};
            currentAssessment.questions.forEach((q, index) => {
                const domain = q.domain || 'domain';
                if (!breakdown[domain]) breakdown[domain] = { correct: 0, total: 0 };
                breakdown[domain].total++;
                if (currentAssessment.userAnswers[index] === q.correct) {
                    correctCount++;
                    breakdown[domain].correct++;
                }
            });
            const totalQuestions = currentAssessment.questions.length;
            const score = totalQuestions > 0 ? Math.round((correctCount / totalQuestions) * 100) : 0;
            finalScoreEl.textContent = `${score}%`;
            scoreDetailsEl.textContent = `You answered ${correctCount} out of ${totalQuestions} questions correctly.`;
            resultsBreakdownEl.innerHTML = '';
            for (const domainKey in breakdown) {
                const domainData = breakdown[domainKey];
                const domainScore = domainData.total > 0 ? Math.round((domainData.correct / domainData.total) * 100) : 0;
                const title = domainDetails[domainKey]?.title || 'Overall';
                resultsBreakdownEl.innerHTML += `<div class="flex justify-between items-center mb-2"><span class="text-gray-700">${title}</span><span class="font-bold text-gray-800">${domainScore}% (${domainData.correct}/${domainData.total})</span></div>`;
            }
            showView(resultsView);
        }

        function reviewAnswers() {
            reviewView.innerHTML = '';
            const container = document.createElement('div');
            container.className = 'bg-white p-6 sm:p-8 rounded-lg shadow-md';
            let reviewContent = `<h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Review Answers</h2>`;
            currentAssessment.questions.forEach((q, index) => {
                const userAnswer = currentAssessment.userAnswers[index];
                const isCorrect = userAnswer === q.correct;
                reviewContent += `<div class="mb-8 pb-4 border-b border-gray-200"><p class="font-bold text-gray-800 mb-2">Question ${index + 1}: ${q.question}</p><div class="space-y-2">${q.answers.map((answer, ansIndex) => { let classes = 'answer-option p-3'; if (ansIndex === q.correct) classes += ' correct'; else if (ansIndex === userAnswer && !isCorrect) classes += ' incorrect'; return `<div class="${classes}">${answer}</div>`; }).join('')}</div>${userAnswer !== null && !isCorrect ? `<p class="mt-3 text-sm text-blue-800 bg-blue-100 p-2 rounded-md"><strong>Your Answer:</strong> ${q.answers[userAnswer]}</p>` : ''}<p class="mt-3 text-sm text-green-800 bg-green-100 p-2 rounded-md"><strong>Explanation:</strong> ${q.explanation}</p></div>`;
            });
            reviewContent += `<div class="text-center mt-8"><button id="back-to-results-btn" class="btn-primary">Back to Results</button></div>`;
            container.innerHTML = reviewContent;
            reviewView.appendChild(container);
            showView(reviewView);
            moduleContainer.querySelector('#back-to-results-btn').addEventListener('click', () => showView(resultsView));
        }

        function getQuestionsForAssessment(type, domain, count) {
            let questions = [];
            if (type === 'simulated') {
                for (const dKey in domainWeights) {
                    const numQuestions = Math.round(150 * domainWeights[dKey]);
                    const domainQs = [...questionBank[dKey]].map(q => ({...q, domain: dKey}));
                    questions.push(...(domainQs.sort(() => 0.5 - Math.random()).slice(0, numQuestions)));
                }
            } else {
                const numQuestions = (type === 'custom') ? moduleContainer.querySelector('#question-count-input').value : count;
                const domainQs = [...questionBank[domain]].map(q => ({...q, domain: domain}));
                questions = domainQs.sort(() => 0.5 - Math.random()).slice(0, numQuestions);
            }
            return questions;
        }

        // --- EVENT LISTENERS ---
        tabs.forEach(tab => tab.addEventListener('click', (e) => {
            tabs.forEach(t => t.classList.remove('active'));
            e.target.classList.add('active');
            renderOptions(e.target.dataset.target);
        }));

        optionsArea.addEventListener('click', (e) => {
            const button = e.target.closest('.start-assessment-btn');
            if (button) {
                const { type, domain, count } = button.dataset;
                const questions = getQuestionsForAssessment(type, domain, parseInt(count));
                if (questions.length > 0) {
                    startAssessment(questions, type);
                } else {
                    alert('Please enter a valid number of questions.');
                }
            }
        });

        nextBtn.addEventListener('click', () => changeQuestion(1));
        prevBtn.addEventListener('click', () => changeQuestion(-1));
        submitBtn.addEventListener('click', submitAssessment);
        
        quitBtn.addEventListener('click', () => {
            quitModal.classList.remove('hidden');
        });

        cancelQuitBtn.addEventListener('click', () => {
            quitModal.classList.add('hidden');
        });

        confirmQuitBtn.addEventListener('click', () => {
            stopTimer();
            quitModal.classList.add('hidden');
            showView(setupView);
        });
        
        reviewAnswersBtn.addEventListener('click', reviewAnswers);
        restartAssessmentBtn.addEventListener('click', () => {
             // Re-run the same assessment
             startAssessment(currentAssessment.questions, currentAssessment.assessmentType);
        });

        // --- INITIALIZATION ---
        renderOptions('domain-1');
    });
    </script>
</body>
</html>
