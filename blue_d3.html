<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CISM 2024: Domain 3 - Information Security Program Development and Management (Designer Edition)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Global Styles & Font Import */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@700;800&display=swap');

        :root {
            --dark-navy-bg: #0a101f;
            --surface-color: #10192b;
            --accent-glow: #00bfff; /* Deep Sky Blue */
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --border-color: #2d3748;
            --shadow-color: rgba(0, 191, 255, 0.1);
            --shadow-color-hover: rgba(0, 191, 255, 0.3);
            --transition-fast: all 0.3s ease-in-out;
            --color-red: #FF6384;
            --color-yellow: #FFCD56;
            --color-green: #4BC0C0;
            --color-purple: #9966FF;
            --color-orange: #DAA520;
            --color-blue-alt: #6A5ACD;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--dark-navy-bg);
            background-image: radial-gradient(circle at top, #10192b, var(--dark-navy-bg));
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-image: url('https://www.transparenttextures.com/patterns/subtle-noise.png');
            opacity: 0.03;
            pointer-events: none;
            z-index: -1;
        }
        
        .container {
            max-width: 1200px;
        }

        /* Header */
        header.main-header {
            background: linear-gradient(180deg, var(--surface-color), #0a101fcc);
            border-bottom: 1px solid var(--border-color);
            border-radius: 0.75rem;
            position: relative;
        }
        
        .header-glow {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 400px;
            height: 200px;
            background: var(--accent-glow);
            border-radius: 50%;
            filter: blur(100px);
            transform: translate(-50%, -50%);
            opacity: 0.1;
            animation: pulseGlow 8s infinite alternate;
            z-index: 0;
        }

        @keyframes pulseGlow {
            from { opacity: 0.05; transform: translate(-50%, -50%) scale(0.8); }
            to { opacity: 0.15; transform: translate(-50%, -50%) scale(1.2); }
        }

        header.main-header .header-content {
            position: relative;
            z-index: 1;
        }

        header.main-header h1 {
            font-family: 'Poppins', sans-serif;
            letter-spacing: 0.5px;
            text-shadow: 0 0 15px rgba(0, 191, 255, 0.2);
        }

        /* Main Content Area */
        main {
            background-color: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            overflow: hidden;
            padding: 2rem;
        }
        
        /* Section Header */
        .section-header {
            border-left: 6px solid var(--accent-glow);
            padding-left: 1.25rem;
            font-size: 2.5rem;
            font-family: 'Poppins', sans-serif;
            letter-spacing: 0.5px;
            color: var(--text-primary);
        }
        
        /* Navigation Tabs */
        nav.main-nav {
            background-color: rgba(16, 25, 43, 0.7); /* surface-color with transparency */
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
        }

        .nav-item {
            border: 2px solid transparent;
            border-radius: 0.5rem;
            transition: var(--transition-fast);
            position: relative;
            overflow: hidden;
            color: var(--text-secondary);
            font-weight: 600;
        }
        .nav-item:not(.active):hover {
            border-color: var(--accent-glow);
            background-color: rgba(0, 191, 255, 0.05);
            color: var(--text-primary);
        }
        .nav-item.active {
            background-color: var(--accent-glow);
            color: var(--dark-navy-bg);
            font-weight: 700;
            box-shadow: 0 0 20px var(--shadow-color);
        }

        /* Enhanced Fade-in Animation */
        .fade-in {
            animation: enhancedFadeIn 0.7s ease-out;
        }
        @keyframes enhancedFadeIn {
            from { opacity: 0; transform: translateY(25px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        /* General content box */
        .content-box {
            background-color: rgba(10, 16, 31, 0.5);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
        }
        
        .accordion-content ul {
            list-style-type: disc;
            padding-left: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        /* Accordion Styles */
        .accordion-button {
            background-color: var(--dark-navy-bg);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1rem 1.5rem;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            transition: var(--transition-fast);
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-align: left;
        }
        .accordion-button:hover {
            border-color: var(--accent-glow);
            background-color: rgba(0, 191, 255, 0.05);
        }
        .accordion-icon {
            transition: transform 0.3s ease-in-out;
        }
        .accordion-button.open .accordion-icon {
            transform: rotate(45deg);
        }
        .accordion-content {
            background-color: transparent;
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 0.75rem 0.75rem;
            padding: 1.5rem;
            margin-top: -0.75rem;
            animation: enhancedFadeIn 0.5s ease-in-out;
        }

        /* Unified Interactive Card Styles */
        .unified-card {
            background: rgba(10, 16, 31, 0.5);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            transition: var(--transition-fast);
            padding: 1.5rem;
            cursor: pointer;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 120px;
        }
        .unified-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 30px rgba(0,0,0,0.4), 0 0 25px var(--shadow-color-hover);
            border-color: var(--accent-glow);
        }
        .unified-card.active {
            border-color: var(--accent-glow);
            box-shadow: 0 0 25px var(--shadow-color-hover);
            background-color: rgba(0, 191, 255, 0.1);
            transform: scale(1.02);
        }
        .unified-card .card-title {
            font-size: 1.1em;
            font-weight: 700;
            margin-bottom: 0.6rem;
            color: var(--accent-glow);
            text-align: center;
            transition: var(--transition-fast);
        }
        .unified-card:hover .card-title {
            text-shadow: 0 0 8px var(--accent-glow);
        }
        .unified-card .card-description {
            font-weight: 400;
            font-size: 0.95em;
            color: var(--text-secondary);
            margin-top: 0.5rem;
            display: none;
            text-align: left;
            width: 100%;
        }
        .unified-card.active .card-description {
            display: block;
            animation: enhancedFadeIn 0.5s ease-in-out;
        }

        /* Policy Cycle & Flowchart Styles */
        .policy-cycle-container, .implementation-steps-container, .third-party-steps-container, .sdlc-cycle-container, .lifecycle-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }
        .policy-cycle-step, .implementation-step-card, .third-party-step-card, .sdlc-step-card, .lifecycle-step-card {
            width: 90%;
            max-width: 400px;
        }
        .step-arrow {
            font-size: 2em;
            color: var(--border-color);
            line-height: 1;
        }
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        /* Audience Grid */
        .audience-grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        .audience-circle {
            min-height: 150px;
        }

        /* Table Styles */
        .dark-table {
            width: 100%;
            border-collapse: collapse;
        }
        .dark-table th, .dark-table td {
            border: 1px solid var(--border-color);
            padding: 0.75rem;
            text-align: left;
        }
        .dark-table th {
            background-color: var(--dark-navy-bg);
            font-weight: 600;
            color: var(--text-primary);
        }
        .dark-table td {
            background-color: var(--surface-color);
            color: var(--text-secondary);
        }
        .dark-table .classification-level {
            font-weight: 700;
            color: var(--accent-glow);
        }
        .dark-table .business-impact {
            font-style: italic;
        }

        /* Form & Input Styles */
        .form-input {
            background-color: var(--dark-navy-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            border-radius: 0.5rem;
            padding: 0.5rem;
            transition: var(--transition-fast);
        }
        .form-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--accent-glow);
            border-color: var(--accent-glow);
        }
        .form-label {
            color: var(--text-secondary);
            font-weight: 600;
        }
        #allocationFeedback.text-red-600 { color: var(--color-red); }
        #allocationFeedback.text-green-600 { color: var(--color-green); }

        /* Chart Container */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            height: 40vh;
            margin: 1rem auto;
        }

    </style>
</head>
<body class="leading-relaxed">
    <div class="container mx-auto p-4 sm:p-6 lg:p-12">
        <header class="main-header text-center py-10 mb-10 overflow-hidden">
            <div class="header-glow"></div>
            <div class="header-content">
                <h1 class="text-4xl sm:text-5xl font-extrabold text-white mb-2">CISM Domain 3 Study Guide</h1>
                <p class="text-xl sm:text-2xl text-gray-400">Information Security Program Development and Management</p>
                <p class="text-md text-gray-500 mt-2">Crafting and Nurturing Your Organization's Security Posture</p>
            </div>
        </header>

        <nav class="main-nav p-2 rounded-lg mb-10 flex flex-wrap justify-center sticky top-4 z-10 gap-2 sm:gap-4">
            <button class="nav-item px-4 py-2 text-lg font-medium transition-colors duration-200 active" data-target="introduction">Introduction</button>
            <button class="nav-item px-4 py-2 text-lg font-medium transition-colors duration-200" data-target="program-development">Program Development</button>
            <button class="nav-item px-4 py-2 text-lg font-medium transition-colors duration-200" data-target="program-management">Program Management</button>
            <button class="nav-item px-4 py-2 text-lg font-medium transition-colors duration-200" data-target="key-terms">Key Terms</button>
            <button class="nav-item px-4 py-2 text-lg font-medium transition-colors duration-200" data-target="domain-summary">Domain Summary</button>
        </nav>

        <main id="content-area">
            <!-- Introduction Section -->
            <section id="introduction" class="content-section fade-in">
                <h2 class="text-3xl font-bold section-header mb-6">Introduction to CISM Domain 3</h2>
                <div class="content-box">
                    <p class="text-gray-300 mb-4">Welcome to the interactive study guide for CISM Domain 3: Information Security Program Development and Management. This domain is pivotal for aspiring and current information security managers, as it delves into the strategic and operational aspects required to build, implement, and maintain a robust information security program. Understanding this domain is crucial for aligning security initiatives with broader business objectives, ensuring that security is not just a technical function but an integral part of organizational governance.</p>
                    <p class="text-gray-300">Throughout this guide, you will explore key concepts such as resource allocation, information asset management, adherence to industry frameworks, policy development, and performance measurement. By mastering these areas, you will gain the expertise to effectively manage an organization's security posture, mitigate risks, and contribute significantly to its resilience in the face of evolving cyber threats. This interactive format is designed to enhance your learning experience, making complex topics more accessible and engaging.</p>
                </div>
            </section>

            <!-- Information Security Program Development Section -->
            <section id="program-development" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header mb-6">Section A: Information Security Program Development</h2>
                <p class="mb-8 text-gray-400">This section covers the essential planning and foundational activities required to build a security program from the ground up, ensuring it is aligned with the strategy defined in Domain 1. It is the blueprint for establishing a robust information security program. It focuses on strategic planning, resource allocation, and laying down the foundational elements that will govern security efforts across the organization.</p>

                <div class="space-y-4">
                    <!-- 3.A.1: Information Security Program Resources -->
                    <div>
                        <button class="accordion-button w-full">
                            <span>1. Information Security Program Resources (People, Tools, Technologies)</span>
                            <span class="accordion-icon text-2xl">+</span>
                        </button>
                        <div class="accordion-content hidden">
                            <p class="text-gray-300 mb-4">Before any security program can be implemented, it must be properly justified, chartered, and planned. This subsection deals with securing the essential elements needed for success: people, processes, and technology. It covers the creation of a business case to get funding and support, defining the program's authority and boundaries through a charter and scope, creating a roadmap for implementation, and integrating security into the entire lifecycle of systems development. Building an information security program requires the right blend of human capital, effective tools, and appropriate technologies. Proper resource allocation ensures the program has the necessary support to achieve its objectives.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">a. The Information Security Program</h4>
                            <p class="text-gray-400 mb-4">This is the execution of the security strategy. It's the combination of people, processes, and technology designed to protect the organization's information assets. Its purpose is to translate high-level goals into practical, enterprise-wide security controls.</p>

                            <h4 class="text-lg font-semibold text-white mb-3">b. Business Case, Scope, and Charter</h4>
                            <p class="text-gray-400 mb-4">The justification for the program, its authority, and its boundaries are defined here.</p>
                            <div class="card-grid">
                                <div class="unified-card" data-group="charter-scope" data-key="business-case"><span class="card-title">Business Case</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="charter-scope" data-key="charter"><span class="card-title">Charter and Scope</span><div class="card-description"></div></div>
                            </div>
                                
                            <h4 class="text-lg font-semibold text-white mb-3">c. Roadmap</h4>
                            <p class="text-gray-400 mb-4">A strategic plan that outlines the initiatives, timelines, and resources needed to achieve the program's objectives. It breaks the overall goal into smaller, manageable projects, allowing for adjustments as conditions change.</p>

                            <h4 class="text-lg font-semibold text-white mb-3">d. System Development Life Cycle (SDLC)</h4>
                            <p class="text-gray-400 mb-4">Security must be integrated into all phases of system development to be effective and cost-efficient. The CISM perspective emphasizes that building security in from the start ("shifting left") is far cheaper and less disruptive than trying to bolt it on after a system is built. The phases include:</p>
                               <div class="sdlc-cycle-container">
                                <div class="unified-card sdlc-step-card" data-group="sdlc-phases" data-key="initiation"><span class="card-title">Initiation</span><div class="card-description"></div></div>
                                <span class="step-arrow">↓</span>
                                <div class="unified-card sdlc-step-card" data-group="sdlc-phases" data-key="development"><span class="card-title">Development/Acquisition</span><div class="card-description"></div></div>
                                 <span class="step-arrow">↓</span>
                                <div class="unified-card sdlc-step-card" data-group="sdlc-phases" data-key="implementation"><span class="card-title">Implementation</span><div class="card-description"></div></div>
                                 <span class="step-arrow">↓</span>
                                <div class="unified-card sdlc-step-card" data-group="sdlc-phases" data-key="operations"><span class="card-title">Operations/Maintenance</span><div class="card-description"></div></div>
                                 <span class="step-arrow">↓</span>
                                <div class="unified-card sdlc-step-card" data-group="sdlc-phases" data-key="disposal"><span class="card-title">Disposal</span><div class="card-description"></div></div>
                            </div>

                            <h4 class="text-lg font-semibold text-white mb-3">e. Identify and allocate internal/external staff, tools, and technologies.</h4>
                            <p class="text-gray-400 mb-4">Effective resource planning is crucial. This involves assessing current capabilities and identifying where additional people, tools, or technologies are needed, aligning them with the program's scope and budget. Below is a simulation of budget allocation:</p>
                            <div class="content-box mb-6">
                                <h6 class="text-md font-semibold text-white mb-4 text-center">Simulated Security Budget Allocation</h6>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-4">
                                    <div class="md:col-span-1">
                                        <label for="totalBudgetInput" class="block form-label mb-1">Total Annual Budget ($):</label>
                                        <input type="text" id="totalBudgetInput" value="1,000,000" class="w-full form-input">
                                    </div>
                                    <div class="md:col-span-2">
                                        <p class="form-label mb-2">Allocate Percentages (Sum to 100%):</p>
                                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                            <div>
                                                <label for="peopleAllocation" class="block form-label text-sm mb-1">People (%):</label>
                                                <input type="number" id="peopleAllocation" value="40" min="0" max="100" step="1" class="w-full form-input text-center">
                                                <p class="text-sm text-gray-500 mt-1">$<span id="peopleAmount"></span></p>
                                            </div>
                                            <div>
                                                <label for="toolsAllocation" class="block form-label text-sm mb-1">Tools & Software (%):</label>
                                                <input type="number" id="toolsAllocation" value="30" min="0" max="100" step="1" class="w-full form-input text-center">
                                                <p class="text-sm text-gray-500 mt-1">$<span id="toolsAmount"></span></p>
                                            </div>
                                            <div>
                                                <label for="trainingAllocation" class="block form-label text-sm mb-1">Training (%):</label>
                                                <input type="number" id="trainingAllocation" value="15" min="0" max="100" step="1" class="w-full form-input text-center">
                                                <p class="text-sm text-gray-500 mt-1">$<span id="trainingAmount"></span></p>
                                            </div>
                                            <div>
                                                <label for="complianceAllocation" class="block form-label text-sm mb-1">Compliance (%):</label>
                                                <input type="number" id="complianceAllocation" value="15" min="0" max="100" step="1" class="w-full form-input text-center">
                                                <p class="text-sm text-gray-500 mt-1">$<span id="complianceAmount"></span></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <p id="allocationFeedback" class="text-sm font-semibold text-center mb-2"></p>
                                <div class="chart-container h-64 sm:h-72 md:h-80 lg:h-96">
                                    <canvas id="resourceAllocationChart"></canvas>
                                </div>
                                <p class="text-gray-500 text-sm italic mt-2 text-center">Adjust the percentages and total budget to see the allocation changes.</p>
                            </div>

                            <h4 class="text-lg font-semibold text-white mb-3">f. Align resources with organizational structure and program scope.</h4>
                            <p class="text-gray-400 mb-4">Security resources must be strategically positioned within the organization to maximize their effectiveness. This means understanding reporting lines, collaboration points, and the overall scope of the security program relative to business operations.</p>
                            <h4 class="text-lg font-semibold text-white mb-3">g. Ensure roles and responsibilities are defined and supported.</h4>
                            <p class="text-gray-400">Clear roles, documented responsibilities, and management support are vital. This ensures accountability and empowers security personnel to carry out their duties effectively, fostering a security-conscious culture.</p>
                        </div>
                    </div>

                    <!-- 3.A.2: Information Asset Identification and Classification -->
                    <div>
                        <button class="accordion-button w-full">
                            <span>2. Information Asset Identification and Classification</span>
                            <span class="accordion-icon text-2xl">+</span>
                        </button>
                        <div class="accordion-content hidden">
                            <p class="text-gray-300 mb-4">You cannot protect what you do not know you have. This subsection covers the critical first steps of any practical security effort: identifying what assets the organization owns, determining their value, and classifying them based on their sensitivity and criticality. This process drives all subsequent risk-based decisions and ensures that the most valuable assets receive the highest level of protection throughout their entire lifecycle.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">a. Information Life Cycle</h4>
                            <p class="text-gray-400 mb-4">Data has a lifecycle, and it must be protected at every stage.</p>
                               <div class="lifecycle-container">
                                <div class="unified-card lifecycle-step-card" data-group="lifecycle" data-key="creation"><span class="card-title">Creation</span><div class="card-description"></div></div>
                                 <span class="step-arrow">↓</span>
                                <div class="unified-card lifecycle-step-card" data-group="lifecycle" data-key="classification"><span class="card-title">Classification</span><div class="card-description"></div></div>
                                 <span class="step-arrow">↓</span>
                                <div class="unified-card lifecycle-step-card" data-group="lifecycle" data-key="storage"><span class="card-title">Storage</span><div class="card-description"></div></div>
                                 <span class="step-arrow">↓</span>
                                <div class="unified-card lifecycle-step-card" data-group="lifecycle" data-key="usage"><span class="card-title">Usage</span><div class="card-description"></div></div>
                                 <span class="step-arrow">↓</span>
                                <div class="unified-card lifecycle-step-card" data-group="lifecycle" data-key="archive"><span class="card-title">Archive</span><div class="card-description"></div></div>
                                 <span class="step-arrow">↓</span>
                                <div class="unified-card lifecycle-step-card" data-group="lifecycle" data-key="destruction"><span class="card-title">Destruction</span><div class="card-description"></div></div>
                            </div>

                            <h4 class="text-lg font-semibold text-white mb-3">b. Asset Classification and Valuation</h4>
                            <p class="text-gray-400 mb-4">This is the process of assigning value and sensitivity labels to assets.</p>
                            <div class="card-grid">
                                <div class="unified-card" data-group="asset-class" data-key="asset"><span class="card-title">Asset</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="asset-class" data-key="valuation"><span class="card-title">Valuation</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="asset-class" data-key="classification"><span class="card-title">Classification</span><div class="card-description"></div></div>
                            </div>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">c. Data Protection Technologies</h4>
                               <p class="text-gray-400 mb-4">These are systems designed to protect sensitive data based on its classification.</p>
                            <div class="card-grid">
                                <div class="unified-card" data-group="data-tech" data-key="dlp"><span class="card-title">Data Loss Prevention (DLP)</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="data-tech" data-key="drm"><span class="card-title">Digital Rights Management (DRM)</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="data-tech" data-key="casb"><span class="card-title">Cloud Access Security Broker (CASB)</span><div class="card-description"></div></div>
                            </div>

                            <h4 class="text-lg font-semibold text-white mb-3">d. Maintain an accurate inventory of data, systems, and infrastructure.</h4>
                            <p class="text-gray-400 mb-4">A comprehensive and up-to-date inventory is essential. This includes all forms of data (at rest, in transit, in processing), hardware, software, and network components, ensuring all critical assets are accounted for.</p>
                            <h4 class="text-lg font-semibold text-white mb-3">e. Apply classification based on business impact (e.g., confidentiality, criticality).</h4>
                            <p class="text-gray-400 mb-4">Information classification categorizes data based on its sensitivity, value, and the impact its compromise would have on the business (e.g., financial, reputational, legal). This drives control selection. See an example classification table below:</p>
                            <div class="content-box mb-6">
                                <h6 class="text-md font-semibold text-white mb-4 text-center">Sample Information Classification and Business Impact</h6>
                                <div class="overflow-x-auto">
                                    <table class="dark-table w-full">
                                        <thead>
                                            <tr>
                                                <th>Classification Level</th>
                                                <th>Confidentiality Impact</th>
                                                <th>Integrity Impact</th>
                                                <th>Availability Impact</th>
                                                <th>Handling Guidelines (Examples)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td class="classification-level">Public</td>
                                                <td>Low (No significant harm)</td>
                                                <td>Low</td>
                                                <td>Low</td>
                                                <td>Publicly shareable, no access restrictions.</td>
                                            </tr>
                                            <tr>
                                                <td class="classification-level">Internal Use</td>
                                                <td>Moderate (Minor business disruption)</td>
                                                <td>Moderate</td>
                                                <td>Moderate</td>
                                                <td>Share within organization, restricted external sharing.</td>
                                            </tr>
                                            <tr>
                                                <td class="classification-level">Confidential</td>
                                                <td>High (Significant business disruption, legal/financial impact)</td>
                                                <td>High</td>
                                                <td>High</td>
                                                <td>Restricted access to authorized personnel, encryption, strict audit trails.</td>
                                            </tr>
                                            <tr>
                                                <td class="classification-level">Restricted / Sensitive</td>
                                                <td>Severe (Critical business impact, severe legal/financial penalties)</td>
                                                <td>Severe</td>
                                                <td>Severe</td>
                                                <td>Highly restricted, need-to-know, strong encryption, multi-factor authentication, secure environments.</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <p class="text-gray-500 text-sm italic mt-2 text-center">Classification dictates the level of protection an asset requires.</p>
                            </div>
                            <h4 class="text-lg font-semibold text-white mb-3">f. Assign data ownership and handling guidelines.</h4>
                            <p class="text-gray-400">Assigning clear data ownership ensures accountability for protecting specific datasets. Data owners, typically business managers, define access rights and approve handling procedures, ensuring data is used and protected according to its classification.</p>
                        </div>
                    </div>

                    <!-- 3.A.3: Industry Standards and Frameworks -->
                    <div>
                        <button class="accordion-button w-full">
                            <span>3. Industry Standards and Frameworks for Information Security</span>
                            <span class="accordion-icon text-2xl">+</span>
                        </button>
                        <div class="accordion-content hidden">
                            <p class="text-gray-300 mb-4">A security manager does not need to create a program from scratch. This subsection explores the various industry standards and frameworks that provide established, repeatable models for building and managing a security program. The CISM exam will not require you to memorize the details of these frameworks, but you must understand their purpose and know when and why you would use them. Leveraging established frameworks provides a structured, recognized approach to designing and managing an information security program. They offer best practices and help ensure compliance and effectiveness.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">a. Framework Types</h4>
                            <p class="text-gray-400 mb-4">Frameworks provide structured models for building and managing a security program.</p>
                               <div class="card-grid">
                                <div class="unified-card" data-group="framework-types" data-key="control"><span class="card-title">Control Frameworks</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="framework-types" data-key="risk"><span class="card-title">Risk Management Frameworks</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="framework-types" data-key="program"><span class="card-title">Program Management Frameworks</span><div class="card-description"></div></div>
                            </div>
                                
                            <h4 class="text-lg font-semibold text-white mb-3">b. Enterprise Information Security Architecture (EISA)</h4>
                            <p class="text-gray-400 mb-4">The "security blueprint" for the entire organization. It aligns security requirements with business strategy and the IT infrastructure, ensuring a consistent and integrated approach.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">c. Use frameworks such as ISO/IEC 27001, NIST CSF, COBIT, TOGAF, and SABSA.</h4>
                            <p class="text-gray-400 mb-4">Each framework serves a distinct purpose, offering guidance for different aspects of information security management and governance. Click on a card to learn more about its primary use case:</p>
                            <div class="card-grid">
                                <div class="unified-card" data-group="framework" data-key="iso27001"><span class="card-title">ISO/IEC 27001</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="framework" data-key="nistcsf"><span class="card-title">NIST CSF</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="framework" data-key="cobit"><span class="card-title">COBIT</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="framework" data-key="togaf"><span class="card-title">TOGAF</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="framework" data-key="sabsa"><span class="card-title">SABSA</span><div class="card-description"></div></div>
                            </div>
                            <h4 class="text-lg font-semibold text-white mb-3">d. Align program practices with regulatory, business, and technical standards.</h4>
                            <p class="text-gray-400 mb-4">A well-designed security program integrates legal mandates, industry best practices, and internal business requirements. This ensures compliance, relevance, and operational efficiency.</p>
                            <h4 class="text-lg font-semibold text-white mb-3">e. Map frameworks to enterprise and security objectives.</h4>
                            <p class="text-gray-400">The chosen frameworks should not be implemented in isolation but explicitly mapped to the organization's strategic goals and security objectives. This demonstrates the business value of security initiatives.</p>
                        </div>
                    </div>

                    <!-- 3.A.4: Information Security Policies, Procedures, and Guidelines -->
                    <div>
                        <button class="accordion-button w-full">
                            <span>4. Information Security Policies, Procedures, and Guidelines</span>
                            <span class="accordion-icon text-2xl">+</span>
                        </button>
                        <div class="accordion-content hidden">
                            <p class="text-gray-300 mb-4">This subsection covers the hierarchy of documentation that governs the security program. These documents translate high-level management intent into specific, actionable instructions for the entire organization. Understanding the difference between these document types is essential for establishing clear and enforceable security rules.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">a. The Documentation Hierarchy</h4>
                            <p class="text-gray-400 mb-4">These documents translate high-level intent into specific instructions.</p>
                               <div class="card-grid">
                                <div class="unified-card" data-group="doc-hierarchy" data-key="policy"><span class="card-title">Policy</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="doc-hierarchy" data-key="standard"><span class="card-title">Standard</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="doc-hierarchy" data-key="procedure"><span class="card-title">Procedure</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="doc-hierarchy" data-key="guideline"><span class="card-title">Guideline</span><div class="card-description"></div></div>
                            </div>
                                
                            <h4 class="text-lg font-semibold text-white mb-3">b. Establish version control and review cycles.</h4>
                            <p class="text-gray-400 mb-4">Security documentation is dynamic. Implementing version control ensures consistency and auditability, while regular review cycles (e.g., annually, or after significant changes) keep them current and effective. See the continuous policy review cycle below:</p>
                            <div class="content-box mb-6">
                                <h6 class="text-md font-semibold text-white mb-4 text-center">Information Security Policy Review Cycle</h6>
                                <div class="policy-cycle-container">
                                    <div class="unified-card policy-cycle-step" data-group="policy-cycle" data-key="develop-update"><span class="card-title">Develop/Update Policy</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card policy-cycle-step" data-group="policy-cycle" data-key="review-approve"><span class="card-title">Review & Approve</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card policy-cycle-step" data-group="policy-cycle" data-key="communicate-implement"><span class="card-title">Communicate & Implement</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card policy-cycle-step" data-group="policy-cycle" data-key="monitor-enforce"><span class="card-title">Monitor & Enforce</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card policy-cycle-step" data-group="policy-cycle" data-key="audit-assess"><span class="card-title">Audit & Assess</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card policy-cycle-step" data-group="policy-cycle" data-key="identify-gaps"><span class="card-title">Identify Gaps/Changes</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↻</span>
                                </div>
                                <p class="text-gray-500 text-sm italic mt-2 text-center">Policies require a continuous lifecycle. Click on each step to learn more.</p>
                            </div>
                            <h4 class="text-lg font-semibold text-white mb-3">c. Ensure policies support compliance and are auditable.</h4>
                            <p class="text-gray-400">Policies must clearly align with regulatory requirements and industry standards. They should also be written in a way that allows for easy verification and auditing of compliance.</p>
                        </div>
                    </div>

                    <!-- 3.A.5: Information Security Program Metrics -->
                    <div>
                        <button class="accordion-button w-full">
                            <span>5. Information Security Program Metrics</span>
                            <span class="accordion-icon text-2xl">+</span>
                        </button>
                        <div class="accordion-content hidden">
                            <p class="text-gray-300 mb-4">"You can't manage what you can't measure." This subsection focuses on the critical process of developing and using metrics to assess the effectiveness of the security program. Good metrics demonstrate value to leadership, justify budgets, and identify areas for improvement.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">a. Effective Metrics (SMART)</h4>
                            <p class="text-gray-400 mb-4">Good metrics should be: Specific, Measurable, Achievable, Relevant, and Time-bound.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">b. Types of Metrics</h4>
                            <p class="text-gray-400 mb-4">Metrics are used to measure performance and progress toward goals.</p>
                               <div class="card-grid">
                                <div class="unified-card" data-group="metric-types" data-key="kpi"><span class="card-title">Key Performance Indicators (KPIs)</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="metric-types" data-key="kgi"><span class="card-title">Key Goal Indicators (KGIs)</span><div class="card-description"></div></div>
                               </div>
                                
                            <h4 class="text-lg font-semibold text-white mb-3">c. Tailoring Metrics to the Audience</h4>
                               <p class="text-gray-400 mb-4">Metrics must be relevant to who is receiving them.</p>
                               <div class="card-grid">
                                <div class="unified-card" data-group="metric-audience" data-key="strategic"><span class="card-title">Strategic (for Executives)</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="metric-audience" data-key="managerial"><span class="card-title">Managerial (for Program Managers)</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="metric-audience" data-key="operational"><span class="card-title">Operational (for Technical Teams)</span><div class="card-description"></div></div>
                               </div>

                            <h4 class="text-lg font-semibold text-white mb-3">d. Define KPIs (Key Performance Indicators)</h4>
                            <p class="text-gray-400 mb-4">KPIs assess the effectiveness of security activities and processes. They indicate whether the program is meeting its objectives. Examples include percentage of critical vulnerabilities patched on time, successful security awareness training completion rates, and incident response times.</p>
                            <h4 class="text-lg font-semibold text-white mb-3">e. Establish KRIs (Key Risk Indicators)</h4>
                            <p class="text-gray-400 mb-4">KRIs are forward-looking metrics that provide early warning signals of increasing risk exposure. They help proactive risk management by indicating potential future problems. Examples include a rising number of unpatched systems, an increase in successful phishing attacks, or repeated audit findings. View the trends for simulated KPIs and KRIs below:</p>
                            <div class="content-box">
                                <div class="chart-container mb-6">
                                    <canvas id="programMetricsChart"></canvas>
                                </div>
                                <div class="mb-4">
                                    <label for="programMetricSelect" class="block form-label mb-2">Select Metric Type to view trend:</label>
                                    <select id="programMetricSelect" class="block w-full p-2 form-input">
                                        <option value="kpiImplementationRate">Control Implementation Rate (KPI)</option>
                                        <option value="kpiTrainingParticipation">Training Participation Rate (KPI)</option>
                                        <option value="kriUnpatchedSystems">Unpatched Systems (KRI)</option>
                                        <option value="kriFailedAudits">Failed Audit Findings (KRI)</option>
                                    </select>
                                </div>
                                <p class="text-gray-500 text-sm italic text-center">This line chart illustrates simulated trends for various Key Performance Indicators (KPIs) and Key Risk Indicators (KRIs).</p>
                            </div>
                            <h4 class="text-lg font-semibold text-white mb-3">f. Use dashboards to report maturity, coverage, and gaps.</h4>
                            <p class="text-gray-400">Visual dashboards consolidate metrics, providing a clear and concise overview of the program's maturity, the extent of control coverage, and any existing gaps to senior management and other stakeholders.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Information Security Program Management Section -->
            <section id="program-management" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header mb-6">Section B: Information Security Program Management</h2>
                <p class="mb-8 text-gray-400">This section covers the ongoing operational activities required to run and maintain the security program developed in Part A. It focuses on the operational aspects of the information security program, from designing and implementing controls to ongoing monitoring, training, and managing external relationships.</p>

                <div class="space-y-4">
                    <!-- 3.B.1: Information Security Control Design and Selection -->
                    <div>
                        <button class="accordion-button w-full">
                            <span>1. Information Security Control Design and Selection</span>
                            <span class="accordion-icon text-2xl">+</span>
                        </button>
                        <div class="accordion-content hidden">
                            <p class="text-gray-300 mb-4">This subsection delves into the process of choosing the right security controls. It emphasizes a balanced approach that considers people, processes, and technology. The focus is not just on the technical effectiveness of a control, but also on its cost, its impact on user productivity, and its fit within the overall security architecture.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">a. Balance People, Process, and Technology</h4>
                            <p class="text-gray-400 mb-4">A successful program balances all three. You can have the best technology in the world, but it will fail if the people aren't trained and the processes are not followed.</p>

                            <h4 class="text-lg font-semibold text-white mb-3">b. Define Control Objectives</h4>
                            <p class="text-gray-400 mb-4">A clear statement of what a control is meant to achieve. Example: "The objective of our access control system is to ensure that only authorized users can access sensitive data."</p>

                            <h4 class="text-lg font-semibold text-white mb-3">c. Use Control Selection Criteria</h4>
                            <div class="card-grid">
                               <div class="unified-card" data-group="control-criteria" data-key="cost"><span class="card-title">Cost-Effectiveness</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="control-criteria" data-key="productivity"><span class="card-title">Productivity Impact</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="control-criteria" data-key="scalability"><span class="card-title">Scalability & Adaptability</span><div class="card-description"></div></div>
                            </div>

                            <h4 class="text-lg font-semibold text-white mb-3">d. Identify appropriate administrative, technical, and physical controls based on risk analysis.</h4>
                            <p class="text-gray-400 mb-4">Control selection is a risk-driven process. Controls should directly address identified threats and vulnerabilities. Click on a control type to see examples:</p>
                            <div class="card-grid">
                                <div class="unified-card" data-group="control-type" data-key="administrative"><span class="card-title">Administrative</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="control-type" data-key="technical"><span class="card-title">Technical</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="control-type" data-key="physical"><span class="card-title">Physical</span><div class="card-description"></div></div>
                            </div>
                            <h4 class="text-lg font-semibold text-white mb-3">e. Incorporate layered defense (defense-in-depth) and compensating controls where needed.</h4>
                            <p class="text-gray-400 mb-4">These are crucial strategies for building resilient security. Click on each card to learn more:</p>
                            <div class="card-grid">
                                <div class="unified-card" data-group="control-concept" data-key="defense-in-depth"><span class="card-title">Defense-in-Depth</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="control-concept" data-key="compensating-controls"><span class="card-title">Compensating Controls</span><div class="card-description"></div></div>
                            </div>
                        </div>
                    </div>

                    <!-- 3.B.2: Information Security Control Integration and Implementation -->
                    <div>
                        <button class="accordion-button w-full">
                            <span>2. Information Security Control Integration and Implementation</span>
                            <span class="accordion-icon text-2xl">+</span>
                        </button>
                        <div class="accordion-content hidden">
                            <p class="text-gray-300 mb-4">Once controls are selected, they must be implemented correctly and integrated into the fabric of the organization's IT and business processes. This subsection covers the different categories and types of controls and emphasizes the importance of embedding security into core processes like change management and system development.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">a. Understand Control Categories and Types</h4>
                            <div class="card-grid">
                               <div class="unified-card" data-group="control-cats-types" data-key="categories"><span class="card-title">Control Categories</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="control-cats-types" data-key="types"><span class="card-title">Control Types (by function)</span><div class="card-description"></div></div>
                            </div>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">b. Integrate with IT Processes</h4>
                            <p class="text-gray-400 mb-4">Security cannot operate in a silo. It must be integrated into:</p>
                            <div class="card-grid">
                               <div class="unified-card" data-group="it-processes" data-key="devsecops"><span class="card-title">DevSecOps</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="it-processes" data-key="change"><span class="card-title">Change Management</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="it-processes" data-key="config"><span class="card-title">Configuration Management</span><div class="card-description"></div></div>
                            </div>

                               <h4 class="text-lg font-semibold text-white mb-3">c. Implement selected controls into operational systems, processes, and third-party environments.</h4>
                            <p class="text-gray-400 mb-4">Implementation involves configuring technical solutions, embedding security into workflows, and extending security requirements to external partners. Key steps include:</p>
                            <div class="content-box mb-6">
                                <h6 class="text-md font-semibold text-white mb-4 text-center">Control Implementation Steps</h6>
                                <div class="implementation-steps-container">
                                    <div class="unified-card implementation-step-card" data-group="implementation-step" data-key="planning-design"><span class="card-title">1. Planning & Design</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card implementation-step-card" data-group="implementation-step" data-key="technical-deployment"><span class="card-title">2. Technical Deployment</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card implementation-step-card" data-group="implementation-step" data-key="process-embedding"><span class="card-title">3. Process Embedding</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card implementation-step-card" data-group="implementation-step" data-key="third-party-coordination"><span class="card-title">4. Third-Party Coordination</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card implementation-step-card" data-group="implementation-step" data-key="testing-validation"><span class="card-title">5. Testing & Validation</span><div class="card-description"></div></div>
                                </div>
                                <p class="text-gray-500 text-sm italic mt-4 text-center">A structured approach ensures successful control integration. Click on each step to learn more.</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 3.B.3: Information Security Control Testing and Evaluation -->
                    <div>
                        <button class="accordion-button w-full">
                            <span>3. Information Security Control Testing and Evaluation</span>
                            <span class="accordion-icon text-2xl">+</span>
                        </button>
                        <div class="accordion-content hidden">
                            <p class="text-gray-300 mb-4">Implementing a control is not a "fire and forget" activity. This subsection covers the continuous process of testing and evaluating controls to ensure they are working as intended and remain effective over time.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">a. Understand Control Strength</h4>
                            <p class="text-gray-400 mb-4">This is a measure of how well a control resists threats. It's a balance between:</p>
                            <div class="card-grid">
                               <div class="unified-card" data-group="control-strength" data-key="inherent"><span class="card-title">Inherent Strength</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="control-strength" data-key="practical"><span class="card-title">Practical Strength</span><div class="card-description"></div></div>
                            </div>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">b. Test controls for effectiveness, reliability, and coverage.</h4>
                            <p class="text-gray-400 mb-4">Various testing methods are used to validate controls, such as internal audits, penetration testing, and vulnerability scanning. Click on a method to learn more:</p>
                            <div class="card-grid">
                                <div class="unified-card" data-group="control-testing" data-key="internal-audits"><span class="card-title">Internal Audits</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="control-testing" data-key="penetration-testing"><span class="card-title">Penetration Testing</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="control-testing" data-key="vulnerability-scanning"><span class="card-title">Vulnerability Scanning</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="control-testing" data-key="security-assessments"><span class="card-title">Security Assessments</span><div class="card-description"></div></div>
                            </div>
                        </div>
                    </div>

                    <!-- 3.B.4: Information Security Awareness and Training -->
                    <div>
                        <button class="accordion-button w-full">
                            <span>4. Information Security Awareness and Training</span>
                            <span class="accordion-icon text-2xl">+</span>
                        </button>
                        <div class="accordion-content hidden">
                            <p class="text-gray-300 mb-4">Employees are often described as the "human firewall" and can be either the strongest or weakest link in the security chain. This subsection covers the critical task of creating and maintaining a program to educate users, reduce human error, and build a security-aware culture.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">a. Define Goals and Use Role-Based Training</h4>
                            <p class="text-gray-400 mb-4">The goal is to embed security consciousness into daily tasks and organizational culture. Training content must be tailored to roles:</p>
                            <div class="card-grid">
                               <div class="unified-card" data-group="role-training" data-key="all"><span class="card-title">All Employees</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="role-training" data-key="execs"><span class="card-title">Executives</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="role-training" data-key="admins"><span class="card-title">IT Admins</span><div class="card-description"></div></div>
                            </div>
                                
                               <h4 class="text-lg font-semibold text-white mb-3">b. Measure Effectiveness with Behavioral Metrics</h4>
                               <p class="text-gray-400 mb-4">The success of a training program is not measured by completion rates, but by behavioral change.</p>
                               <ul>
                                   <li><strong>Good Metric:</strong> A decrease in the click-rate on phishing simulations.</li>
                                   <li><strong>Bad Metric:</strong> "100% of employees completed the training."</li>
                               </ul>

                            <h4 class="text-lg font-semibold text-white mb-3">c. Use varied delivery methods.</h4>
                            <p class="text-gray-400 mb-4">Diverse delivery methods (e.g., eLearning, simulations, briefings) improve engagement and retention. Click on a method to see its characteristics:</p>
                            <div class="card-grid">
                                <div class="unified-card" data-group="training-method" data-key="elearning"><span class="card-title">eLearning Modules</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="training-method" data-key="simulations"><span class="card-title">Simulations</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="training-method" data-key="briefings"><span class="card-title">Live Briefings</span><div class="card-description"></div></div>
                                <div class="unified-card" data-group="training-method" data-key="gamification"><span class="card-title">Gamification</span><div class="card-description"></div></div>
                            </div>
                        </div>
                    </div>

                    <!-- 3.B.5: Management of External Services -->
                    <div>
                        <button class="accordion-button w-full">
                            <span>5. Management of External Services</span>
                            <span class="accordion-icon text-2xl">+</span>
                        </button>
                        <div class="accordion-content hidden">
                            <p class="text-gray-300 mb-4">An organization's security posture is only as strong as its weakest link, which often includes third-party vendors and service providers. This subsection covers the process of managing the risks associated with outsourcing and external relationships. The key principle is: You can outsource the responsibility, but you can never outsource the accountability for security.</p>
                            
                            <h4 class="text-lg font-semibold text-white mb-3">a. Use Vendor Due Diligence and Contractual Clauses</h4>
                            <p class="text-gray-400 mb-4">Assessing a vendor's security posture before signing a contract is critical. The contract is the primary tool for enforcing security requirements on a vendor. Key clauses include:</p>
                            <div class="card-grid">
                               <div class="unified-card" data-group="vendor-clauses" data-key="sla"><span class="card-title">Service Level Agreements (SLAs)</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="vendor-clauses" data-key="audit"><span class="card-title">Right to Audit</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="vendor-clauses" data-key="ownership"><span class="card-title">Data Ownership and Return</span><div class="card-description"></div></div>
                            </div>

                            <h4 class="text-lg font-semibold text-white mb-3">b. Conduct risk assessments and due diligence for vendors, MSPs, and cloud providers.</h4>
                            <p class="text-gray-400 mb-4">Before engaging external services, perform thorough risk assessments and due diligence to evaluate their security posture and capabilities. Key steps include:</p>
                            <div class="content-box mb-6">
                                <h6 class="text-md font-semibold text-white mb-4 text-center">Third-Party Risk Assessment Steps</h6>
                                <div class="third-party-steps-container">
                                    <div class="unified-card third-party-step-card" data-group="third-party-step" data-key="scoping"><span class="card-title">1. Vendor Scoping</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card third-party-step-card" data-group="third-party-step" data-key="vetting"><span class="card-title">2. Initial Vetting</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card third-party-step-card" data-group="third-party-step" data-key="assessment"><span class="card-title">3. Security Assessment</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card third-party-step-card" data-group="third-party-step" data-key="contractual"><span class="card-title">4. Contractual Agreement</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card third-party-step-card" data-group="third-party-step" data-key="monitoring"><span class="card-title">5. Ongoing Monitoring</span><div class="card-description"></div></div>
                                    <span class="step-arrow">↓</span>
                                    <div class="unified-card third-party-step-card" data-group="third-party-step" data-key="exit"><span class="card-title">6. Exit Strategy</span><div class="card-description"></div></div>
                                </div>
                                <p class="text-gray-500 text-sm italic mt-4 text-center">A structured approach for managing third-party security risks. Click on each step to learn more.</p>
                            </div>
                        </div>
                    </div>

                    <!-- 3.B.6: Information Security Program Communications and Reporting -->
                    <div>
                        <button class="accordion-button w-full">
                            <span>6. Information Security Program Communications and Reporting</span>
                            <span class="accordion-icon text-2xl">+</span>
                        </button>
                        <div class="accordion-content hidden">
                            <p class="text-gray-300 mb-4">This final subsection focuses on the ongoing task of communicating the program's status and effectiveness to all stakeholders. This involves evaluating the program's performance, using structured models like the Plan-Do-Check-Act cycle for continuous improvement, and tailoring reports for different audiences.</p>

                            <h4 class="text-lg font-semibold text-white mb-3">a. Use the Plan-Do-Check-Act (PDCA) Cycle</h4>
                            <p class="text-gray-400 mb-4">A four-step model for continuous improvement:</p>
                            <div class="card-grid">
                               <div class="unified-card" data-group="pdca-cycle" data-key="plan"><span class="card-title">Plan</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="pdca-cycle" data-key="do"><span class="card-title">Do</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="pdca-cycle" data-key="check"><span class="card-title">Check</span><div class="card-description"></div></div>
                               <div class="unified-card" data-group="pdca-cycle" data-key="act"><span class="card-title">Act</span><div class="card-description"></div></div>
                            </div>
                                
                               <h4 class="text-lg font-semibold text-white mb-3">b. Conduct Regular Program Evaluation</h4>
                               <p class="text-gray-400 mb-4">Regularly assessing the program against its objectives, checking for alignment with business goals, and ensuring it has sufficient financial, human, and technical resources to be successful.</p>

                            <h4 class="text-lg font-semibold text-white mb-3">c. Tailor communication to technical and non-technical audiences.</h4>
                            <p class="text-gray-400 mb-4">The level of detail and language used should vary based on the audience. Executives need high-level business impact, while technical teams require granular data. Click on an audience type to see what kind of communication they typically need:</p>
                            <div class="content-box mb-6">
                                <h6 class="text-md font-semibold text-white mb-4 text-center">Tailoring Security Communications to Audiences</h6>
                                <div class="audience-grid-container">
                                    <div class="unified-card audience-circle" data-group="audience" data-key="executive"><span class="card-title">Executives & Board</span><div class="card-description"></div></div>
                                    <div class="unified-card audience-circle" data-group="audience" data-key="technical"><span class="card-title">Technical Teams</span><div class="card-description"></div></div>
                                    <div class="unified-card audience-circle" data-group="audience" data-key="endUsers"><span class="card-title">End Users</span><div class="card-description"></div></div>
                                    <div class="unified-card audience-circle" data-group="audience" data-key="legalCompliance"><span class="card-title">Legal & Compliance</span><div class="card-description"></div></div>
                                </div>
                                <p class="text-gray-500 text-sm italic mt-4 text-center">Effective communication adapts to the recipient's role and information needs. Click on each circle to learn more.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Key Terms Section -->
            <section id="key-terms" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header mb-6">Key Terms</h2>
                <p class="mb-8 text-gray-400">Test your knowledge of key terms in Information Security Program Development and Management with these interactive flashcards. Click on a card to reveal its definition.</p>
                <div id="key-terms-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
                    <!-- Key terms will be dynamically inserted here by JavaScript -->
                </div>
            </section>

            <!-- Domain Summary Section -->
            <section id="domain-summary" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header mb-6">Domain Summary</h2>
                <div class="content-box">
                    <p class="text-gray-300 mb-4">Domain 3: Information Security Program is the most extensive domain in the CISM framework and focuses on establishing, implementing, and managing an information security program that effectively supports the organization's security strategy. It encompasses building and maintaining policies, procedures, and standards that reflect business goals and risk treatment decisions. This domain emphasizes the importance of asset identification and classification, resource planning, control selection, awareness training, and performance measurement to ensure the program is structured, repeatable, and aligned with enterprise needs.</p>
                    <p class="text-gray-300">The domain also covers operational integration—ensuring that security is embedded into day-to-day business processes and across functional areas such as HR, IT, and procurement. Managing third-party relationships, enforcing service-level agreements (SLAs), and continuously improving the program based on key performance indicators (KPIs) and audit findings are essential aspects. Ultimately, Domain 3 ensures that the information security program is not just a collection of policies or tools but a well-governed, adaptable system that delivers measurable value, enables compliance, and strengthens enterprise security posture across all layers of the organization.</p>
                </div>
            </section>
        </main>

        <footer class="text-center py-8 mt-10 text-gray-500 text-sm">
            <p>&copy; 2024 CISM Study Guide. All rights reserved. For educational purposes.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- CONFIG & DATA ---
            const textPrimary = '#e2e8f0';
            const textSecondary = '#94a3b8';
            const borderColor = '#2d3748';
            const surfaceColor = '#10192b';
            const chartColors = {
                red: '#FF6384',
                yellow: '#FFCD56',
                green: '#4BC0C0',
                purple: '#9966FF',
                orange: '#DAA520',
                blue_alt: '#6A5ACD',
                cyan: '#00bfff'
            };

            const resourceAllocationData = {
                labels: ['People', 'Tools', 'Training', 'Compliance'],
                colors: [chartColors.cyan, chartColors.green, chartColors.yellow, chartColors.purple]
            };

            const programMetricsTrendData = {
                kpiImplementationRate: { label: 'Control Implementation Rate (%)', data: [70, 75, 80, 85, 88, 90, 92, 93, 94, 95, 96, 97], borderColor: chartColors.cyan, backgroundColor: 'rgba(0, 191, 255, 0.2)' },
                kpiTrainingParticipation: { label: 'Training Participation Rate (%)', data: [60, 65, 70, 72, 75, 78, 80, 82, 85, 87, 88, 89], borderColor: chartColors.green, backgroundColor: 'rgba(75, 192, 192, 0.2)' },
                kriUnpatchedSystems: { label: 'Unpatched Systems (KRI)', data: [20, 18, 15, 12, 10, 8, 7, 6, 5, 4, 3, 2], borderColor: chartColors.red, backgroundColor: 'rgba(255, 99, 132, 0.2)' },
                kriFailedAudits: { label: 'Failed Audit Findings (KRI)', data: [5, 4, 3, 3, 2, 2, 1, 1, 1, 0, 0, 0], borderColor: chartColors.yellow, backgroundColor: 'rgba(255, 205, 86, 0.2)' }
            };
            const programMetricsLabels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

            const contentData = {
                'charter-scope': {
                    'business-case': "The justification for the security program, linking security initiatives to business objectives. It should include a problem statement, proposed solution, cost-benefit analysis (e.g., ROI, risk reduction), and alignment with strategic goals to secure executive buy-in and funding.",
                    'charter': "A formal document that authorizes the information security program, grants the CISM authority, outlines the program's objectives and scope, and is approved by senior management. It is the program's foundational mandate."
                },
                'sdlc-phases': {
                    'initiation': 'During this initial phase, security requirements are defined alongside business requirements. This includes conducting an initial risk assessment, a privacy impact assessment (PIA), and establishing security checkpoints or gates for the project.',
                    'development': 'In this phase, security is built into the system. Key activities include threat modeling to identify potential attack vectors, following secure coding standards, and using Static Application Security Testing (SAST) tools to find vulnerabilities in code.',
                    'implementation': 'Before going live, controls are tested and validated. This includes secure configuration of the system, Dynamic Application Security Testing (DAST) on the running application, and security-focused User Acceptance Testing (UAT).',
                    'operations': 'Once deployed, the system enters a continuous monitoring phase. This involves ongoing vulnerability management, timely patch application, log monitoring for security events, and ensuring the system is part of the incident response plan.',
                    'disposal': 'At the end of a system’s life, it must be decommissioned securely. This includes following data retention policies, using secure methods to destroy data (e.g., cryptographic erasure, physical destruction), and securely removing the asset from the inventory.'
                },
                'lifecycle': {
                    'creation': "The point where data is first generated or received. At this stage, data ownership should be assigned, and initial handling requirements based on predicted sensitivity should be applied.",
                    'classification': "Data is formally evaluated and assigned a sensitivity label (e.g., Public, Internal, Confidential) based on a Business Impact Analysis (BIA). This classification dictates all future protection requirements.",
                    'storage': "Protecting data 'at rest.' This involves using controls like full-disk encryption, database encryption, and strict access control lists (ACLs) to prevent unauthorized access to stored data.",
                    'usage': "Protecting data 'in motion' (e.g., using TLS/IPsec for network traffic) and 'in use' (e.g., in system memory, which is harder to protect). Controls focus on secure protocols and endpoint security.",
                    'archive': "Storing data long-term for business or regulatory compliance. This requires ensuring the storage media remains secure and readable, and that data can be retrieved if needed.",
                    'destruction': "The permanent and irreversible removal of data once it is no longer needed. This must be done according to policy, using methods like those in NIST SP 800-88 (e.g., Clear, Purge, Destroy) to prevent data remanence."
                },
                'asset-class': {
                    'asset': "Anything of value to the organization. This includes information assets (data, trade secrets), physical assets (servers, buildings), software assets (applications), and even personnel and reputation.",
                    'valuation': "The process of determining an asset's worth to the organization. This can be quantitative (calculating direct financial loss) or qualitative (assessing impact on reputation or operations) and is essential for prioritizing protection efforts.",
                    'classification': "The process of labeling an asset based on its value, sensitivity, and criticality. This label determines the minimum required security controls for handling, storage, and transmission, ensuring protection is commensurate with value."
                },
                'data-tech': {
                    'dlp': "Systems that monitor, detect, and block the unauthorized exfiltration of sensitive data. They work by identifying data through content analysis (keywords, regex) or data fingerprinting and can be deployed at the network edge, on endpoints, or in the cloud.",
                    'drm': "Technology that enforces access and usage policies on digital content. It can control actions like printing, copying, forwarding, or screen-capturing, and these protections persist even after the data has left the organization's direct control.",
                    'casb': "A security policy enforcement point between cloud users and cloud providers. It provides visibility into cloud usage, enforces security policies (like DLP), ensures compliance, and protects against cloud-specific threats."
                },
                'framework-types': {
                    'control': "These are tactical frameworks that provide a catalog of specific security controls. They help answer 'What should we do?'. Examples: NIST SP 800-53, CIS Controls.",
                    'risk': "These are strategic frameworks that provide a process for identifying, assessing, and managing risk. They help answer 'How should we make decisions about security?'. Examples: NIST CSF, ISO 31000.",
                    'program': "These are overarching frameworks that provide a structure for building and managing a complete Information Security Management System (ISMS). They help answer 'How do we organize our entire security effort?'. Examples: ISO 27001, COBIT."
                },
                framework: {
                    iso27001: "The international standard for an Information Security Management System (ISMS). It is a certifiable program framework that uses a risk-based approach and includes the well-known Annex A list of control objectives and controls.",
                    nistcsf: "A voluntary framework developed in the US to help organizations manage cybersecurity risk. It is organized around five core functions (Identify, Protect, Detect, Respond, Recover) and is excellent for communicating risk posture to stakeholders.",
                    cobit: "A framework for the governance and management of enterprise IT. It treats information security as a key component, focusing on aligning IT with business goals and providing metrics to measure process maturity and achievement.",
                    togaf: "An enterprise architecture framework. From a CISM perspective, it's used to ensure that security architecture is an integral part of the overall enterprise architecture, not just a technical add-on.",
                    sabsa: "A business-driven framework for developing security architecture. It uses a top-down approach, starting with business requirements to create a chain of traceability through six layers (Contextual, Conceptual, Logical, Physical, Component, Operational)."
                },
                'doc-hierarchy': {
                    'policy': "A mandatory, high-level statement from senior management that defines the organization's position on a specific security issue. It is broad and stable. Example: 'Employees must use strong passwords.'",
                    'standard': "A mandatory rule that specifies which technologies or configurations must be used to support a policy. It provides quantifiable measures. Example: 'Passwords must be at least 12 characters long and include complexity.'",
                    'procedure': "A mandatory, detailed, step-by-step document that outlines exactly how to perform a task to comply with a standard. It is highly specific and action-oriented. Example: 'Step 1: Open Control Panel. Step 2: Click User Accounts...'",
                    'guideline': "A non-mandatory recommendation or best practice. It provides advice on how to achieve a goal but allows for flexibility. Example: 'It is recommended to use a password manager to store your passwords.'"
                },
                'metric-types': {
                    'kpi': "Measures how well a process is performing. KPIs are often efficiency-focused and tactical. Example: 'Mean Time to Remediate (MTTR) for critical vulnerabilities is under 15 days.' It shows if your vulnerability management process is working well.",
                    'kgi': "Measures the outcome or result of achieving a goal. KGIs are effectiveness-focused and strategic. Example: 'A 40% reduction in security incidents caused by unpatched vulnerabilities.' It shows if the overall goal of reducing risk is being met."
                },
                'metric-audience': {
                    'strategic': "For executives and the board. Focus on high-level risk, ROI, compliance, and alignment with business objectives. Uses dashboards showing risk trends against risk appetite.",
                    'managerial': "For security managers and business unit leaders. Focus on program effectiveness, resource allocation, and project status. Uses metrics like audit finding closure rates and control implementation progress.",
                    'operational': "For technical teams. Focus on the performance of specific controls and systems. Uses detailed metrics like firewall block rates, antivirus detection counts, and SIEM alert volumes."
                },
                'control-criteria': {
                    cost: "Evaluating the Total Cost of Ownership (TCO) of a control against the potential reduction in risk. The goal is to achieve a positive Return on Security Investment (ROSI) where the benefit exceeds the cost.",
                    productivity: "Assessing the control's impact on business operations and user workflows. A control that is too cumbersome may be bypassed by users, rendering it ineffective. Security must enable, not hinder, the business.",
                    scalability: "Ensuring the control can support future business growth, adapt to new technologies, and remain effective against an evolving threat landscape without requiring a complete redesign."
                },
                'control-cats-types': {
                    categories: "<b>Technical (Logical):</b> Enforced by technology (e.g., firewalls, encryption, access control lists).<br><b>Administrative:</b> Human-driven controls (e.g., policies, procedures, security awareness training).<br><b>Physical:</b> Protect the physical environment (e.g., locks, fences, security guards).",
                    types: "<b>Preventive:</b> Aims to stop an incident from occurring (e.g., a firewall blocking a malicious IP).<br><b>Detective:</b> Aims to identify that an incident has occurred (e.g., an IDS alert).<br><b>Corrective:</b> Aims to fix a system after an incident (e.g., restoring from a backup)."
                },
                'it-processes': {
                    devsecops: "Integrating automated and continuous security practices into the DevOps pipeline. This 'shift-left' approach finds and fixes vulnerabilities early in the development cycle, making security a shared responsibility.",
                    change: "A formal process to ensure that any changes to IT systems are reviewed for security impact before implementation. A Change Advisory Board (CAB) typically approves changes to prevent unintended security weaknesses.",
                    config: "The process of establishing and maintaining consistent, secure configurations (baselines) for systems. This includes monitoring for 'configuration drift' and using automated tools to enforce the baseline."
                },
                'control-strength': {
                    inherent: "The theoretical strength of a control in a perfect implementation. For example, AES-256 encryption is inherently very strong due to its cryptographic design.",
                    practical: "The actual, real-world strength of a control, which is often reduced by poor implementation, human error, or environmental factors. For example, inherently strong encryption is weak in practice if the keys are poorly managed."
                },
                'control-testing': {
                    'internal-audits': "A formal review to verify that controls are implemented and operating in compliance with policies and regulations. It is objective-based and provides assurance to management.",
                    'penetration-testing': "An authorized, simulated attack on systems to evaluate security by actively exploiting vulnerabilities. Types include black-box (no knowledge), white-box (full knowledge), and grey-box (some knowledge).",
                    'vulnerability-scanning': "An automated process that scans systems for known vulnerabilities. It provides a broad overview of weaknesses but does not exploit them. Can be credentialed (more accurate) or non-credentialed.",
                    'security-assessments': "A holistic review of an organization's security posture against a specific framework (e.g., NIST CSF or ISO 27001). It is broader than testing and includes reviewing policies, architecture, and processes."
                },
                'role-training': {
                    all: "General awareness covering universal topics like phishing recognition, strong password creation, acceptable use of assets, and reporting security incidents.",
                    execs: "Specialized training focused on strategic risks, business email compromise (BEC), social engineering tactics targeting leadership, and their role in governance and incident response.",
                    admins: "In-depth technical training on secure system configuration, secure coding practices, log analysis, vulnerability management, and their specific duties during a security incident."
                },
                'training-method': {
                    elearning: "Provides scalable, consistent, and trackable training. Ideal for foundational knowledge and annual compliance requirements.",
                    simulations: "Builds practical skills and muscle memory by exposing users to realistic scenarios like phishing attacks or incident response tabletop exercises. Highly effective for measuring behavioral change.",
                    briefings: "Live, interactive sessions that allow for Q&A and tailored content. Excellent for communicating timely information, such as new threats or major policy changes, to specific groups.",
                    gamification: "Uses game mechanics like points and leaderboards to increase engagement, motivation, and retention of security concepts, fostering a positive and competitive security culture."
                },
                'vendor-clauses': {
                    sla: "Specifies measurable security commitments, such as system uptime (e.g., 99.9%), vulnerability patching timelines (e.g., critical within 7 days), and incident notification windows (e.g., within 2 hours of detection).",
                    audit: "The contractual right for your organization to verify the vendor's security. This can be the right to receive their third-party audit reports (e.g., SOC 2 Type II) or, for critical vendors, the right to conduct your own assessment.",
                    ownership: "A clause that explicitly states your organization owns its data. It should also define requirements for data segregation, data location (geofencing), and the secure return or destruction of data at the end of the contract."
                },
                'third-party-step': {
                    'scoping': "Classifying the vendor based on the criticality of their service and the sensitivity of the data they will access. This determines the level of scrutiny required for the rest of the process.",
                    'vetting': "Performing initial due diligence, which includes reviewing security certifications (SOC 2, ISO 27001), sending security questionnaires (e.g., CAIQ, SIG), and assessing the vendor's reputation and financial stability.",
                    'assessment': "A deep-dive review of the vendor's security controls, potentially including analysis of their audit reports, penetration test results, and even on-site visits for the most critical suppliers.",
                    'contractual': "Negotiating and embedding legally enforceable security requirements, SLAs, right-to-audit clauses, and incident notification procedures into the final contract.",
                    'monitoring': "Continuously overseeing the vendor's security posture throughout the relationship. This includes periodic reviews, tracking performance against SLAs, and using tools to monitor their external attack surface.",
                    'exit': "A pre-planned strategy for securely terminating the relationship. This ensures that all data is returned or destroyed, access is revoked, and the transition is managed without introducing new risks."
                },
                'pdca-cycle': {
                    plan: "Establish security objectives and processes necessary to deliver results in accordance with the organization's security policy. This is driven by risk assessment and strategy.",
                    do: "Implement the plan. This involves deploying controls, executing processes, and conducting training as defined in the 'Plan' phase.",
                    check: "Monitor and measure process performance against policies, objectives, and metrics (KPIs). This is done through audits, vulnerability scans, and performance reviews.",
                    act: "Take actions to continually improve process performance. Based on the results of the 'Check' phase, this involves implementing corrective actions, updating policies, and refining controls."
                },
                audience: {
                    executive: "Communication focuses on business impact, risk posture relative to risk appetite, ROI on security investments, and overall compliance status. The goal is to provide strategic information for decision-making.",
                    technical: "Communication is detailed and granular, focusing on specific vulnerabilities, control configurations, log data, threat intelligence feeds, and operational procedures. The goal is to provide actionable data for implementation and defense.",
                    endUsers: "Communication is simple, direct, and actionable, focusing on security best practices, awareness of common threats (like phishing), and clear instructions on how to report incidents. The goal is to foster a security-conscious culture.",
                    legalCompliance: "Communication focuses on adherence to laws and regulations, status of audit findings, evidence of due care, and contractual obligations. The goal is to provide assurance and demonstrate compliance."
                },
                // --- FIX STARTS HERE ---
                'policy-cycle': {
                    'develop-update': "This initial phase involves identifying the need for new policies or reviewing existing ones. It includes research, drafting, and ensuring alignment with organizational objectives, risk assessments, and regulatory requirements.",
                    'review-approve': "Once drafted, policies undergo a rigorous review process involving key stakeholders, legal teams, and senior management. Formal approval ensures buy-in and organizational endorsement.",
                    'communicate-implement': "Approved policies must be effectively communicated to all relevant employees. Implementation involves integrating policy requirements into operational procedures, systems, and employee training programs.",
                    'monitor-enforce': "This ongoing phase involves continuously monitoring adherence to policies and enforcing their requirements. This includes technical controls, regular checks, and addressing non-compliance.",
                    'audit-assess': "Periodically, independent audits and assessments are conducted to evaluate the effectiveness of policies and controls. This identifies gaps, weaknesses, and areas for improvement.",
                    'identify-gaps': "Based on monitoring, enforcement, and audit results, new risks, technological changes, or regulatory updates, gaps and necessary changes to policies are identified, feeding back into the 'Develop/Update Policy' phase."
                },
                'control-type': {
                    administrative: "Policies, procedures, guidelines, security awareness training, background checks, incident response plans. These are rules and practices that govern behavior.",
                    technical: "Firewalls, IDS/IPS, encryption, access control systems (MFA), antivirus, logging/monitoring tools. These are enforced through technology.",
                    physical: "Locks, security guards, surveillance cameras, alarm systems, environmental controls, secure data centers. These protect physical access to assets."
                },
                'control-concept': {
                    'defense-in-depth': "Implementing multiple layers of security controls to protect critical assets. If one control fails, another layer acts as a backup. This principle acknowledges that no single control is foolproof.",
                    'compensating-controls': "Implementing alternative controls when a primary control is not feasible or practical due to technical or business constraints. Compensating controls should provide a similar level of protection to the original control."
                },
                'implementation-step': {
                    'planning-design': "This initial phase involves detailed planning for how new controls will integrate with existing IT architecture and business processes. It includes defining technical specifications, identifying dependencies, and creating a rollout strategy to minimize disruption.",
                    'technical-deployment': "This step involves the actual installation, configuration, and deployment of technical security controls (e.g., firewalls, endpoint protection, encryption). It requires careful attention to secure baseline configurations and testing in a non-production environment.",
                    'process-embedding': "Administrative controls and security procedures must be integrated into daily business operations. This includes updating existing workflows, training employees on new security practices, and ensuring that security is a natural part of business processes.",
                    'third-party-coordination': "For controls involving external services (e.g., cloud providers, managed security services), this step involves coordinating with third parties to ensure their systems and processes meet the defined security requirements, often enforced through contractual agreements and SLAs.",
                    'testing-validation': "After deployment, controls must be thoroughly tested to ensure they are functioning as intended and effectively mitigating identified risks. This includes functional testing, security testing (e.g., vulnerability scans, penetration tests), and compliance checks."
                }
                // --- FIX ENDS HERE ---
            };


            const keyTermsData = [
                { term: "Security Program", definition: "The formal combination of people, processes, and technology that executes the security strategy." },
                { term: "SDLC", definition: "A structured process for developing and maintaining systems, into which security must be integrated." },
                { term: "Asset Classification", definition: "The process of labeling information based on its sensitivity and criticality to determine the appropriate level of protection." },
                { term: "Information Life Cycle", definition: "The stages data goes through from creation to destruction, with security controls required at each stage." },
                { term: "DLP", definition: "Technology designed to prevent the unauthorized disclosure of sensitive data." },
                { term: "Policy", definition: "A high-level statement of management intent (the 'why')." },
                { term: "Standard", definition: "A mandatory technical specification (the 'what')." },
                { term: "Procedure", definition: "A detailed, step-by-step instruction (the 'how')." },
                { term: "Guideline", definition: "A non-mandatory recommendation or best practice." },
                { term: "KPI", definition: "A metric that measures the performance of a specific activity." },
                { term: "Control Objective", definition: "A statement of the desired result or purpose of a security control." },
                { term: "Control Categories", definition: "Technical (logical), Administrative, and Physical controls." },
                { term: "Control Types", definition: "Preventive, Detective, and Corrective controls." },
                { term: "DevSecOps", definition: "The practice of integrating security into the DevOps CI/CD pipeline." },
                { term: "Role-Based Training", definition: "Tailoring security training content to an employee's specific job function and level of access." },
                { term: "SLA", definition: "A contractual commitment that defines specific, measurable levels of service from a vendor." },
                { term: "PDCA", definition: "A continuous improvement cycle for managing and refining processes (Plan-Do-Check-Act)." }
            ];

            let resourceAllocationChartInstance, programMetricsChartInstance;

            // --- BEHAVIOR SETUP ---
            function setupNavigation() {
                document.querySelectorAll('.nav-item').forEach(button => {
                    button.addEventListener('click', () => {
                        document.querySelectorAll('.nav-item').forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                        document.querySelectorAll('.content-section').forEach(section => section.classList.add('hidden'));
                        const targetSection = document.getElementById(button.dataset.target);
                        targetSection.classList.remove('hidden');
                        setTimeout(() => targetSection.classList.add('fade-in'), 10);
                    });
                });
            }

            function setupAccordions() {
                document.querySelectorAll('.accordion-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const content = button.nextElementSibling;
                        const isOpening = content.classList.contains('hidden');
                        if (isOpening) {
                            content.classList.remove('hidden');
                            button.classList.add('open');
                        } else {
                            content.classList.add('hidden');
                            button.classList.remove('open');
                        }
                    });
                });
            }

            function setupCardToggles() {
                document.querySelectorAll('[data-group]').forEach(card => {
                    card.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const group = card.dataset.group;
                        const key = card.dataset.key;
                        const descriptionDiv = card.querySelector('.card-description');
                        const isAlreadyActive = card.classList.contains('active');

                        document.querySelectorAll(`[data-group="${group}"]`).forEach(otherCard => {
                            otherCard.classList.remove('active');
                        });

                        if (!isAlreadyActive) {
                            card.classList.add('active');
                            if (descriptionDiv && contentData[group] && contentData[group][key]) {
                                descriptionDiv.innerHTML = `<p>${contentData[group][key]}</p>`;
                            }
                        }
                    });
                });
            }

            // --- CHART & INTERACTIVE LOGIC ---
            function initResourceAllocationChart() {
                const ctx = document.getElementById('resourceAllocationChart')?.getContext('2d');
                if (!ctx) return;
                resourceAllocationChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: resourceAllocationData.labels,
                        datasets: [{
                            label: 'Budget Allocation (%)',
                            data: [40, 30, 15, 15],
                            backgroundColor: resourceAllocationData.colors,
                            borderColor: surfaceColor,
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        indexAxis: 'y',
                        scales: {
                            x: { beginAtZero: true, max: 100, grid: { color: borderColor }, ticks: { color: textSecondary } },
                            y: { grid: { color: borderColor }, ticks: { color: textSecondary } }
                        },
                        plugins: { legend: { display: false } }
                    }
                });
            }

            function updateResourceAllocationChart() {
                const totalBudgetInput = document.getElementById('totalBudgetInput');
                if (!totalBudgetInput) return;
                const rawTotalBudget = totalBudgetInput.value.replace(/,/g, '');
                let totalBudget = parseFloat(rawTotalBudget) || 0;
                totalBudgetInput.value = totalBudget.toLocaleString('en-US');

                const peoplePercent = parseFloat(document.getElementById('peopleAllocation').value) || 0;
                const toolsPercent = parseFloat(document.getElementById('toolsAllocation').value) || 0;
                const trainingPercent = parseFloat(document.getElementById('trainingAllocation').value) || 0;
                const compliancePercent = parseFloat(document.getElementById('complianceAllocation').value) || 0;

                const sumPercentages = peoplePercent + toolsPercent + trainingPercent + compliancePercent;
                const feedbackElement = document.getElementById('allocationFeedback');

                if (sumPercentages !== 100) {
                    feedbackElement.textContent = `Percentages must sum to 100%. Current sum: ${sumPercentages}%`;
                    feedbackElement.classList.add('text-red-600');
                    feedbackElement.classList.remove('text-green-600');
                } else {
                    feedbackElement.textContent = 'Allocation valid!';
                    feedbackElement.classList.remove('text-red-600');
                    feedbackElement.classList.add('text-green-600');
                }

                document.getElementById('peopleAmount').textContent = (totalBudget * (peoplePercent / 100)).toLocaleString('en-US', { maximumFractionDigits: 0 });
                document.getElementById('toolsAmount').textContent = (totalBudget * (toolsPercent / 100)).toLocaleString('en-US', { maximumFractionDigits: 0 });
                document.getElementById('trainingAmount').textContent = (totalBudget * (trainingPercent / 100)).toLocaleString('en-US', { maximumFractionDigits: 0 });
                document.getElementById('complianceAmount').textContent = (totalBudget * (compliancePercent / 100)).toLocaleString('en-US', { maximumFractionDigits: 0 });

                if (resourceAllocationChartInstance) {
                    resourceAllocationChartInstance.data.datasets[0].data = [peoplePercent, toolsPercent, trainingPercent, compliancePercent];
                    resourceAllocationChartInstance.update();
                }
            }

            function initProgramMetricsChart() {
                const ctx = document.getElementById('programMetricsChart')?.getContext('2d');
                if (!ctx) return;
                const initialData = programMetricsTrendData.kpiImplementationRate;
                programMetricsChartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: programMetricsLabels,
                        datasets: [{ ...initialData, fill: true, tension: 0.3 }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { beginAtZero: true, grid: { color: borderColor }, ticks: { color: textSecondary } },
                            x: { grid: { color: borderColor }, ticks: { color: textSecondary } }
                        },
                        plugins: { legend: { position: 'top', labels: { color: textSecondary } } }
                    }
                });
            }

            function updateProgramMetricsChart(metricKey) {
                if (!programMetricsChartInstance) return;
                const data = programMetricsTrendData[metricKey];
                programMetricsChartInstance.data.datasets[0] = { ...data, fill: true, tension: 0.3 };
                programMetricsChartInstance.update();
            }
            
            function renderKeyTerms() {
                const container = document.getElementById('key-terms-grid');
                if (!container) return;
                container.innerHTML = '';
                keyTermsData.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'unified-card';
                    card.dataset.group = 'key-terms';
                    const key = item.term.toLowerCase().replace(/[\s/()]+/g, '-').replace(/-$/, '');
                    card.dataset.key = key;

                    card.innerHTML = `
                        <span class="card-title">${item.term}</span>
                        <div class="card-description"></div>
                    `;
                    container.appendChild(card);
                });
            }

            // --- INITIALIZATION & EVENT LISTENERS ---
            
            // Unify the key terms data into the main contentData object so one function can handle all cards
            const keyTermsAsObject = {};
            keyTermsData.forEach(item => {
                const key = item.term.toLowerCase().replace(/[\s/()]+/g, '-').replace(/-$/, '');
                keyTermsAsObject[key] = item.definition;
            });
            contentData['key-terms'] = keyTermsAsObject;

            setupNavigation();
            setupAccordions();
            renderKeyTerms(); // Render the dynamic cards into the DOM
            setupCardToggles(); // Attach a single, unified click handler to ALL cards

            initResourceAllocationChart();
            initProgramMetricsChart();
            
            ['totalBudgetInput', 'peopleAllocation', 'toolsAllocation', 'trainingAllocation', 'complianceAllocation'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                   element.addEventListener('input', updateResourceAllocationChart);
                }
            });
            updateResourceAllocationChart();

            const metricSelect = document.getElementById('programMetricSelect');
            if (metricSelect) {
                metricSelect.addEventListener('change', (e) => {
                    updateProgramMetricsChart(e.target.value);
                });
            }

        });
    </script>
</body>
</html>
