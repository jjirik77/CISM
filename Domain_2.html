<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CISM 2024: Domain 2 - Information Security Risk Management (Interactive Study Guide)</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F5EF; /* Warm Neutral Background */
            color: #333333;
        }
        .container {
            max-width: 1200px;
        }
        /* Enhanced Section Header with new accent color from Domain 3 */
        .section-header {
            border-left: 6px solid #00A896; /* Vibrant Teal Accent */
            padding-left: 1.25rem;
            font-size: 2.5rem; /* Slightly larger */
            color: #222222; /* Darker text for contrast */
        }
        /* Refined Accordion Button and Content from Domain 3 */
        .accordion-button {
            background-color: #EDEAE0; /* Secondary Neutral */
            border-bottom: 1px solid #D5D2C8;
            border-radius: 0.75rem; /* More rounded */
            padding: 1rem 1.5rem; /* Increased padding */
            font-size: 1.25rem; /* Slightly larger font */
            font-weight: 700; /* Bolder */
            color: #333333;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out;
            display: flex; /* Ensure flex behavior */
            justify-content: space-between; /* Pushes content and icon to ends */
            align-items: center; /* Vertically centers items */
            text-align: left; /* Keep text aligned left within the button */
        }
        .accordion-button:hover {
            background-color: #D5D2C8; /* Darker on hover */
            transform: translateY(-1px);
        }
        .accordion-content {
            background-color: #FFFFFF;
            border-bottom: 1px solid #D5D2C8;
            border-radius: 0 0 0.75rem 0.75rem; /* Match top radius */
            padding: 1.5rem; /* More padding */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05); /* Subtle shadow */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px; /* Increased max-width for charts */
            height: 50vh; /* Increased height */
            max-height: 500px; /* Increased max height */
            margin-left: auto;
            margin-right: auto;
            overflow: hidden; /* Prevent overflow */
        }
        @media (min-width: 640px) { /* sm */
            .chart-container {
                height: 45vh; /* Increased height for sm screens */
                max-height: 450px; /* Increased max height for sm screens */
            }
        }
        @media (min-width: 768px) { /* md */
            .chart-container {
                height: 40vh; /* Increased height for md screens */
                max-height: 400px; /* Increased max height for md screens */
            }
        }
        /* Active Navigation Item from Domain 3 */
        .nav-item.active {
            border-bottom: 3px solid #00A896; /* Vibrant Teal Accent */
            font-weight: 700; /* Bolder */
            color: #222222;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .tooltip-custom-title {
            font-size: 0.9em;
            font-weight: bold;
            margin-bottom: 4px;
        }
        .tooltip-custom-body {
            font-size: 0.8em;
        }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }
        /* Risk Matrix Specific Styles */
        .risk-matrix-table {
            width: 100%;
            max-width: 400px; /* Adjust as needed */
            margin: 1rem auto;
            border-collapse: collapse;
        }
        .risk-matrix-table th, .risk-matrix-table td {
            border: 1px solid #D5D2C8;
            padding: 0.75rem;
            text-align: center;
            font-weight: 600;
        }
        .risk-matrix-table th {
            background-color: #EDEAE0;
            color: #333333;
        }
        .risk-matrix-table td {
            background-color: #FFFFFF;
        }
        .risk-matrix-table .low { background-color: #D4EDDA; color: #155724; } /* Green */
        .risk-matrix-table .medium { background-color: #FFF3CD; color: #856404; } /* Yellow */
        .risk-matrix-table .high { background-color: #F8D7DA; color: #721C24; } /* Red */
        .risk-matrix-table .critical { background-color: #DC3545; color: #FFFFFF; } /* Darker Red */

        /* Unified Styles for Interactive Cards (Frameworks, Response, Methods, Key Terms, Vulnerability Scenarios) */
        .risk-framework-card, .risk-response-card, .risk-method-card, .key-term-card {
            background-color: #EDEAE0; /* Secondary Neutral */
            border: 1px solid #D5D2C8;
            padding: 1rem;
            border-radius: 0.75rem; /* More rounded */
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-sizing: border-box;
            text-align: left;
            font-weight: 600;
            color: #333333;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center; /* Centered vertically */
            align-items: center; /* Centered horizontally */
            box-shadow: 0 2px 5px rgba(0,0,0,0.08); /* Subtle initial shadow */
            flex-grow: 0; /* Prevent horizontal growth */
            flex-shrink: 0; /* Prevent horizontal shrinking */
        }

        .risk-framework-card:hover, .risk-response-card:hover, .risk-method-card:hover, .key-term-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15); /* More pronounced shadow on hover */
        }

        /* Active state for all interactive cards */
        .risk-framework-card.active, .risk-response-card.active, .risk-method-card.active, .key-term-card.active {
            border-color: #00A896; /* Vibrant Teal border */
            box-shadow: 0 4px 8px rgba(0, 168, 150, 0.3); /* Teal glow */
            background-color: #E0F7F5; /* Very light teal background */
        }

        .risk-framework-card .card-title, .risk-response-card .card-title, .risk-method-card .card-title, .key-term-card .card-title {
            font-size: 1.15em; /* Slightly larger title */
            margin-bottom: 0.6rem;
            text-align: center;
            color: #004085; /* Dark blue for title for consistency */
        }

        .risk-framework-card .card-description, .risk-response-card .card-description, .risk-method-card .card-description, .key-term-card .card-description {
            font-weight: 400; /* Regular font weight for description */
            font-size: 0.9em;
            color: #555555;
            margin-top: 0.5rem;
            display: none; /* Hidden by default */
            text-align: left; /* Default text alignment for descriptions */
            word-break: break-word; /* Ensure text breaks within the fixed width */
        }
        /* Specific override for key-term-card description text alignment */
        .key-term-card .card-description {
            text-align: center;
        }
        /* Specific override for vulnerability-scenario-card description text alignment */
        .vulnerability-scenario-card .card-description {
            text-align: left; /* Keep left alignment for detailed impact */
        }

        .risk-framework-card.active .card-description, .risk-response-card.active .card-description, .risk-method-card.active .card-description, .key-term-card.active .card-description {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }


        /* Specific colors for risk response cards (overriding general card background) */
        .risk-response-card.mitigate { background-color: #D4EDDA; color: #155724; } /* Light Green */
        .risk-response-card.mitigate:hover { background-color: #C3E6CB; }
        .risk-response-card.transfer { background-color: #CCE5FF; color: #004085; } /* Light Blue */
        .risk-response-card.transfer:hover { background-color: #B8DAFF; }
        .risk-response-card.avoid { background-color: #F8D7DA; color: #721C24; } /* Light Red */
        .risk-response-card.avoid:hover { background-color: #F5C6CB; }
        .risk-response-card.accept { background-color: #FFF3CD; color: #856404; } /* Light Yellow */
        .risk-response-card.accept:hover { background-color: #FFECB3; }

        /* Specific colors for risk method cards (overriding general card background) */
        .risk-method-card.qualitative { background-color: #F0F8FF; color: #001f3f; } /* Alice Blue */
        .risk-method-card.qualitative:hover { background-color: #E0F2FF; }
        .risk-method-card.quantitative { background-color: #F5FFFA; color: #003300; } /* Mint Cream */
        .risk-method-card.quantitative:hover { background-color: #E6FFF2; }
        .risk-method-card.hybrid { background-color: #FAEBD7; color: #4B0082; } /* Antique White with Indigo */
        .risk-method-card.hybrid:hover { background-color: #F0DDC0; }


        /* Risk Posture Scorecard Table Styles */
        .risk-scorecard-table {
            width: 100%;
            max-width: 600px;
            margin: 1rem auto;
            border-collapse: collapse;
            font-size: 0.9em;
        }
        .risk-scorecard-table th, .risk-scorecard-table td {
            border: 1px solid #D5D2C8;
            padding: 0.6rem;
            text-align: center;
        }
        .risk-scorecard-table th {
            background-color: #EDEAE0;
            font-weight: 600;
            color: #333333;
        }
        .risk-scorecard-table td {
            background-color: #FFFFFF;
            color: #555555;
        }
        .risk-scorecard-table .risk-level-low { background-color: #D4EDDA; color: #155724; } /* Green */
        .risk-scorecard-table .risk-level-medium { background-color: #FFF3CD; color: #856404; } /* Yellow */
        .risk-scorecard-table .risk-level-high { background-color: #F8D7DA; color: #721C24; } /* Red */
        .risk-scorecard-table .critical { background-color: #DC3545; color: #FFFFFF; } /* Darker Red */

        /* Styles for Corporate Hierarchy Chart */
        .hierarchy-chart-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem; /* Space between elements */
            padding: 1rem;
            background-color: #F8F5EF; /* Match body background */
            border-radius: 0.5rem;
            max-width: 600px; /* Constrain width for better layout */
            margin: 1rem auto; /* Center the chart */
        }

        .role-node {
            background-color: #EDEAE0; /* Default neutral for nodes */
            color: #333333;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            font-weight: 600;
            text-align: center;
            min-width: 200px; /* Ensure some minimum width */
            width: fit-content; /* Adjust width to content */
            display: flex; /* Use flexbox for content alignment */
            flex-direction: column; /* Stack content vertically */
            justify-content: center; /* Centered vertically */
            align-items: center; /* Centered horizontally */
        }

        .role-node:hover {
            background-color: #D5D2C8; /* Darker neutral on hover */
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .role-node.active {
            border-color: #00A896; /* Vibrant Teal border */
            box-shadow: 0 44px 8px rgba(0, 168, 150, 0.3); /* Teal glow */
            background-color: #E0F7F5; /* Very light teal background */
        }

        .role-node .role-title {
            display: block;
            margin-bottom: 0.6rem; /* Space between title and description */
            font-size: 1.15em; /* Slightly larger title */
            color: #004085; /* Dark blue for title for consistency */
        }
        .role-node .role-description {
            font-weight: 400; /* Regular font weight for description */
            font-size: 0.9em;
            color: #555555;
            text-align: left; /* Align description text left */
            margin-top: 0.5rem;
            display: none; /* Hidden by default */
        }
        .role-node.active .role-description {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }


        .hierarchy-line {
            width: 2px;
            height: 2rem; /* Length of vertical line */
            background-color: #D5D2C8; /* Neutral line color */
        }

        .hierarchy-line-split {
            width: 60%; /* Horizontal span for split */
            height: 2px;
            background-color: #D5D2C8;
            position: relative;
            margin-top: 1rem;
            margin-bottom: 1rem;
        }
        .hierarchy-line-split::before,
        .hierarchy-line-split::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 1rem; /* Vertical stub from horizontal line */
            background-color: #D5D2C8;
            bottom: 0;
        }
        .hierarchy-line-split::before {
            left: 0;
            transform: translateX(-50%); /* Center under left node */
        }
        .hierarchy-line-split::after {
            right: 0;
            transform: translateX(50%); /* Center under right node */
        }

        /* Specific colors for roles */
        .role-node.board { background-color: #A1C9CE; color: #333333; } /* Soft Blue */
        .role-node.ciso { background-color: #8FB8A1; color: #333333; } /* Soft Green */
        .role-node.data-owners { background-color: #FFD700; color: #333333; } /* Gold */
        .role-node.it-ops { background-color: #FF6384; color: #333333; } /* Pinkish Red */
        .role-node.end-users { background-color: #B0C4DE; color: #333333; } /* Light Steel Blue - Changed for readability */


        /* Responsive Adjustments for new cards/elements */
        @media (max-width: 768px) {
            .risk-framework-card,
            .risk-response-card,
            .risk-method-card,
            .key-term-card,
            .vulnerability-scenario-card, /* Added for responsiveness */
            .role-node { /* Apply to all interactive cards */
                flex: 1 1 100%; /* Stack cards on medium screens */
                max-width: 100%;
            }
            .hierarchy-line-split {
                width: 2px; /* Make it vertical on small screens */
                height: 2rem;
                margin: 1rem auto;
            }
            .hierarchy-line-split::before,
            .hierarchy-line-split::after {
                display: none; /* Hide horizontal stubs */
            }
        }
        /* Adjusted for larger screens to maintain 6 columns for key terms */
        @media (min-width: 1024px) {
            #key-terms .grid {
                grid-template-columns: repeat(6, 1fr); /* Six columns on large screens */
                gap: 1.5rem; /* Ensure gap is consistent */
            }
            .key-term-card {
                /* Calculate width for 6 columns with gap-6 (1.5rem) */
                flex: 1 1 calc((100% - (5 * 1.5rem)) / 6);
                max-width: calc((100% - (5 * 1.5rem)) / 6);
                min-height: 180px; /* Increased min-height for more text */
            }
            .key-term-card .card-title {
                font-size: 1em; /* Slightly smaller title for more space */
            }
            .key-term-card .card-description {
                font-size: 0.85em; /* Slightly smaller description for more space */
            }
        }

        /* Custom button colors for threat distribution */
        .btn-ransomware { background-color: #A1C9CE; color: #333333; }
        .btn-ransomware:hover { background-color: #8FB8A1; }
        .btn-insider-threats { background-color: #8FB8A1; color: #333333; }
        .btn-insider-threats:hover { background-color: #6F9C7D; }
        .btn-third-party-risks { background-color: #FFD700; color: #333333; }
        .btn-third-party-risks:hover { background-color: #E0B800; }
        .btn-phishing { background-color: #FF6384; color: #FFFFFF; }
        .btn-phishing:hover { background-color: #E04B6D; }
        .btn-ddos { background-color: #6A5ACD; color: #FFFFFF; }
        .btn-ddos:hover { background-color: #5A4DAA; }
        .btn-apt { background-color: #DAA520; color: #333333; }
        .btn-apt:hover { background-color: #B8860B; }

        /* Specific min-width and width for cards */
        .risk-framework-card {
            min-width: 200px; /* Set min-width as requested */
            width: 200px; /* Fixed width */
            flex-basis: 200px; /* Ensure flex-basis matches width */
        }
        .risk-response-card {
            min-width: 200px; /* Changed to 200px as requested */
            width: 200px; /* Fixed width */
            flex-basis: 200px; /* Ensure flex-basis matches width */
        }
        .risk-method-card {
            min-width: 250px; /* Set min-width as requested */
            width: 250px; /* Fixed width */
            flex-basis: 250px; /* Ensure flex-basis matches width */
        }
        .key-term-card {
            min-width: 150px; /* Set min-width as requested */
            width: 150px; /* Fixed width */
            flex-basis: 150px; /* Ensure flex-basis matches width */
        }
        /* New styles for vulnerability scenario cards */
        .vulnerability-scenario-card {
            min-width: 150px; /* Set min-width as requested */
            width: 150px; /* Fixed width */
            flex-basis: 150px; /* Ensure flex-basis matches width */
            /* min-height: 100px; Removed min-height to allow vertical expansion */
            text-align: center; /* Center content horizontally */
            justify-content: center; /* Center content vertically */
            padding: 1rem;
            border: 1px solid #D5D2C8;
            border-radius: 0.75rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
            transition: all 0.2s ease-in-out;
            background-color: #F0F8FF; /* Light background */
        }
        .vulnerability-scenario-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        .vulnerability-scenario-card.active {
            border-color: #00A896;
            box-shadow: 0 4px 8px rgba(0, 168, 150, 0.3);
            background-color: #E0F7F5;
        }
        .vulnerability-scenario-card .card-title {
            font-size: 1.1em;
            font-weight: 700;
            color: #004085;
            margin-bottom: 0.5rem;
            text-align: center;
        }
        .vulnerability-scenario-card .card-description {
            font-weight: 400;
            font-size: 0.85em;
            color: #555555;
            margin-top: 0.5rem;
            display: none; /* Hidden by default */
            text-align: left; /* Keep left alignment for detailed impact */
        }
        .vulnerability-scenario-card.active .card-description {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        /* Flowchart specific styles */
        .flowchart-container {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping for multiple scenarios */
            justify-content: center;
            gap: 1rem; /* Space between scenarios */
            margin-top: 1rem;
        }

        .flow-scenario {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem; /* Space between individual flow chains */
        }

        .flow-node {
            background-color: #EDEAE0;
            border: 1px solid #D5D2C8;
            padding: 0.75rem;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-sizing: border-box;
            text-align: center;
            font-weight: 600;
            color: #333333;
            /* min-height: 80px; Removed min-height to allow vertical expansion */
            width: 150px; /* Fixed width for flow nodes - as requested */
            flex-basis: 150px; /* Fixed flex-basis for flow nodes - as requested */
        }

        .flow-node:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .flow-node.active {
            border-color: #00A896;
            box-shadow: 0 2px 5px rgba(0, 168, 150, 0.3);
            background-color: #E0F7F5;
        }

        .flow-node .node-title {
            font-size: 0.9em; /* Slightly reduced font size for title */
            font-weight: 700;
            color: #004085;
            margin-bottom: 0.4rem;
            display: block;
        }

        .flow-node .node-description {
            font-weight: 400;
            font-size: 0.75em; /* Slightly reduced font size for description */
            color: #555555;
            margin-top: 0.4rem;
            display: none;
            word-break: break-word;
        }

        .flow-node.active .node-description {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        .flow-arrow {
            width: 2px;
            height: 2rem; /* Length of the arrow line */
            background-color: #D5D2C8;
            margin: 0.5rem 0; /* Space above/below arrow */
            position: relative;
        }
        .flow-arrow::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) translateY(50%) rotate(135deg); /* Corrected to point downwards */
            width: 8px;
            height: 8px;
            border-top: 2px solid #D5D2C8;
            border-right: 2px solid #D5D2C8;
        }

        /* Specific colors for flowchart nodes */
        .vulnerability-node { background-color: #F0F8FF; } /* Alice Blue */
        .vulnerability-node:hover { background-color: #DDEBF7; }
        .threat-node { background-color: #FFF3CD; } /* Light Yellow */
        .threat-node:hover { background-color: #FFE699; }
        .impact-node { background-color: #F8D7DA; } /* Light Red */
        .impact-node:hover { background-color: #F5C6CB; }

        /* Ensure titles and descriptions are visible on colored backgrounds */
        .vulnerability-node .node-title, .threat-node .node-title, .impact-node .node-title {
            color: #004085; /* Dark blue for titles */
        }
        .vulnerability-node .node-description, .threat-node .node-description, .impact-node .node-description {
            color: #333333; /* Darker text for descriptions */
        }

        /* Responsive adjustments for flow nodes */
        @media (max-width: 768px) {
            .flow-node {
                width: 100%; /* Full width on small screens */
                flex-basis: 100%;
            }
        }
    </style>
</head>
<body class="leading-relaxed">
    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center py-8 bg-white rounded-lg shadow-md mb-8">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-800 mb-2">CISM Domain 2 Study Guide</h1>
            <p class="text-xl sm:text-2xl text-gray-600">Information Security Risk Management</p>
            <p class="text-md text-gray-500 mt-2">Your Interactive Study Guide for Proactive Security Protection</p>
        </header>

        <nav class="bg-white p-4 rounded-lg shadow-md mb-8 flex justify-center sticky top-0 z-10">
            <button class="nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200 active" data-target="introduction">Introduction</button>
            <button class="nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="risk-assessment">Information Security Risk Assessment</button>
            <button class="nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="risk-response">Information Security Risk Response</button>
            <button class="nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="key-terms">Key Terms</button>
            <button class="nav-item px-4 py-2 text-lg font-medium text-gray-700 hover:text-gray-900 mx-2 sm:mx-4 transition-colors duration-200" data-target="domain-summary">Domain Summary</button>
        </nav>

        <main id="content-area">
            <!-- New Section for Introduction -->
            <section id="introduction" class="content-section fade-in">
                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Introduction to CISM Domain 2</h2>
                <div class="p-6 bg-white rounded-lg shadow-md">
                    <p class="text-gray-700 mb-4">Welcome to the interactive study guide for CISM Domain 2: Information Security Risk Management. This domain is the cornerstone of effective information security, focusing on how organizations identify, assess, respond to, and monitor risks to their valuable information assets. A strong grasp of these principles is not just theoretical; it's crucial for making informed, business-aligned decisions that proactively protect the enterprise.</p>
                    <p class="text-gray-700">Throughout this guide, you will explore the dynamic threat landscape, learn how to analyze vulnerabilities, apply various risk assessment methodologies, and understand the critical strategies for responding to risks. We will also delve into the importance of clear risk and control ownership and the continuous process of monitoring and reporting. This interactive format is designed to enhance your learning experience, making complex topics more accessible and engaging.</p>
                </div>
            </section>

            <!-- Information Security Risk Assessment Section -->
            <section id="risk-assessment" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section A: Information Security Risk Assessment</h2>
                <p class="mb-8 text-gray-700">Information security risk assessment is the systematic process of identifying potential threats and vulnerabilities, analyzing their potential impact, and determining the likelihood of their occurrence. It's about understanding "what could go wrong" and "how bad it could be".</p>

                <!-- Sub-Domain: Emerging Risk and Threat Landscape -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        1. Emerging Risk and Threat Landscape
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">The threat landscape is constantly evolving. As an information security manager, you must be vigilant and proactive in understanding new and evolving dangers.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Understand emerging and evolving threats (e.g., ransomware, insider threats, third-party risks).</h4>
                        <p class="text-gray-600 mb-4">Explore the common distribution of various emerging threats and how they impact organizations:</p>
                        <div class="chart-container mb-6">
                            <canvas id="threatDistributionChart"></canvas>
                        </div>
                        <div class="flex flex-wrap justify-center gap-4 mb-4">
                            <button class="toggle-chart-data btn-ransomware px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="ransomwareFocus">Ransomware</button>
                            <button class="toggle-chart-data btn-insider-threats px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="insiderFocus">Insider Threats</button>
                            <button class="toggle-chart-data btn-third-party-risks px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="thirdPartyFocus">Third-Party Risks</button>
                            <button class="toggle-chart-data btn-phishing px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="phishingFocus">Phishing</button>
                            <button class="toggle-chart-data btn-ddos px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="ddosFocus">DDoS</button>
                            <button class="toggle-chart-data btn-apt px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-200" data-chart-id="threatDistributionChart" data-data-set="aptFocus">APT</button>
                        </div>
                        <div id="threat-explanation" class="text-gray-600 text-sm italic mt-2 text-center">This chart illustrates a simulated distribution of common emerging threats. Use the buttons to view different focuses.</div>
                        
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Monitor threat intelligence feeds and industry trend reports.</h4>
                        <p class="text-gray-600 mb-4">Threat intelligence helps organizations understand the "who, what, where, when, why, and how" of attacks, while industry reports provide broad trends for strategic planning.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Analyze external drivers like regulatory shifts, geopolitical risks, and technological disruption.</h4>
                        <p class="text-gray-600">New regulations (e.g., updated data privacy laws), global events, and emerging technologies (e.g., AI, IoT) constantly introduce new security challenges and risks that must be analyzed.</p>
                    </div>
                </div>

                <!-- Sub-Domain: Vulnerability and Control Deficiency Analysis -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        2. Vulnerability and Control Deficiency Analysis
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">Once threats are understood, the next step is to identify where an organization is susceptible to these threats.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Identify and assess weaknesses in IT systems, processes, and controls.</h4>
                        <p class="text-gray-600 mb-4">This involves using various methods like vulnerability scanning, penetration testing, and security audits to pinpoint weaknesses.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Determine exposure levels due to missing or ineffective controls.</h4>
                        <p class="text-gray-600 mb-4">A control might exist but be poorly designed or implemented, leading to increased exposure and higher potential impact.</p>

                        <h4 class="text-lg font-semibold text-gray-700">c. Map vulnerabilities to threats and evaluate potential impacts.</h4>
                        <p class="text-gray-600 mb-4">Understand which threats could exploit identified vulnerabilities and the potential impact on confidentiality, integrity, availability, and overall business operations. See the example mapping below:</p>
                        <div class="mb-6 p-4 bg-gray-50 rounded-md shadow-sm">
                            <h6 class="text-md font-semibold text-gray-700 mb-2 text-center">Sample Vulnerability-Threat-Impact Mapping</h6>
                            <div class="flowchart-container">
                                <!-- Scenario 1: Unpatched Web Server -->
                                <div class="flow-scenario" data-scenario-id="0">
                                    <div class="flow-node vulnerability-node" data-node-type="vulnerability">
                                        <span class="node-title">Unpatched Web Server</span>
                                        <div class="node-description hidden">Servers with outdated software or missing security patches are prime targets for attackers looking to exploit known weaknesses.</div>
                                    </div>
                                    <div class="flow-arrow hidden" data-arrow-id="0-1"></div>
                                    <div class="flow-node threat-node hidden" data-node-type="threat">
                                        <span class="node-title">Remote Code Execution (RCE)</span>
                                        <div class="node-description hidden">RCE allows an attacker to execute arbitrary code on a remote system, gaining full control. This is often achieved through exploiting software vulnerabilities.</div>
                                    </div>
                                    <div class="flow-arrow hidden" data-arrow-id="1-2"></div>
                                    <div class="flow-node impact-node hidden" data-node-type="impact">
                                        <span class="node-title">Data Breach, System Compromise</span>
                                        <div class="node-description hidden">Confidentiality, Integrity, Availability impact.</div>
                                    </div>
                                </div>
                                <!-- Scenario 2: Weak Employee Password Policy -->
                                <div class="flow-scenario" data-scenario-id="1">
                                    <div class="flow-node vulnerability-node" data-node-type="vulnerability">
                                        <span class="node-title">Weak Employee Password Policy</span>
                                        <div class="node-description hidden">Policies allowing simple, common, or reused passwords make accounts easy targets for automated guessing attacks.</div>
                                    </div>
                                    <div class="flow-arrow hidden" data-arrow-id="0-1"></div>
                                    <div class="flow-node threat-node hidden" data-node-type="threat">
                                        <span class="node-title">Brute-force/Credential Stuffing</span>
                                        <div class="node-description hidden">Brute-force attacks try many passwords until one works. Credential stuffing uses stolen username/password pairs from other breaches to try and log into new systems.</div>
                                    </div>
                                    <div class="flow-arrow hidden" data-arrow-id="1-2"></div>
                                    <div class="flow-node impact-node hidden" data-node-type="impact">
                                        <span class="node-title">Unauthorized Access</span>
                                        <div class="node-description hidden">Confidentiality, Integrity impact.</div>
                                    </div>
                                </div>
                                <!-- Scenario 3: Lack of Data Encryption at Rest -->
                                <div class="flow-scenario" data-scenario-id="2">
                                    <div class="flow-node vulnerability-node" data-node-type="vulnerability">
                                        <span class="node-title">Lack of Data Encryption at Rest</span>
                                        <div class="node-description hidden">Storing sensitive data on devices (laptops, servers, backups) without encryption means the data is readable if the device is lost or stolen.</div>
                                    </div>
                                    <div class="flow-arrow hidden" data-arrow-id="0-1"></div>
                                    <div class="flow-node threat-node hidden" data-node-type="threat">
                                        <span class="node-title">Physical Theft of Storage Device</span>
                                        <div class="node-description hidden">An attacker physically gains possession of a storage device containing unencrypted sensitive data.</div>
                                    </div>
                                    <div class="flow-arrow hidden" data-arrow-id="1-2"></div>
                                    <div class="flow-node impact-node hidden" data-node-type="impact">
                                        <span class="node-title">Data Exposure</span>
                                        <div class="node-description hidden">Confidentiality impact.</div>
                                    </div>
                                </div>
                                <!-- Scenario 4: Single Point of Failure in Network -->
                                <div class="flow-scenario" data-scenario-id="3">
                                    <div class="flow-node vulnerability-node" data-node-type="vulnerability">
                                        <span class="node-title">Single Point of Failure</span>
                                        <div class="node-description hidden">A critical component (e.g., a single router, server, or internet link) whose failure would bring down an entire system or service.</div>
                                    </div>
                                    <div class="flow-arrow hidden" data-arrow-id="0-1"></div>
                                    <div class="flow-node threat-node hidden" data-node-type="threat">
                                        <span class="node-title">Hardware Failure / DDoS</span>
                                        <div class="node-description hidden">Hardware failure is an accidental event. A DDoS attack is a malicious attempt to disrupt normal traffic of a targeted server, service or network by overwhelming the target or its surrounding infrastructure with a flood of Internet traffic.</div>
                                    </div>
                                    <div class="flow-arrow hidden" data-arrow-id="1-2"></div>
                                    <div class="flow-node impact-node hidden" data-node-type="impact">
                                        <span class="node-title">Service Outage, Business Disruption</span>
                                        <div class="node-description hidden">Availability impact.</div>
                                    </div>
                                </div>
                                <!-- Scenario 5: Insufficient Security Awareness Training -->
                                <div class="flow-scenario" data-scenario-id="4">
                                    <div class="flow-node vulnerability-node" data-node-type="vulnerability">
                                        <span class="node-title">Insufficient Awareness Training</span>
                                        <div class="node-description hidden">Employees who are not regularly trained on common attack vectors are more susceptible to falling for scams.</div>
                                    </div>
                                    <div class="flow-arrow hidden" data-arrow-id="0-1"></div>
                                    <div class="flow-node threat-node hidden" data-node-type="threat">
                                        <span class="node-title">Phishing / Social Engineering</span>
                                        <div class="node-description hidden">Phishing uses deceptive emails or messages. Social engineering manipulates people into performing actions or divulging confidential information.</div>
                                    </div>
                                    <div class="flow-arrow hidden" data-arrow-id="1-2"></div>
                                    <div class="flow-node impact-node hidden" data-node-type="impact">
                                        <span class="node-title">Credential Theft, Malware, Financial Fraud</span>
                                        <div class="node-description hidden">Confidentiality, Integrity, Financial impact.</div>
                                    </div>
                                </div>
                            </div>
                            <p class="text-gray-600 text-sm italic mt-2 text-center">Click on a card to see the potential impact of the vulnerability and threat combination.</p>
                        </div>
                    </div>
                </div>

                <!-- Sub-Domain: Risk Assessment and Analysis -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        3. Risk Assessment and Analysis
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">This is where the identified threats, vulnerabilities, and impacts are formally analyzed to quantify or qualify the risk.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Apply qualitative, quantitative, and hybrid risk assessment methods.</h4>
                        <p class="text-gray-600 mb-4">Explore the characteristics of different risk assessment methods:</p>
                        <div class="flex flex-wrap justify-center gap-4 mb-6">
                            <div class="risk-method-card qualitative" data-method="qualitative">
                                <span class="card-title">Qualitative</span>
                                <div class="card-description hidden">Uses descriptive terms (e.g., high, medium, low) for likelihood and impact. It's subjective but quick and often used for initial assessments or when precise data is unavailable. Good for prioritization.</div>
                            </div>
                            <div class="risk-method-card quantitative" data-method="quantitative">
                                <span class="card-title">Quantitative</span>
                                <div class="card-description hidden">Assigns numerical values (e.g., monetary cost, probability percentages) to likelihood and impact. It aims to provide a more objective and measurable view of risk. Useful for cost-benefit analysis (e.g., SLE, ARO, ALE).</div>
                            </div>
                            <div class="risk-method-card hybrid" data-method="hybrid">
                                <span class="card-title">Hybrid</span>
                                <div class="card-description hidden">Combines elements of both qualitative and quantitative approaches. Often, qualitative assessments are used to identify and prioritize risks, and then quantitative analysis is applied to the most critical risks for detailed analysis.</div>
                            </div>
                        </div>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Determine inherent and residual risk.</h4>
                        <p class="text-gray-600 mb-4"><strong>Inherent risk</strong> is the raw risk before controls. <strong>Residual risk</strong> is what remains after controls are applied.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Use standardized risk frameworks (e.g., ISO/IEC 27005, NIST SP 800-30, FAIR, OCTAVE).</h4>
                        <p class="text-gray-600 mb-4">These frameworks provide structure and consistency for risk management processes. Click on a card to learn more:</p>
                        <div class="flex flex-wrap justify-center gap-4 mb-6">
                            <div class="risk-framework-card" data-framework="iso27005">
                                <span class="card-title">ISO/IEC 27005</span>
                                <div class="card-description hidden">Provides guidelines for information security risk management. It supports the general concepts specified in ISO/IEC 27001 (for ISMS) and is designed to assist the satisfactory implementation of information security based on a risk management approach."</div>
                            </div>
                            <div class="risk-framework-card" data-framework="nist80030">
                                <span class="card-title">NIST SP 800-30</span>
                                <div class="card-description hidden">A guide for conducting risk assessments, developed by the National Institute of Standards and Technology (NIST). It provides a systematic approach to identifying, analyzing, and mitigating risks to information systems and organizations."</div>
                            </div>
                            <div class="risk-framework-card" data-framework="fair">
                                <span class="card-title">FAIR</span>
                                <div class="card-description hidden">A quantitative risk analysis model that focuses on understanding and measuring information risk in financial terms. It helps break down complex risk scenarios into measurable components, enabling more objective risk comparisons and cost-benefit analyses."</div>
                            </div>
                            <div class="risk-framework-card" data-framework="octave">
                                <span class="card-title">OCTAVE</span>
                                <div class="card-description hidden">A suite of methods that help organizations assess and manage information security risks. It emphasizes a self-directed approach where organizations identify and prioritize risks based on their own operational risk environment, involving key stakeholders from across the organization."</div>
                            </div>
                        </div>
                        <!-- Removed the separate risk-framework-description div -->

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">d. Evaluate risks based on likelihood and business impact.</h4>
                        <p class="text-gray-600 mb-4">Plotting likelihood against impact helps prioritize risks and align with the organization's risk appetite and tolerance.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">e. Practical Risk Calculations</h4>
                        <p class="text-gray-600 mb-4">Understanding how to quantify risk is crucial for making informed decisions and justifying security investments.</p>

                        <div class="mb-6 p-4 bg-gray-50 rounded-md shadow-sm">
                            <h5 class="text-md font-bold text-gray-800 mb-2">Qualitative Risk Example (Risk Register Entry & Matrix)</h5>
                            <p class="text-gray-700 mb-2">Consider a "High" risk of a "Phishing Attack leading to Credential Theft" with a "Medium" likelihood and "High" impact. This would be documented in a risk register and can be visualized on a matrix:</p>
                            <ul class="list-disc list-inside text-gray-600 ml-4 mb-4">
                                <li><strong>Risk ID:</strong> R-001</li>
                                <li><strong>Risk Description:</strong> Phishing attack leading to credential theft.</li>
                                <li><strong>Inherent Risk:</strong> High</li>
                                <li><strong>Likelihood:</strong> Medium</li>
                                <li><strong>Impact:</strong> High (e.g., data breach, financial loss)</li>
                                <li><strong>Proposed Response:</strong> Mitigate (e.g., advanced email filtering, user training)</li>
                                <li><strong>Residual Risk:</strong> Medium (after controls)</li>
                            </ul>

                            <h6 class="text-md font-semibold text-gray-700 mb-2 text-center">Example Risk Matrix (Likelihood vs. Impact)</h6>
                            <table class="risk-matrix-table">
                                <thead>
                                    <tr>
                                        <th>Likelihood \ Impact</th>
                                        <th>Low</th>
                                        <th>Medium</th>
                                        <th>High</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>High</td>
                                        <td class="medium">Medium</td>
                                        <td class="high">High</td>
                                        <td class="critical">Critical</td>
                                    </tr>
                                    <tr>
                                        <td>Medium</td>
                                        <td class="low">Low</td>
                                        <td class="medium">Medium</td>
                                        <td class="high">High</td>
                                    </tr>
                                    <tr>
                                        <td>Low</td>
                                        <td class="low">Low</td>
                                        <td class="low">Low</td>
                                        <td class="medium">Medium</td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="text-gray-600 text-sm italic mt-2 text-center">In this matrix, our example risk (Medium Likelihood, High Impact) falls into the "High" category.</p>
                        </div>

                        <div class="mb-6 p-4 bg-gray-50 rounded-md shadow-sm">
                            <h5 class="text-md font-bold text-gray-800 mb-2">Quantitative Risk Calculation (ALE)</h5>
                            <p class="text-gray-700 mb-2">Calculate the Annualized Loss Expectancy (ALE) for a given asset:</p>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label for="assetValue" class="block text-gray-700 text-sm font-bold mb-1">Asset Value (AV) ($):</label>
                                    <input type="text" id="assetValue" value="100,000" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                </div>
                                <div>
                                    <label for="exposureFactor" class="block text-gray-700 text-sm font-bold mb-1">Exposure Factor (EF) (% loss):</label>
                                    <input type="number" id="exposureFactor" value="0.75" min="0" max="1" step="0.01" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200">
                                </div>
                            </div>
                            <p class="text-gray-700 mb-2"><strong>Single Loss Expectancy (SLE):</strong> $AV \times EF$</p>
                            <p class="text-lg font-semibold text-gray-800 mb-4">SLE: $<span id="sleResult"></span></p>

                            <label for="aro" class="block text-gray-700 text-sm font-bold mb-1">Annualized Rate of Occurrence (ARO) (times/year):</label>
                            <input type="number" id="aro" value="0.5" min="0" step="0.1" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200 mb-4">

                            <p class="text-gray-700 mb-2"><strong>Annualized Loss Expectancy (ALE):</strong> $SLE \times ARO$</p>
                            <p class="text-lg font-semibold text-gray-800">ALE: $<span id="aleResult"></span></p>
                            <p class="text-gray-600 text-sm italic mt-2">Adjust the values above to see how SLE and ALE change. ARO of 0.5 means the event is expected to occur once every two years.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Information Security Risk Response Section -->
            <section id="risk-response" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Section B: Information Security Risk Response</h2>
                <p class="mb-8 text-gray-700">Once risks have been assessed and analyzed, the next critical phase is to determine how to address them. This involves selecting and implementing appropriate risk treatment strategies.</p>

                <!-- Sub-Domain: Risk Treatment / Risk Response Options -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        1. Risk Treatment / Risk Response Options
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">There are generally four primary strategies for responding to identified risks.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Develop and apply appropriate response strategies:</h4>
                        <p class="text-gray-600 mb-4">Click on a card to learn about each strategy:</p>
                        <div class="flex flex-wrap justify-center gap-4 mb-6">
                            <div class="risk-response-card mitigate" data-response="mitigate">
                                <span class="card-title">Mitigate</span>
                                <div class="card-description hidden">Reduce the likelihood or impact of a risk through the implementation of security controls (e.g., firewalls, encryption, security awareness training). This is the most common response.</div>
                            </div>
                            <div class="risk-response-card transfer" data-response="transfer">
                                <span class="card-title">Transfer</span>
                                <div class="card-description hidden">Shift the financial or operational burden of a risk to a third party (e.g., purchasing cyber insurance, outsourcing to a vendor with strong security clauses).</div>
                            </div>
                            <div class="risk-response-card avoid" data-response="avoid">
                                <span class="card-title">Avoid</span>
                                <div class="card-description hidden">Eliminate the risk entirely by choosing not to engage in or ceasing an activity that gives rise to the risk (e.g., deciding not to store sensitive customer data, discontinuing an insecure legacy application).</div>
                            </div>
                            <div class="risk-response-card accept" data-response="accept">
                                <span class="card-title">Accept</span>
                                <div class="card-description hidden">Acknowledge the existence of a risk and decide to take no further action to mitigate it, usually because the cost of mitigation outweighs the potential impact, or the risk is below the organization's risk tolerance. Requires formal management approval.</div>
                            </div>
                        </div>
                        <!-- Removed the separate risk-response-description div -->

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Ensure treatment aligns with legal, regulatory, and business constraints.</h4>
                        <p class="text-gray-600 mb-4">Risk treatment decisions must comply with all applicable laws and regulations and support overall business objectives.</p>

                        <h4 class="text-lg font-semibold text-gray-700">c. Select controls using frameworks like ISO/IEC 27002 and NIST CSF.</h4>
                        <p class="text-gray-600">These frameworks provide a comprehensive set of generic information security controls and best practices for implementation.</p>
                    </div>
                </div>

                <!-- Sub-Domain: Risk and Control Ownership -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        2. Risk and Control Ownership
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">Clear accountability is essential for effective risk management.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Assign risk ownership to appropriate stakeholders (e.g., data owners, business units).</h4>
                        <p class="text-gray-600 mb-4">Risks belong to the business functions that generate or are most impacted by them, not solely to the security department.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Establish accountability for control implementation and operation.</h4>
                        <p class="text-gray-600 mb-4">Individuals or teams responsible for the implementation and maintenance of specific security controls must be clearly defined.</p>

                        <h4 class="text-lg font-semibold text-gray-700">c. Define responsibilities in risk treatment plans and governance documentation.</h4>
                        <p class="text-gray-600 mb-4">Formal documentation like risk treatment plans and governance policies ensure that risk management is embedded into the organizational culture. Explore typical roles and their ownership responsibilities in the hierarchy below:</p>
                        <div class="mb-6 p-4 bg-gray-50 rounded-md shadow-sm">
                            <h6 class="text-md font-semibold text-gray-700 mb-4 text-center">Corporate Hierarchy: Risk and Control Ownership</h6>
                            <div class="hierarchy-chart-container">
                                <div class="role-node board" data-role="board">
                                    <span class="role-title">Board/Executive Management</span>
                                    <div class="role-description hidden"></div>
                                </div>
                                <div class="hierarchy-line"></div>
                                <div class="role-node ciso" data-role="ciso">
                                    <span class="role-title">CISO / Information Security Manager</span>
                                    <div class="role-description hidden"></div>
                                </div>
                                <div class="hierarchy-line-split"></div>
                                <div class="flex justify-center gap-8 w-full">
                                    <div class="role-node data-owners" data-role="dataOwners">
                                        <span class="role-title">Data Owners / Business Unit Heads</span>
                                        <div class="role-description hidden"></div>
                                    </div>
                                    <div class="role-node it-ops" data-role="itOps">
                                        <span class="role-title">IT Operations / Security Teams</span>
                                        <div class="role-description hidden"></div>
                                    </div>
                                </div>
                                <div class="hierarchy-line"></div>
                                <div class="role-node end-users" data-role="endUsers">
                                    <span class="role-title">End Users</span>
                                    <div class="role-description hidden"></div>
                                </div>
                            </div>
                            <p class="text-gray-600 text-sm italic mt-2 text-center">Click on a role in the hierarchy above to see a detailed description of their responsibilities.</p>
                        </div>
                    </div>
                </div>

                <!-- Sub-Domain: Risk Monitoring and Reporting -->
                <div class="mb-10 p-6 bg-white rounded-lg shadow-md">
                    <button class="accordion-button w-full text-left py-4 px-6 text-xl font-semibold text-gray-800 flex justify-between items-center">
                        3. Risk Monitoring and Reporting
                        <span class="accordion-icon text-2xl">+</span>
                    </button>
                    <div class="accordion-content hidden p-6">
                        <p class="text-gray-700 mb-4">Risk management is not a one-time event; it's a continuous process that requires ongoing monitoring and communication.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">b. Monitor key risk indicators (KRIs), control effectiveness, and residual risk levels.</h4>
                        <p class="text-gray-600 mb-4">Continuously track metrics that provide early warning signals of increasing risk exposure and assess the ongoing effectiveness of security controls.</p>
                        <div class="chart-container mb-6">
                            <canvas id="riskMonitoringKRIChart"></canvas>
                        </div>
                        <div class="mb-4">
                            <label for="riskMonitoringKRISelect" class="block text-gray-700 text-sm font-bold mb-2">Select KRI to view trend:</label>
                            <select id="riskMonitoringKRISelect" class="block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-200">
                                <option value="unpatchedSystems">Unpatched Critical Systems</option>
                                <option value="securityIncidents">Security Incidents Trend</option>
                                <option value="thirdPartyBreaches">Third-Party Breach Incidents</option>
                            </select>
                        </div>
                        <p class="text-gray-600 text-sm italic">This line chart illustrates simulated trends for various Key Risk Indicators (KRIs) related to risk monitoring. Select an KRI from the dropdown to see its trend.</p>

                        <h4 class="text-lg font-semibold text-gray-700 mb-3">a. Maintain and update the risk register.</h4>
                        <p class="text-gray-600 mb-4">The risk register is a living document that tracks all identified risks, their status, and assigned ownership.</p>
                        
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">c. Report risk trends and posture to leadership and boards using dashboards, scorecards, and executive summaries.</h4>
                        <p class="text-gray-600 mb-4">Tailor reports to the audience, providing high-level, strategic overviews for leadership to support informed decision-making. Below is a sample risk posture scorecard:</p>
                        <div class="mb-6 p-4 bg-gray-50 rounded-md shadow-sm">
                            <h6 class="text-md font-semibold text-gray-700 mb-2 text-center">Sample Quarterly Risk Posture Scorecard</h6>
                            <table class="risk-scorecard-table">
                                <thead>
                                    <tr>
                                        <th>Risk Area</th>
                                        <th>Current Level</th>
                                        <th>Trend</th>
                                        <th>Last Review</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Cyber Attack Surface</td>
                                        <td class="risk-level-medium">Medium</td>
                                        <td class="trend-stable">Stable</td>
                                        <td>Q2 2024</td>
                                    </tr>
                                    <tr>
                                        <td>Data Privacy Compliance</td>
                                        <td class="risk-level-low">Low</td>
                                        <td class="trend-down">Improving</td>
                                        <td>Q2 2024</td>
                                    </tr>
                                    <tr>
                                        <td>Third-Party Vendor Risk</td>
                                        <td class="risk-level-high">High</td>
                                        <td class="trend-up">Worsening</td>
                                        <td>Q2 2024</td>
                                    </tr>
                                    <tr>
                                        <td>Insider Threat</td>
                                        <td class="risk-level-medium">Medium</td>
                                        <td class="trend-stable">Stable</td>
                                        <td>Q2 2024</td>
                                    </tr>
                                    <tr>
                                        <td>Operational Resilience</td>
                                        <td class="risk-level-low">Low</td>
                                        <td class="trend-down">Improving</td>
                                        <td>Q2 2024</td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="text-gray-600 text-sm italic mt-2 text-center">This scorecard provides a high-level summary of key risk areas, their current status, and trend, ideal for executive reporting.</p>
                        </div>
                        
                        <h4 class="text-lg font-semibold text-gray-700">d. Support continuous improvement in risk response and awareness.</h4>
                        <p class="text-gray-600">Establish feedback loops and ongoing security awareness programs to continuously enhance the organization's risk posture.</p>
                    </div>
                </div>
            </section>

            <!-- New Section for Key Terms -->
            <section id="key-terms" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Key Terms</h2>
                <p class="mb-8 text-gray-700">Test your knowledge of key terms in Information Security Risk Management with these interactive flashcards. Click on a card to reveal its definition.</p>

                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-6">
                    <!-- Key Terms will be populated here by JavaScript -->
                </div>
            </section>

            <!-- New Section for Domain Summary -->
            <section id="domain-summary" class="content-section hidden">
                <h2 class="text-3xl font-bold section-header text-gray-800 mb-6">Domain Summary</h2>
                <div class="p-6 bg-white rounded-lg shadow-md">
                    <p class="text-gray-700 mb-4">Domain 2: Information Security Risk Management is a critical component of the CISM framework, focusing on the systematic identification, assessment, response, and monitoring of risks to an organization's information assets. It emphasizes a proactive approach to understanding the evolving threat landscape, including emerging threats like ransomware, insider threats, and third-party risks, and analyzing their potential impact.</p>
                    <p class="text-gray-700 mb-4">The domain covers various risk assessment methodologies, including qualitative, quantitative, and hybrid approaches, and the use of standardized frameworks such as ISO/IEC 27005, NIST SP 800-30, FAIR, and OCTAVE. It highlights the importance of distinguishing between inherent and residual risk and evaluating risks based on their likelihood and business impact. Furthermore, Domain 2 delves into risk response strategies—mitigating with controls, transferring through contracts or insurance, avoiding risky activities, or accepting risks with management approval—ensuring these align with legal, regulatory, and business constraints.</p>
                    <p class="text-gray-700">Crucially, this domain stresses the assignment of clear risk and control ownership to appropriate stakeholders, establishing accountability for implementation and operation. Finally, it covers the continuous process of risk monitoring and reporting, including maintaining risk registers, tracking Key Risk Indicators (KRIs), and communicating risk posture to leadership through dashboards and executive summaries, all aimed at supporting continuous improvement in the organization's security posture.</p>
                </div>
            </section>
        </main>

        <footer class="text-center py-6 mt-8 text-gray-500 text-sm">
            <p>&copy; 2024 CISM Study Guide. All rights reserved. For educational purposes only.</p>
        </footer>
    </div>

    <script>
        // JS Variables for current state and base data
        const currentSection = {
            id: 'introduction' // Default to introduction
        };

        // Data for Section A.1.a (Emerging Threats)
        const threatDistributionData = {
            // Define the fixed order of labels and their corresponding colors
            threatOrder: ['Ransomware', 'Insider Threats', 'Third-Party Risks', 'Phishing', 'DDoS', 'APT'],
            threatColors: ['#A1C9CE', '#8FB8A1', '#FFD700', '#FF6384', '#6A5ACD', '#DAA520'], // These are the chart colors

            // Data for each focus, ensuring the data array matches threatOrder
            overall: { // This data is now only used as a base for specific focuses
                data: [25, 15, 20, 20, 10, 10], // Sums to 100
                explanation: `This chart shows the overall distribution of common emerging threats. Ransomware: 25%, Insider Threats: 15%, Third-Party Risks: 20%, Phishing: 20%, DDoS: 10%, APT: 10%.`
            },
            ransomwareFocus: {
                data: [40, 10, 15, 15, 10, 10], // Ransomware is high
                explanation: `This view highlights a scenario where Ransomware is a primary concern, accounting for 40% of the focus, with other threats de-emphasized. Ransomware is malicious software that encrypts data and demands a ransom for its release. It can severely disrupt business operations.`
            },
            insiderFocus: {
                data: [10, 40, 15, 15, 10, 10], // Insider Threats is high
                explanation: `This view emphasizes Insider Threats, showing them as 40% of the focus, indicating a strong internal security posture or recent internal concerns. Insider threats originate from within the organization and can be malicious or unintentional.`
            },
            thirdPartyFocus: {
                data: [15, 10, 40, 15, 10, 10], // Third-Party Risks is high
                explanation: `This view emphasizes Third-Party Risks, showing them as 40% of the focus, indicating a strong emphasis on supply chain security or vendor management. Third-party risks arise from reliance on external vendors and service providers, whose security posture can impact the organization.`
            },
            phishingFocus: {
                data: [15, 10, 10, 40, 10, 15], // Phishing is high
                explanation: `This view emphasizes Phishing attacks, showing them as 40% of the focus. Phishing is a common social engineering technique used to trick individuals into revealing sensitive information or installing malware.`
            },
            ddosFocus: {
                data: [10, 10, 15, 15, 40, 10], // DDoS is high
                explanation: `This view emphasizes DDoS attacks, showing them as 40% of the focus. DDoS (Distributed Denial of Service) attacks overwhelm a system or network with traffic, making it unavailable to legitimate users.`
            },
            aptFocus: {
                data: [10, 10, 15, 15, 10, 40], // APT is high
                explanation: `This view emphasizes APTs, showing them as 40% of the focus. APTs (Advanced Persistent Threats) are sophisticated, prolonged cyberattacks where an intruder gains access to a network and remains undetected for an extended period.`
            }
        };

        // Data for Section A.3.a (Risk Assessment Methods)
        const riskMethodDescriptions = {
            qualitative: "Uses descriptive terms (e.g., high, medium, low) for likelihood and impact. It's subjective but quick and often used for initial assessments or when precise data is unavailable. Good for prioritization.",
            quantitative: "Assigns numerical values (e.g., monetary cost, probability percentages) to likelihood and impact. It aims to provide a more objective and measurable view of risk. Useful for cost-benefit analysis (e.g., SLE, ARO, ALE).",
            hybrid: "Combines elements of both qualitative and quantitative approaches. Often, qualitative assessments are used to identify and prioritize risks, and then quantitative analysis is applied to the most critical risks for detailed analysis."
        };

        // Data for Section A.3.c (Risk Frameworks)
        const riskFrameworkDescriptions = {
            iso27005: {
                name: "ISO/IEC 27005",
                description: "Provides guidelines for information security risk management. It supports the general concepts specified in ISO/IEC 27001 (for ISMS) and is designed to assist the satisfactory implementation of information security based on a risk management approach."
            },
            nist80030: {
                name: "NIST SP 800-30",
                description: "A guide for conducting risk assessments, developed by the National Institute of Standards and Technology (NIST). It provides a systematic approach to identifying, analyzing, and mitigating risks to information systems and organizations."
            },
            fair: {
                name: "FAIR (Factor Analysis of Information Risk)",
                description: "A quantitative risk analysis model that focuses on understanding and measuring information risk in financial terms. It helps break down complex risk scenarios into measurable components, enabling more objective risk comparisons and cost-benefit analyses."
            },
            octave: {
                name: "OCTAVE (Operationally Critical Threat, Asset, and Vulnerability Evaluation)",
                description: "A suite of methods that help organizations assess and manage information security risks. It emphasizes a self-directed approach where organizations identify and prioritize risks based on their own operational risk environment, involving key stakeholders from across the organization."
            }
        };

        // Data for Section B.1.a (Risk Response Options)
        const riskResponseDescriptions = {
            mitigate: "Implement controls to lower the likelihood or impact of a risk. This is the most common response, involving security controls like firewalls, encryption, or security awareness training.",
            transfer: "Shift the financial or operational burden of a risk to a third party (e.g., purchasing cyber insurance, outsourcing to a vendor with strong security clauses).",
            avoid: "Eliminate the risk entirely by choosing not to engage in or ceasing an activity that gives rise to the risk (e.g., deciding not to store sensitive customer data, discontinuing an insecure legacy application).",
            accept: "Acknowledge the existence of a risk and decide to take no further action to mitigate it, usually because the cost of mitigation outweighs the potential impact, or the risk is below the organization's risk tolerance. Requires formal management approval."
        };

        // Data for Section B.2.c (Risk and Control Ownership) - Detailed Role Descriptions
        const detailedRoleDescriptions = {
            board: {
                title: "Board/Executive Management Responsibilities",
                description: "The Board and Executive Management hold ultimate accountability for information security risk. Their responsibilities include defining the organization's overall risk appetite, approving major risk management strategies and significant security investments, and providing high-level oversight to ensure that information security aligns with business objectives and regulatory requirements. They ensure adequate resources are allocated for control implementation and monitor the overall effectiveness of the control environment."
            },
            ciso: {
                title: "CISO / Information Security Manager Responsibilities",
                description: "The CISO (Chief Information Security Officer) or Information Security Manager is responsible for the strategic direction and operational oversight of the information security program. This includes advising senior leadership on risk identification and assessment, reporting on the organization's risk posture, facilitating risk treatment decisions, developing and managing the information security program, overseeing control implementation and operation, and reporting on control effectiveness to relevant stakeholders."
            },
            dataOwners: {
                title: "Data Owners / Business Unit Heads Responsibilities",
                description: "Data Owners and Business Unit Heads are accountable for the risks associated with the information assets and business processes within their respective domains. They are responsible for making decisions on how to treat these risks (accept, transfer, or mitigate) and ensuring that appropriate controls are implemented and operated effectively within their business units to protect their data and processes. They often work closely with the CISO to understand their specific risk profiles."
            },
            itOps: {
                title: "IT Operations / Security Teams Responsibilities",
                description: "IT Operations and dedicated Security Teams are primarily responsible for the technical implementation and operational maintenance of security controls. Their duties include identifying technical risks and vulnerabilities, recommending specific mitigation strategies, implementing and maintaining technical controls (such as firewalls, intrusion detection systems, and patching), managing access controls, and responding to security incidents as part of the overall security program."
            },
            endUsers: {
                title: "End User Responsibilities",
                description: "Every end user in the organization plays a vital role in information security. Their responsibilities include understanding and adhering to established security policies and procedures, practicing good security hygiene (e.g., using strong passwords, identifying phishing attempts), and reporting suspicious activities or potential security incidents. While they may not 'own' risks in the same strategic sense as management, their adherence to controls is critical for overall risk reduction."
            }
        };


        // Data for Section B.3.b (Risk Monitoring KRIs)
        const riskMonitoringKRITrendData = {
            unpatchedSystems: {
                label: 'Unpatched Critical Systems (Count)',
                data: [15, 12, 10, 8, 7, 6, 5, 4, 3, 2, 1, 1], // Simulating a decreasing trend
                borderColor: '#FF6384',
                backgroundColor: 'rgba(255, 99, 132, 0.2)'
            },
            securityIncidents: {
                label: 'Security Incidents Reported (Monthly)',
                data: [5, 7, 6, 8, 9, 7, 6, 5, 4, 3, 2, 2], // Simulating fluctuations
                borderColor: '#A1C9CE',
                backgroundColor: 'rgba(161, 201, 206, 0.2)'
            },
            thirdPartyBreaches: {
                label: 'Third-Party Breach Incidents (Quarterly)',
                data: [2, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0], // Simulating infrequent, but impactful events
                borderColor: '#8FB8A1',
                backgroundColor: 'rgba(143, 184, 161, 0.2)'
            }
        };
        const riskMonitoringKRILabels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

        // Data for Key Terms (New for Domain 2)
        const keyTermsData = [
            { term: "Inherent Risk", definition: "The level of risk that exists before any controls or other mitigating factors are put in place. It's the raw risk." },
            { term: "Residual Risk", definition: "The level of risk that remains after controls have been implemented and account for their effectiveness. This is the risk that management accepts." },
            { term: "Risk Appetite", definition: "The amount of risk an organization is willing to take to achieve its objectives. It's a high-level strategic statement." },
            { term: "Risk Tolerance", definition: "The acceptable deviation from the risk appetite. It sets specific thresholds for different types of risks." },
            { term: "Qualitative Risk Assessment", definition: "Uses descriptive terms (e.g., high, medium, low) to define likelihood and impact. It's subjective but quick and often used for initial assessments." },
            { term: "Quantitative Risk Assessment", definition: "Assigns numerical values (e.g., monetary cost, probability percentages) to likelihood and impact. It aims to provide a more objective and measurable view of risk (e.g., ALE, SLE, ARO)." },
            { term: "Annualized Loss Expectancy (ALE)", definition: "The expected monetary loss for an asset due to a risk over a one-year period. Calculated as Single Loss Expectancy (SLE) multiplied by Annualized Rate of Occurrence (ARO)." },
            { term: "Single Loss Expectancy (SLE)", definition: "The monetary loss expected each time a risk event occurs. Calculated as Asset Value (AV) multiplied by Exposure Factor (EF)." },
            { term: "Annualized Rate of Occurrence (ARO)", definition: "The estimated frequency at which a threat event is expected to occur within a one-year period." },
            { term: "Risk Mitigation", definition: "Reducing the likelihood or impact of a risk through the implementation of security controls." },
            { term: "Risk Transfer", definition: "Shifting the financial or operational burden of a risk to a third party, often through insurance or contractual agreements." },
            { term: "Risk Avoidance", definition: "Eliminating the risk entirely by choosing not to engage in or ceasing an activity that gives rise to the risk." },
            { term: "Risk Acceptance", definition: "Acknowledging the existence of a risk and deciding to take no further action to mitigate it, usually with formal management approval." },
            { term: "Key Risk Indicator (KRI)", definition: "Metrics that provide an early warning signal of increasing risk exposure, helping in proactive risk management." },
            { term: "Risk Register", definition: "A central repository for all identified risks, including their description, ownership, assessment, and treatment status." }
        ];


        let threatDistributionChartInstance;
        let riskMonitoringKRIChartInstance;

        // Utility function to wrap labels for charts (no longer used for legend directly)
        const wrapLabel = (label, maxCharsPerLine = 16) => {
            if (label.length <= maxCharsPerLine) return label;
            const words = label.split(' ');
            let line = '';
            let lines = [];
            words.forEach(word => {
                if ((line + word).length > maxCharsPerLine) {
                    lines.push(line.trim());
                    line = word + ' ';
                } else {
                    line += word + ' ';
                }
            });
            lines.push(line.trim());
            return lines;
        };

        // Initialize Charts
        const initThreatDistributionChart = () => {
            const ctx = document.getElementById('threatDistributionChart').getContext('2d');
            threatDistributionChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: threatDistributionData.threatOrder, // Use fixed order for labels
                    datasets: [{
                        data: threatDistributionData.overall.data, // Initial data
                        backgroundColor: threatDistributionData.threatColors, // Use fixed colors
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    const label = context[0].label;
                                    return Array.isArray(label) ? label.join(' ') : label;
                                },
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed) {
                                        label += context.parsed + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        };

        const initRiskMonitoringKRIChart = () => {
            const ctx = document.getElementById('riskMonitoringKRIChart').getContext('2d');
            riskMonitoringKRIChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: riskMonitoringKRILabels,
                    datasets: [{
                        label: riskMonitoringKRITrendData.unpatchedSystems.label,
                        data: riskMonitoringKRITrendData.unpatchedSystems.data,
                        borderColor: '#FF6384',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Count'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Month'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return context[0].label;
                                }
                            }
                        }
                    }
                }
            });
        };

        // Update Chart Functions
        const updateChart = (chartInstance, newData, newLabels, newColors) => {
            if (chartInstance) {
                chartInstance.data.labels = newLabels;
                chartInstance.data.datasets[0].data = newData;
                chartInstance.data.datasets[0].backgroundColor = newColors; /* Ensure colors are updated */
                chartInstance.update();
            }
        };

        const updateLineChart = (chartInstance, newData, newLabel, newBorderColor, newBackgroundColor) => {
            if (chartInstance) {
                chartInstance.data.datasets[0].label = newLabel;
                chartInstance.data.datasets[0].data = newData;
                chartInstance.data.datasets[0].borderColor = newBorderColor;
                chartInstance.data.datasets[0].backgroundColor = newBackgroundColor;
                chartInstance.data.datasets[0].fill = true;
                chartInstance.update();
            }
        };

        // Quantitative Risk Calculation Function
        const calculateQuantitativeRisk = () => {
            const assetValueInput = document.getElementById('assetValue');
            const rawAssetValue = assetValueInput.value.replace(/,/g, ''); // Remove commas for parsing
            let assetValue = parseFloat(rawAssetValue);

            const exposureFactor = parseFloat(document.getElementById('exposureFactor').value);
            const aro = parseFloat(document.getElementById('aro').value);

            let sle = 0;
            let ale = 0;

            if (!isNaN(assetValue)) {
                // Format the input value immediately after parsing
                assetValueInput.value = assetValue.toLocaleString('en-US');
            } else {
                assetValue = 0; // Treat invalid input as 0 for calculation
            }


            if (!isNaN(assetValue) && !isNaN(exposureFactor)) {
                sle = assetValue * exposureFactor;
            }

            if (!isNaN(sle) && !isNaN(aro)) {
                ale = sle * aro;
            }

            // Format monetary values with commas and two decimal places
            document.getElementById('sleResult').textContent = sle.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            document.getElementById('aleResult').textContent = ale.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        };


        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Initial Chart Render
            initThreatDistributionChart();
            initRiskMonitoringKRIChart();

            // Initial quantitative risk calculation display
            calculateQuantitativeRisk();

            // Navigation
            document.querySelectorAll('.nav-item').forEach(button => {
                button.addEventListener('click', () => {
                    document.querySelectorAll('.nav-item').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    document.querySelectorAll('.content-section').forEach(section => {
                        section.classList.add('hidden');
                        section.classList.remove('fade-in');
                    });

                    const targetSection = document.getElementById(button.dataset.target);
                    targetSection.classList.remove('hidden');
                    targetSection.classList.add('fade-in');
                    currentSection.id = button.dataset.target;

                    // Specific rendering for Key Terms section if activated
                    if (button.dataset.target === 'key-terms') {
                        renderKeyTerms();
                    }
                });
            });

            // Set the Introduction tab as active by default on load
            const introButton = document.querySelector('.nav-item[data-target="introduction"]');
            const introSection = document.getElementById('introduction');
            if (introButton && introSection) {
                introButton.classList.add('active');
                introSection.classList.remove('hidden');
                introSection.classList.add('fade-in');
                currentSection.id = 'introduction';
            }


            // Accordion Functionality
            document.querySelectorAll('.accordion-button').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('.accordion-icon');

                    if (content.classList.contains('hidden')) {
                        content.classList.remove('hidden');
                        content.classList.add('fade-in');
                        icon.textContent = '–';
                    } else {
                        content.classList.add('hidden');
                        content.classList.remove('fade-in');
                        icon.textContent = '+';
                    }
                });
            });

            // Threat Distribution Chart Toggles
            const threatExplanationDiv = document.getElementById('threat-explanation');
            document.querySelectorAll('.toggle-chart-data[data-chart-id="threatDistributionChart"]').forEach(button => {
                button.addEventListener('click', () => {
                    const dataSetKey = button.dataset.dataSet;
                    const data = threatDistributionData[dataSetKey];
                    
                    // Update chart with specific data and fixed colors
                    updateChart(threatDistributionChartInstance, data.data, threatDistributionData.threatOrder, threatDistributionData.threatColors);

                    // Update explanation
                    threatExplanationDiv.textContent = data.explanation;
                });
            });


            // Risk Assessment Method Card Toggles
            document.querySelectorAll('.risk-method-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const methodKey = card.dataset.method;

                    // Close all other open cards in this section
                    document.querySelectorAll('.risk-method-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    // Toggle the clicked card's active class
                    card.classList.toggle('active');

                    // If the card is now active, populate its description
                    if (card.classList.contains('active') && descriptionDiv && riskMethodDescriptions[methodKey]) {
                        descriptionDiv.innerHTML = `<p>${riskMethodDescriptions[methodKey]}</p>`; // Set content
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = ''; // Clear content if deactivating
                    }
                });
            });

            // Risk Framework Card Toggles
            document.querySelectorAll('.risk-framework-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const frameworkKey = card.dataset.framework;

                    // Close all other open cards
                    document.querySelectorAll('.risk-framework-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    // Toggle the clicked card's active class
                    card.classList.toggle('active');

                    // If the card is now active, populate its description
                    if (card.classList.contains('active') && descriptionDiv && riskFrameworkDescriptions[frameworkKey]) {
                        descriptionDiv.innerHTML = `<p>${riskFrameworkDescriptions[frameworkKey].description}</p>`; // Set content
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = ''; // Clear content if deactivating
                    }
                });
            });


            // Risk Response Option Description Toggles
            document.querySelectorAll('.risk-response-card').forEach(card => {
                card.addEventListener('click', () => {
                    const descriptionDiv = card.querySelector('.card-description');
                    const responseKey = card.dataset.response;

                    // Close all other open cards
                    document.querySelectorAll('.risk-response-card').forEach(otherCard => {
                        const otherDescriptionDiv = otherCard.querySelector('.card-description');
                        if (otherCard !== card && !otherDescriptionDiv.classList.contains('hidden')) {
                            otherCard.classList.remove('active');
                        }
                    });

                    // Toggle the clicked card's active class
                    card.classList.toggle('active');

                    // If the card is now active, populate its description
                    if (card.classList.contains('active') && descriptionDiv && riskResponseDescriptions[responseKey]) {
                        descriptionDiv.innerHTML = `<p>${riskResponseDescriptions[responseKey]}</p>`; // Set content
                    } else if (descriptionDiv) {
                        descriptionDiv.innerHTML = ''; // Clear content if deactivating
                    }
                });
            });

            // Risk and Control Ownership Role Details
            document.querySelectorAll('.role-node').forEach(roleNode => {
                roleNode.addEventListener('click', () => {
                    const roleKey = roleNode.dataset.role;
                    const roleInfo = detailedRoleDescriptions[roleKey];
                    const roleDescriptionDiv = roleNode.querySelector('.role-description');

                    // Close all other open role descriptions
                    document.querySelectorAll('.role-node').forEach(otherRoleNode => {
                        const otherRoleDescriptionDiv = otherRoleNode.querySelector('.role-description');
                        if (otherRoleNode !== roleNode && otherRoleDescriptionDiv && !otherRoleDescriptionDiv.classList.contains('hidden')) {
                            otherRoleNode.classList.remove('active');
                        }
                    });

                    // Toggle the clicked role's active class
                    roleNode.classList.toggle('active');

                    // If the role node is now active, populate its description
                    if (roleNode.classList.contains('active') && roleDescriptionDiv && roleInfo) {
                        roleDescriptionDiv.innerHTML = `<p>${roleInfo.description}</p>`; // Set content
                    } else if (descriptionDiv) {
                        roleDescriptionDiv.innerHTML = ''; // Clear content if deactivating
                    }
                });
            });


            // Risk Monitoring KRI Chart Selector
            document.getElementById('riskMonitoringKRISelect').addEventListener('change', (event) => {
                const selectedKRI = event.target.value;
                const data = riskMonitoringKRITrendData[selectedKRI];
                updateLineChart(riskMonitoringKRIChartInstance, data.data, data.label, data.borderColor, data.backgroundColor);
            });

            // Quantitative Risk Calculation Event Listeners
            document.getElementById('assetValue').addEventListener('input', calculateQuantitativeRisk);
            document.getElementById('exposureFactor').addEventListener('input', calculateQuantitativeRisk);
            document.getElementById('aro').addEventListener('input', calculateQuantitativeRisk);

            // Function to render Key Terms cards
            const renderKeyTerms = () => {
                const keyTermsContainer = document.querySelector('#key-terms .grid');
                if (!keyTermsContainer) return; // Exit if container not found
                keyTermsContainer.innerHTML = ''; // Clear existing cards

                keyTermsData.forEach((item, index) => {
                    const cardHtml = `
                        <div class="key-term-card" data-term-key="${index}">
                            <h3 class="card-title">${item.term}</h3>
                            <div class="card-description"></div>
                        </div>
                    `;
                    keyTermsContainer.insertAdjacentHTML('beforeend', cardHtml);
                });

                // Add event listeners for key term cards
                document.querySelectorAll('.key-term-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const descriptionDiv = card.querySelector('.card-description');
                        const termIndex = parseInt(card.dataset.termKey);

                        // Close all other open cards and remove 'active' class
                        document.querySelectorAll('.key-term-card').forEach(otherCard => {
                            if (otherCard !== card) {
                                otherCard.classList.remove('active');
                            }
                        });

                        // Toggle the clicked card's active class
                        card.classList.toggle('active');

                        // If the card is now active, populate its description
                        if (card.classList.contains('active') && descriptionDiv && keyTermsData[termIndex]) {
                            descriptionDiv.innerHTML = `<p>${keyTermsData[termIndex].definition}</p>`; // Set content
                        } else if (descriptionDiv) {
                            descriptionDiv.innerHTML = ''; // Clear content if deactivating
                        }
                    });
                });
            };

            // Vulnerability Scenario Card Toggles
            document.querySelectorAll('.flow-node[data-node-type="vulnerability"]').forEach(vulnerabilityNode => {
                vulnerabilityNode.addEventListener('click', () => {
                    const scenarioContainer = vulnerabilityNode.closest('.flow-scenario');
                    const threatNode = scenarioContainer.querySelector('.flow-node[data-node-type="threat"]');
                    const arrow1 = scenarioContainer.querySelector('.flow-arrow[data-arrow-id="0-1"]');
                    const impactNode = scenarioContainer.querySelector('.flow-node[data-node-type="impact"]');
                    const arrow2 = scenarioContainer.querySelector('.flow-arrow[data-arrow-id="1-2"]');
                    const vulnerabilityDescriptionDiv = vulnerabilityNode.querySelector('.node-description');

                    // Close all other scenarios
                    document.querySelectorAll('.flow-scenario').forEach(otherScenario => {
                        if (otherScenario !== scenarioContainer) {
                            otherScenario.querySelectorAll('.flow-node').forEach(node => {
                                node.classList.remove('active');
                                const desc = node.querySelector('.node-description');
                                if (desc) desc.style.display = 'none';
                            });
                            otherScenario.querySelectorAll('.flow-arrow').forEach(arrow => arrow.classList.add('hidden'));
                            otherScenario.querySelectorAll('.flow-node[data-node-type="threat"]').forEach(node => node.classList.add('hidden'));
                            otherScenario.querySelectorAll('.flow-node[data-node-type="impact"]').forEach(node => node.classList.add('hidden'));
                        }
                    });

                    // Toggle current vulnerability node
                    vulnerabilityNode.classList.toggle('active');

                    if (vulnerabilityNode.classList.contains('active')) {
                        if (vulnerabilityDescriptionDiv) vulnerabilityDescriptionDiv.style.display = 'block';
                        if (threatNode) threatNode.classList.remove('hidden');
                        if (arrow1) arrow1.classList.remove('hidden');
                    } else {
                        if (vulnerabilityDescriptionDiv) vulnerabilityDescriptionDiv.style.display = 'none';
                        if (threatNode) threatNode.classList.add('hidden');
                        if (arrow1) arrow1.classList.add('hidden');
                        if (impactNode) impactNode.classList.add('hidden');
                        if (arrow2) arrow2.classList.add('hidden');
                    }
                });
            });

            document.querySelectorAll('.flow-node[data-node-type="threat"]').forEach(threatNode => {
                threatNode.addEventListener('click', () => {
                    const scenarioContainer = threatNode.closest('.flow-scenario');
                    const impactNode = scenarioContainer.querySelector('.flow-node[data-node-type="impact"]');
                    const arrow2 = scenarioContainer.querySelector('.flow-arrow[data-arrow-id="1-2"]');
                    const threatDescriptionDiv = threatNode.querySelector('.node-description');

                    // Close other impact nodes in the same scenario if open
                    scenarioContainer.querySelectorAll('.flow-node[data-node-type="impact"]').forEach(node => {
                        if (node !== impactNode) { // Only hide if it's a different impact node in the same scenario
                            node.classList.remove('active');
                            const desc = node.querySelector('.node-description');
                            if (desc) desc.style.display = 'none';
                        }
                    });

                    // Toggle current threat node
                    threatNode.classList.toggle('active');

                    if (threatNode.classList.contains('active')) {
                        if (threatDescriptionDiv) threatDescriptionDiv.style.display = 'block';
                        if (impactNode) impactNode.classList.remove('hidden');
                        if (arrow2) arrow2.classList.remove('hidden');
                    } else {
                        if (threatDescriptionDiv) threatDescriptionDiv.style.display = 'none';
                        if (impactNode) impactNode.classList.add('hidden');
                        if (arrow2) arrow2.classList.add('hidden');
                    }
                });
            });

            document.querySelectorAll('.flow-node[data-node-type="impact"]').forEach(impactNode => {
                impactNode.addEventListener('click', () => {
                    impactNode.classList.toggle('active');
                    const impactDescriptionDiv = impactNode.querySelector('.node-description');
                    if (impactNode.classList.contains('active')) {
                        if (impactDescriptionDiv) impactDescriptionDiv.style.display = 'block';
                    } else {
                        if (impactDescriptionDiv) impactDescriptionDiv.style.display = 'none';
                    }
                });
            });

            // Initial state: hide all threat and impact nodes and arrows
            document.querySelectorAll('.flow-node[data-node-type="threat"]').forEach(node => {
                node.classList.add('hidden');
                const desc = node.querySelector('.node-description');
                if (desc) desc.style.display = 'none';
            });
            document.querySelectorAll('.flow-node[data-node-type="impact"]').forEach(node => {
                node.classList.add('hidden');
                const desc = node.querySelector('.node-description');
                if (desc) desc.style.display = 'none';
            });
            document.querySelectorAll('.flow-arrow').forEach(arrow => arrow.classList.add('hidden'));

        });
    </script>
</body>
</html>
